function tabsCtrl(t,n,e,r,i,o,s,a,c){t.form={title:"",location:"",primary_image:"",photos:[],tags:[],type:"",geo:null},c.getLocation().then(function(n){var e=n.coords.latitude,r=n.coords.longitude;t.form.geo=[r,e]}),n.togglePhotoModal=function(){s.open({pieces:1,allowFilter:!0}).then(function(n){s.filter(n,function(n){t.form.primary_image=n.photo,t.form.tags=n.tags,t.form.type=n.type,t.modalPost.show()})}).catch(function(){})},t.editImage=function(){t.togglePhotoModal()},t.editAdditionImage=function(n){angular.forEach(t.form.photos,function(e,r){r==n&&t.form.photos.splice(r,1)})},t.increasePhotosModal=function(){s.open({pieces:4-t.form.photos.length,allowFilter:!1}).then(function(n){Array.prototype.push.apply(t.form.photos,n)}).catch(function(){})},t.getLocation=function(){a(function(){angular.element(document.getElementById("ion-geo")).triggerHandler("click")})},t.setOption=function(n){l(n)?d(n):t.form.tags.length<3?t.form.tags.push(n):i.show("最多只能添加3个标签哦","short","center")};var l=function(n){var e=null;return angular.forEach(t.form.tags,function(t){t===n&&(e=n)}),e},d=function(n){angular.forEach(t.form.tags,function(e,r){e==n&&t.form.tags.splice(r,1)})};t.excludeTags=function(n){for(var e=t.form.tags,r=0;r<e.length;r++)if(-1!==n.indexOf(e[r]))return!1;return!0},r.fromTemplateUrl("photogram/postModal.html",{scope:t,focusFirstInput:!0}).then(function(n){t.modalPost=n}),t.togglePostModal=function(){t.modalPost.show()},t.closePost=function(){t.modalPost.hide()},t.submitPost=function(e){var r=angular.copy(e);n.$broadcast("alertStart"),o.post(r).then(function(){t.closePost(),n.$broadcast("alertEnd")}).catch(function(t){n.$broadcast("alertEnd"),n.$broadcast("alert",t||"发送失败，请重试")})}}function postDetailCtrl(t,n,e,r,i,o,s,a){t.$on("$ionicView.beforeEnter",function(){n.hideTabs="tabs-item-hide"}),i.getDetail(r.postID).then(function(n){t.post=n.post;var e=[t.post.primary_image];angular.forEach(t.post.images,function(t){e.push(t)}),t.images=e}),t.comment=function(){o.getUser();i.addComment(t.post.post_id,t.message).then(function(n){t.post.num_comments+=1,t.post.comments.push(n.comment),t.message=""})},t.deleteComment=function(n){if(n.user.name==o.getUser().name){var e=s.confirm({title:"提示",cssClass:"text-center",template:"确定删除该评论吗？",cancelText:"取消",okText:"删除",okType:"button-default"});e.then(function(e){e&&(i.deleteComment(n.id,t.post.post_id).then(function(){angular.forEach(t.post.comments,function(e,r){e.id==n.id&&t.post.comments.splice(r,1)})}),t.post.num_comments-=1)})}},t.like=function(){var n=o.getUser();t.post.is_liked?(t.post.is_liked=!1,t.post.num_likes-=1,i.unlike(t.post.post_id).then(function(){angular.forEach(t.post.likes,function(e,r){e.user.name==n.name&&t.post.likes.splice(r,1)})}).catch(function(){t.post.is_liked=!0,t.post.num_likes+=1})):(t.post.is_liked=!0,t.post.num_likes+=1,i.like(t.post.post_id).then(function(n){t.post.likes.unshift(n.like)}).catch(function(){t.post.is_liked=!1,t.post.num_likes-=1}))},t.goUser=function(t){for(var n in e.current.views)var n=n;"tab-explore"==n?e.go("tab.userDetail",{userID:t}):e.go("tab.accountUserDetail",{userID:t})},t.zoom=function(t){ionic.Platform.isAndroid()?PhotoViewer.show(t,""):ImageViewer.show(t)},t.actions=function(){a.popup(t.post)}}function userDetailCtrl(t,n,e,r,i,o,s,a,c){function l(){var n=c.$getByHandle("userDetailContent"),e=n.getScrollView();t.$broadcast("userDetailContent.scroll",e)}t.$on("$ionicView.beforeEnter",function(){n.hideTabs="tabs-item-hide"}),r.get("/api/users/user_info/"+i.userID).then(function(n){t.user=n.user}),t.onUserDetailContentScroll=l,t.gridStyle="list",t.switchListStyle=function(n){t.gridStyle=n},t.currentUserID=o.getUser().id,t.follow=function(){o.getUser();t.user.is_following?(t.user.is_following=!1,t.user.num_followers-=1,a.unfollow(t.user.id).then(function(){t.$emit("alert","已取消关注")}).catch(function(){t.user.is_following=!0,t.user.num_followers+=1})):(t.user.is_following=!0,t.user.num_followers+=1,a.follow(t.user.id).then(function(){t.$emit("alert","关注成功")}).catch(function(){t.user.is_following=!1,t.user.num_followers-=1}))},t.zoom=function(t){ionic.Platform.isAndroid()?PhotoViewer.show(t,""):ImageViewer.show(t)},t.posts=[];var d=i.userID,u=0;s.getUserPosts(d,u).then(function(n){t.posts=n.posts,u++}),t.doRefresh=function(){u=0,s.getUserPosts(d,u).then(function(n){t.posts=n.posts,u++}),t.$broadcast("scroll.refreshComplete")},t.loadMore=function(){s.getUserPosts(d,u).then(function(n){t.posts=t.posts.concat(n.posts),t.$broadcast("scroll.infiniteScrollComplete"),u++})},t.moreDataCanBeLoaded=function(){return s.hasNextPage()},t.isEmpty=function(){return s.isEmpty()}}function userListCtrl(t,n,e,r,i,o,s){t.$on("$ionicView.beforeEnter",function(){n.hideTabs="tabs-item-hide"}),t.currentUserID=o.getUser().id,t.follow=function(n){var n=o.getUser();n.is_following?(n.is_following=!1,s.unfollow(n.id).then(function(){t.$emit("alert","已取消关注")}).catch(function(){n.is_following=!0})):(n.is_following=!0,s.follow(n.id).then(function(){t.$emit("alert","关注成功")}).catch(function(){n.is_following=!1}))},t.users=[];var a=i.userID,c=0;"followers"==i.userType?(t.title="粉丝列表",s.getFollowers(a,c).then(function(n){t.users=n.users,c++}),t.doRefresh=function(){c=0,s.getFollowers(a,c).then(function(n){t.users=n.users,c++}),t.$broadcast("scroll.refreshComplete")},t.loadMore=function(){s.getFollowers(a,c).then(function(n){t.users=t.users.concat(n.users),t.$broadcast("scroll.infiniteScrollComplete"),c++})},t.moreDataCanBeLoaded=function(){return s.hasNextPage()},t.isEmpty=function(){return s.isEmpty()}):"followings"==i.userType?(t.title="关注列表",s.getFollowings(a,c).then(function(n){t.users=n.users,c++}),t.doRefresh=function(){c=0,s.getFollowings(a,c).then(function(n){t.users=n.users,c++}),t.$broadcast("scroll.refreshComplete")},t.loadMore=function(){s.getFollowings(a,c).then(function(n){t.users=t.users.concat(n.users),t.$broadcast("scroll.infiniteScrollComplete"),c++})},t.moreDataCanBeLoaded=function(){return s.hasNextPage()},t.isEmpty=function(){return s.isEmpty()}):(t.title="点赞用户",s.getPostLikeUsers(a,c).then(function(n){t.users=n.users,c++}),t.doRefresh=function(){c=0,s.getPostLikeUsers(a,c).then(function(n){t.users=n.users,c++}),t.$broadcast("scroll.refreshComplete")},t.loadMore=function(){s.getPostLikeUsers(a,c).then(function(n){t.users=t.users.concat(n.users),t.$broadcast("scroll.infiniteScrollComplete"),c++})},t.moreDataCanBeLoaded=function(){return s.hasNextPage()},t.isEmpty=function(){return s.isEmpty()})}function cateHomeCtrl(t,n,e,r,i,o,s,a,c,l,d){function u(t){var n=angular.element(document.querySelectorAll("#category-scroll")),e=n.find("a"),r=(n[0].querySelector(".scroll"),n[0].querySelector(".cate-scroll-row"),e.length,n[0].offsetWidth/2),i=angular.element(e[t]);if(i&&i.length){var o=i[0].offsetWidth,a=i[0].offsetLeft,c=r-a-o/2+5;c>0&&(c=0),s.$getByHandle("cateScroll").scrollTo(Math.abs(c),0,!0)}}function p(t){var n,e=0;for(n in d){if(t==n)return e;e++}return null}function g(t){var n,e=0;for(n in d){if(e==t)return n;e++}return null}t.$on("$ionicView.beforeEnter",function(){n.hideTabs=""}),l.get("/api/banners").then(function(n){t.banners=n.banners}),t.Categories=d,t.ngCart=a,t.redirectTo=function(t){"BOARD"==t.type?i.go("tab.board",{boardID:t.target}):window.open(t.target,"_blank","location=no,toolbarposition=top,closebuttoncaption=关闭,keyboardDisplayRequiresUserAction=no")},t.goItem=function(t){i.go("tab.item",{itemID:t})},t.slideHasChanged=function(n){var e=g(n);t.changeTab(e,n)},t.currentIndex=0,t.items=[],t.currentTab="",t.changeTab=function(n,e){t.items=[],t.currentTab=n,t.currentIndex=e,c.setCurrentTab(n),c.fetchTopItems().then(function(n){t.items=n.items}),e||(e=p(t.currentTab)),u(e)},t.searchItem=function(t){i.go("tab.search",{query:t})},c.fetchTopItems().then(function(n){t.items=n.items}),t.doRefresh=function(){c.fetchTopItems().then(function(n){t.items=n.items}),t.$broadcast("scroll.refreshComplete")},t.loadMore=function(){c.increaseNewItems().then(function(n){t.items=t.items.concat(n.items),t.$broadcast("scroll.infiniteScrollComplete")})},t.moreDataCanBeLoaded=function(){return c.hasNextPage()},t.isEmpty=function(){return c.isEmpty()}}function homeCtrl(t,n,e,r,i,o,s,a,c,l,d){t.$on("$ionicView.beforeEnter",function(){n.hideTabs=""}),d.get("/api/banners").then(function(n){t.banners=n.banners,a.$getByHandle("image-viewer").update(),a.$getByHandle("image-viewer").loop(!0)}),t.ngCart=s,t.redirectTo=function(t){"BOARD"==t.type?i.go("tab.board",{boardID:t.target}):window.open(t.target,"_blank","location=no,toolbarposition=top,closebuttoncaption=关闭,keyboardDisplayRequiresUserAction=no")},t.goBoard=function(t){i.go("tab.board",{boardID:t})},t.searchItem=function(t){i.go("tab.search",{query:t})},t.boards=[];var u=0;c.getBoards(u).then(function(n){t.boards=n.boards,u++}),t.doRefresh=function(){u=0,c.getBoards(u).then(function(n){t.boards=n.boards,u++}),t.$broadcast("scroll.refreshComplete")},t.loadMore=function(){c.getBoards(u).then(function(n){t.boards=t.boards.concat(n.boards),t.$broadcast("scroll.infiniteScrollComplete"),u++})},t.moreDataCanBeLoaded=function(){return c.hasNextPage()},t.isEmpty=function(){return c.isEmpty()}}function exploreCtrl(t,n,e,r,i,o){t.$on("$ionicView.beforeEnter",function(){n.hideTabs=""}),t.posts=[],t.currentTab="",i.fromTemplateUrl("photogram/popover.html",{scope:t}).then(function(n){t.popover=n}),t.openPopover=function(n){t.popover.show(n)},t.changeTab=function(n){t.currentTab=n,t.popover.hide(),o.setCurrentTab(n),o.fetchTopPosts().then(function(n){t.posts=n.posts})},o.fetchTopPosts().then(function(n){t.posts=n.posts}),t.doRefresh=function(){o.fetchTopPosts().then(function(n){t.posts=n.posts}),t.$broadcast("scroll.refreshComplete")},t.loadMore=function(){o.increaseNewPosts().then(function(n){t.posts=t.posts.concat(n.posts),t.$broadcast("scroll.infiniteScrollComplete")})},t.moreDataCanBeLoaded=function(){return o.hasNextPage()},t.isEmpty=function(){return o.isEmpty()}}function myPostsCtrl(t,n,e,r,i,o,s){t.$on("$ionicView.beforeEnter",function(){n.hideTabs="tabs-item-hide"}),t.posts=[];var a=o.getUser().id,c=0;s.getUserPosts(a,c).then(function(n){t.posts=n.posts,c++}),t.doRefresh=function(){c=0,s.getUserPosts(a,c).then(function(n){t.posts=n.posts,c++}),t.$broadcast("scroll.refreshComplete")},t.loadMore=function(){s.getUserPosts(a,c).then(function(n){t.posts=t.posts.concat(n.posts),t.$broadcast("scroll.infiniteScrollComplete"),c++})},t.moreDataCanBeLoaded=function(){return s.hasNextPage()},t.isEmpty=function(){return s.isEmpty()}}function likePostsCtrl(t,n,e,r,i,o,s){t.$on("$ionicView.beforeEnter",function(){n.hideTabs="tabs-item-hide"}),t.posts=[];var a=o.getUser().id,c=0;s.getUserLikes(a,c).then(function(n){t.posts=n.posts,c++}),t.doRefresh=function(){c=0,s.getUserLikes(a,c).then(function(n){t.posts=n.posts,c++}),t.$broadcast("scroll.refreshComplete")},t.loadMore=function(){s.getUserLikes(a,c).then(function(n){t.posts=t.posts.concat(n.posts),t.$broadcast("scroll.infiniteScrollComplete"),c++})},t.moreDataCanBeLoaded=function(){return s.hasNextPage()},t.isEmpty=function(){return s.isEmpty()}}function authCtrl(t,n,e,r,i,o,s){n.login=function(){n.error=!1,n.disabled=!0,i.login(n.email,n.password).then(function(){t.authDialog.hide(),n.$emit("alert","登陆成功")}).catch(function(){n.$emit("alert","Invalid username and/or password"),n.disabled=!1})},n.oauthLogin=function(e){function r(e,r){i.oauth(e,r).then(function(e){0==e.login?(t.user_id=e.user_id,o.fromTemplateUrl("bindEmail.html",{scope:n,focusFirstInput:!0}).then(function(t){n.bindEmailDialog=t,n.bindEmailDialog.show()})):(t.authDialog.hide(),n.$emit("alert","登陆成功"))})}function a(t){n.$emit("alert","Failed: "+t)}if("wechat_app"==e){var c="snsapi_userinfo";window.Wechat.auth(c,function(t){r(e,t)},a)}else if("weibo_app"==e)window.YCWeibo.ssoLogin(function(t){r(e,t)},a);else if("qq_app"==e){var l=1;window.YCQQ.ssoLogin(function(t){r(e,t)},a,l)}else"facebook_app"==e&&s.login(["public_profile","email","user_friends"]).then(function(t){t.authResponse&&r(e,t.authResponse)},function(t){n.$emit("alert",JSON.stringify(t))})},n.showSignupBox=function(){o.fromTemplateUrl("signup.html",{scope:n,focusFirstInput:!0}).then(function(t){n.signupDialog=t,n.signupDialog.show()})},n.closeSignupBox=function(){n.signupDialog.hide(),n.signupDialog.remove()},n.$on("signupModal:hide",function(){n.signupDialog.hide(),n.signupDialog.remove()}),n.closeBindEmailBox=function(){n.$emit("alert","需绑定邮箱才能登陆"),n.bindEmailDialog.hide(),n.bindEmailDialog.remove()},n.$on("bindEmailModal:hide",function(){n.bindEmailDialog.hide(),n.bindEmailDialog.remove()}),n.showForgotPWBox=function(){o.fromTemplateUrl("forgotPassword.html",{scope:n,focusFirstInput:!0}).then(function(t){n.forgotPWDialog=t,n.forgotPWDialog.show()})},n.closeForgotPWBox=function(){n.forgotPWDialog.hide(),n.forgotPWDialog.remove()},n.$on("forgotPWModal:hide",function(){n.forgotPWDialog.hide(),n.forgotPWDialog.remove()})}function accountCtrl(t,n,e,r,i,o){function s(){var t=o.$getByHandle("userDetailContent"),e=t.getScrollView();n.$broadcast("userDetailContent.scroll",e)}n.$on("$ionicView.beforeEnter",function(){t.hideTabs=""}),n.user=e,n.onUserDetailContentScroll=s,n.gridStyle="list",n.switchListStyle=function(t){n.gridStyle=t},n.zoom=function(t){ionic.Platform.isAndroid()?PhotoViewer.show(t,""):ImageViewer.show(t)},n.posts=[];var a=e.getUser().id,c=0;i.getUserPosts(a,c).then(function(t){n.posts=t.posts,c++}),n.doRefresh=function(){c=0,i.getUserPosts(a,c).then(function(t){n.posts=t.posts,c++}),n.$broadcast("scroll.refreshComplete")},n.loadMore=function(){i.getUserPosts(a,c).then(function(t){n.posts=n.posts.concat(t.posts),n.$broadcast("scroll.infiniteScrollComplete"),c++})},n.moreDataCanBeLoaded=function(){return i.hasNextPage()},n.isEmpty=function(){return i.isEmpty()}}function profileCtrl(t,n,e,r,i,o,s,a){t.$on("$ionicView.beforeEnter",function(){r.hideTabs="tabs-item-hide"}),t.user=n,t.setUsername=function(){a.prompt({title:"修改昵称",inputType:"text",defaultText:n.getUser().name,maxLength:16,cancelText:"取消",okText:"确定",okType:"button-stable"}).then(function(e){n.setUsername(e).then(function(){t.$emit("alert","修改成功"),r.$ionicGoBack()})})},t.togglePhotoModal=function(){var t="avatar/"+n.getUser().id+"/"+(new Date).getTime()+".jpeg";i.open({pieces:1,allowEdit:!0}).then(function(e){i.upload(e,t,function(){n.updateAvatar(t).then(function(){r.$broadcast("alert","头像上传成功")}).catch(function(t){r.$broadcast("alert",t.error)})},function(){r.$broadcast("alert","头像上传失败")})}).catch(function(){})}}function bindEmailCtrl(t,n,e){n.bind=function(){e.bindEmail(n.bindEmailForm.email,t.user_id).then(function(){t.$broadcast("bindEmailModal:hide"),t.authDialog.hide(),n.$emit("alert","绑定成功")}).catch(function(t){t?n.$emit("alert",t.error):n.$emit("alert","Something went wrong..")})}}function forgotPWCtrl(t,n,e){n.submit=function(){e.forgotPassword(n.forgotPWForm.email).then(function(){t.$broadcast("forgotPWModal:hide"),n.$emit("alert","邮件已发送至您的邮箱")}).catch(function(t){t?n.$emit("alert",t.error):n.$emit("alert","Something went wrong..")})}}function signupCtrl(t,n,e){n.signup=function(){e.register(n.signupForm).then(function(){t.$broadcast("signupModal:hide"),t.authDialog.hide(),n.$emit("alert","注册成功")}).catch(function(t){t?n.$emit("alert",t.error):n.$emit("alert","Something went wrong..")})}}function settingsCtrl(t,n,e,r){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"}),n.logout=function(){r.logout().then(function(){e.go("tab.account")})}}function paymentSuccessCtrl(t,n){var e=t.search().order_id,r=t.search().order_type;n(function(){t.url(t.path()),t.path("TRANSFER"==r?"/order/transfer/"+e:"/orders")},2e3)}function paymentCancelCtrl(){}function itemCtrl(t,n,e,r,i,o,s,a){function c(t){for(var n=0;n<t.length;n++)for(var e=n+1;e<t.length;e++)t[n]===t[e]&&(t.splice(e,1),e--);return t}t.$on("$ionicView.beforeEnter",function(){n.hideTabs="tabs-item-hide"}),t.zoom=function(t){ionic.Platform.isAndroid()?PhotoViewer.show(t,""):ImageViewer.show(t)},t.share=function(t){if(n.IsWechatInstalled&&n.IsQQInstalled)s.popup(t);else{var e="分享图片",r="分享",i=t.url,o="http://www.may.bi";a.share(e,r,i,o).then(function(t){},function(t){n.$emit("alert",t)})}},i.fromTemplateUrl("specs-dialog.html",{scope:t}).then(function(n){t.specsDialog=n}),t.showSpecsBox=function(){t.specsDialog.show()},t.closeSpecsBox=function(){t.specsDialog.hide(),t.specsDialog.remove()},t.$on("specsModal:hide",function(){t.specsDialog.hide(),t.specsDialog.remove()}),r.get("/api/items/"+e.itemID).then(function(n){t.item=n.item,t.specs=n.item.specs,t.selectedSpec=n.item.specs[0],t.attrChoices={},angular.forEach(t.item.attributes_desc,function(n,e){var r=[];angular.forEach(t.specs,function(t){this.push(t.attributes[e])},r),t.attrChoices[e]=c(r)});var e=[];angular.forEach(t.item.specs,function(t){angular.forEach(t.images,function(t){e.push({url:t})})}),t.images=e,o.$getByHandle("image-viewer").update(),o.$getByHandle("image-viewer").loop(!0)}),t.favor=function(n){t.item.is_favored?r.get("/api/items/unfavor/"+n).then(function(){t.item.is_favored=!1}):r.get("/api/items/favor/"+n).then(function(){t.item.is_favored=!0})},t.quantity=1,t.setQuantity=function(n,e){var r=parseInt(n);r%1===0?(e===!0?t.quantity+=r:t.quantity=r,t.quantity<1&&(t.quantity=1),t.quantity>=5&&(t.quantity=5)):(t.quantity=1,t.$emit("Quantity must be an integer and was defaulted to 1"))},t.subTotal=function(t,n){return parseFloat(t*n)},t.selectedAttr={},t.setAttr=function(n,e){t.selectedAttr[n]=e,t.selectedSpec=d(t.selectedAttr,t.specs),t.remainSpec=l(n,e,t.specs),t.selectedSpecData={item:t.item,spec:t.selectedSpec}};var l=function(t,n,e){for(var r=[],i=0;i<e.length;i++)for(var o in e[i].attributes)o!=t&&e[i].attributes[t]==n?r.push(e[i].attributes[o]):o==t&&r.push(e[i].attributes[t]);return c(r)},d=function(t,n){for(var e=0;e<n.length;e++)if(angular.equals(n[e].attributes,t))return n[e];return null}}function boardCtrl(t,n,e,r,i){t.$on("$ionicView.beforeEnter",function(){n.hideTabs="tabs-item-hide"}),r.get("/api/board/"+e.boardID).then(function(n){t.board=n.board}),t.goItem=function(t){i.go("tab.item",{itemID:t})}}function itemsCtrl(t,n,e,r,i){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"}),n.goItem=function(t){r.go("tab.item",{itemID:t})},n.items=[],n.title=i.cn||i.query;var o=i.en||"",s=i.query||"",a=0;e.searchItems(s,o,a).then(function(t){n.items=t.items,a++}),n.doRefresh=function(){a=0,e.searchItems(s,o,a).then(function(t){n.items=t.items,a++}),n.$broadcast("scroll.refreshComplete")},n.loadMore=function(){e.searchItems(s,o,a).then(function(t){n.items=n.items.concat(t.items),n.$broadcast("scroll.infiniteScrollComplete"),a++})},n.moreDataCanBeLoaded=function(){return e.hasNextPage()},n.isEmpty=function(){return e.isEmpty()}}function favorCtrl(t,n,e,r){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"}),e.get("/api/items/favors").then(function(t){n.items=t.items}),n.goItem=function(t){r.go("tab.order_entry",{itemID:t})}}function ordersCtrl(t,n,e,r){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"}),n.ngCart=r,n.orderType="COMMODITIES",e.get("/api/orders/COMMODITIES").then(function(t){n.orders=t.orders}),n.setType=function(t){n.orderType=t,e.get("/api/orders/"+t).then(function(t){n.orders=t.orders})}}function orderDetailCtrl(t,n,e,r,i,o,s){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"}),i.get("/api/orders/get/"+r.order_id).then(function(t){n.ngCart=o,n.order=t.order}),n.cancelOrder=function(){var t=s.confirm({title:"确定取消订单?"});t.then(function(t){t&&i.get("/api/orders/"+r.order_id+"/delete").then(function(){n.$emit("alert","订单已删除"),e.go("tab.orders")})})}}function logisticsDetailCtrl(t,n,e,r,i,o){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"}),n.allStatus=[],i.get("/api/orders/get/"+e.order_id).then(function(t){n.ngCart=o,n.order=t.order,n.logistic=t.order.logistics[0],angular.forEach(n.logistic.all_status,function(t){n.allStatus.push(t.status)})}),n.currTab=0,n.goTab=function(t,e){n.currTab=t,n.logistic=e,angular.forEach(n.logistic.all_status,function(t){n.allStatus.push(t.status)})},n.addr=o.getAddress(),n.gotoAddress=function(){r.go("tab.address")},n.fillTracking=function(t){i.post("/api/orders/fill_shipping_info",{entry_id:t.id,shipping_info:t.shipping_info}).then(function(){n.$emit("alert","成功提交")})},n.selectedProvider=null,n.providersShown=!1,n.showProviderChoices=function(){return void 0===o.getAddress().id?void n.$emit("alert","请先添加地址"):(n.providersShown=!n.providersShown,void i.post("/api/logistic/transfer_provider_prices",{order_id:n.order.id,country:o.getAddress().data.country}).then(function(t){n.provider_prices=t.logistics.providers,n.selectedProvider=t.logistics.providers[0]}))},n.selectPartner=function(t){n.selectedProvider=t,n.providersShown=!n.providersShown,i.post("/api/orders/cal_order_price",{order_id:n.order.id,address_id:o.getAddress().id,coupon_codes:[n.coupon_codes.code],logistic_provider:n.selectedProvider.name}).then(function(t){n.order=t.order})},n.coupon_codes="",n.couponsShown=!1,n.couponInputSelected=!1,n.noCouponSelected=!1,n.showCouponsChoices=function(){return void 0===o.getAddress().id?void n.$emit("alert","请先添加地址"):null==n.selectedProvider?void n.$emit("alert","请先选择运输方式"):(n.couponsShown=!n.couponsShown,void i.post("/api/users/coupons/by_order",{order_id:n.order.id}).then(function(t){n.availableCoupons=t.consumable_coupons,n.coupon_codes=""}))},n.noCoupon=function(){n.coupon_codes="",n.couponInputSelected=!1,n.noCouponSelected=!0,n.couponsShown=!n.couponsShown,i.post("/api/orders/cal_order_price",{order_id:n.order.id,address_id:o.getAddress().id,coupon_codes:[],logistic_provider:n.selectedProvider.name}).then(function(t){n.order=t.order})},n.selectCoupon=function(t){n.coupon_codes=t,n.couponsShown=!n.couponsShown,n.couponInputSelected=!1,n.noCouponSelected=!1,i.post("/api/orders/cal_order_price",{order_id:n.order.id,address_id:o.getAddress().id,coupon_codes:[n.coupon_codes.code],logistic_provider:n.selectedProvider.name}).then(function(t){n.order=t.order})},n.selectInputCoupon=function(){n.coupon_codes="",n.couponInputSelected=!0,n.noCouponSelected=!1},n.confirmCoupon=function(){n.couponInputSelected=!0,i.post("/api/orders/cal_order_price",{order_id:n.order.id,address_id:o.getAddress().id,coupon_codes:[n.couponInput],logistic_provider:n.selectedProvider.name}).then(function(t){n.coupon_codes={code:n.couponInput,description:n.couponInput},0===t.order.discount.length?n.coupon_codes.saving="无效折扣码":(n.coupon_codes.saving=t.order.discount[0].value,n.couponsShown=!n.couponsShown),n.order=t.order}).catch(function(){n.$emit("alert","something wrong..")})},n.cancelOrder=function(){window.confirm("确定取消订单？")?i.get("/api/orders/"+n.order.id+"/delete").then(function(){n.$emit("alert","订单已删除"),$location.path("/orders")}):void 0}}function calculateCtrl(t,n,e,r){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"}),r.get("/api/address/hierarchy").then(function(t){n.COUNTRIES=t.countries}),n.query={},n.queryFee=function(){return n.query.country&&n.query.weight?void r.get("/api/logistic/cal_provider_prices",{country:n.query.country,weight:n.query.weight}).then(function(t){n.provider_prices=t.logistics.providers}):void n.$emit("alert","请填写完整信息")}}function expressCtrl(t,n,e,r,i,o,s){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"}),n.ngCart=r,n.STATUES=["跟踪快递","入库称重","支付运费","正在运送","航班到港","包裹签收"],n.addr=r.getAddress(),n.gotoAddress=function(){o.go("tab.address")},n.entries=s.get()||[],n.newEntry={},n.addEntry=function(){o.go("tab.express_add")},n.removeEntry=function(t){angular.forEach(n.entries,function(e,r){e===t&&n.entries.splice(r,1)})},n.submit=function(){return 0==n.entries.length?void n.$emit("alert","您未添加商品"):(i.getUser()==={}&&n.$emit("alert","请先登录"),void 0===r.getAddress().id?void n.$emit("alert","请添加地址"):(t.$broadcast("alertStart","正在处理，请稍等.."),void e.post("/api/orders/create_transfer_order",{entries:n.entries,address_id:r.getAddress().id,coupon_codes:[],logistic_provider:"default"}).then(function(e){n.order=e.order,t.$broadcast("alertEnd"),o.go("tab.order_transfer",{order_id:e.order_id}),s.empty()}).catch(function(){n.$emit("alert","系统出错..")})))}}function expressItemAddCtrl(t,n,e){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"}),n.expressList=e.get(),n.item={},n.addItem=function(){return n.item.title&&n.item.quantity&&n.item.amount&&n.item.remark?(n.item.main_category=1==n.item.main_category?"special":"normal",e.add(n.item),void n.$ionicGoBack()):void n.$emit("alert","请填写完整信息")}}function cartCtrl(t,n,e,r){e.$on("$ionicView.beforeEnter",function(){n.hideTabs=""}),t.get("/api/cart").then(function(t){r.$loadCart(t.cart)}),e.ngCart=r,e.editShown=!1,e.toggleEditShown=function(){e.editShown=!e.editShown},e.setQuantity=function(n,r,i){var o=parseInt(r);o%1===0?(n.setQuantity(i===!0?n.getQuantity()+o:o),n.getQuantity()<1&&n.setQuantity(1),n.getQuantity()>=5&&n.setQuantity(5)):(n.setQuantity(1),e.$emit("Quantity must be an integer and was defaulted to 1")),t.post("/api/cart/entry/"+n.getId()+"/update",{quantity:n.getQuantity()})},e.selectEntry=function(t){r.getSelectedItemById(t)?r.removeSelectedItemById(t):r.selectItem(t)},e.isSelectedAll=!1,e.selectAllEntries=function(){e.isSelectedAll===!1?angular.forEach(r.getCart().items,function(t){r.getSelectedItemById(t.getId())||r.selectItem(t.getId())}):r.getCart().selectedItems=[],e.isSelectedAll=!e.isSelectedAll}}function checkoutCtrl(t,n,e,r,i){n.$on("$ionicView.beforeEnter",function(){e.hideTabs="tabs-item-hide",n.addr=i.getAddress()}),n.ngCart=i,n.gotoAddress=function(){t.go("tab.address")},n.selectedProvider=null,n.providersShown=!1,n.showProviderChoices=function(){return void 0===i.getAddress().id?void n.$emit("alert","请先添加地址"):(n.providersShown=!n.providersShown,void r.post("/api/logistic/channel_prices",{entries:i.selectedItemsObjects(),country:n.addr.data.country}).then(function(t){n.provider_prices=t.logistics.providers,n.selectedProvider=t.logistics.providers[0]}))},n.selectPartner=function(t){n.selectedProvider=t,n.providersShown=!n.providersShown,r.post("/api/orders/cal_entries_price",{entries:i.selectedItemsObjects(),address_id:i.getAddress().id,coupon_codes:[n.coupon_codes.code],logistic_provider:n.selectedProvider.name}).then(function(t){n.order=t.order})},n.coupon_codes="",n.couponsShown=!1,n.couponInputSelected=!1,n.noCouponSelected=!1,n.showCouponsChoices=function(){return void 0===i.getAddress().id?void n.$emit("alert","请先添加地址"):null==n.selectedProvider?void n.$emit("alert","请先选择运输方式"):(n.couponsShown=!n.couponsShown,void r.post("/api/users/coupons/by_entries",{entries:i.selectedItemsObjects()}).then(function(t){n.availableCoupons=t.consumable_coupons,n.coupon_codes=""}))},n.noCoupon=function(){n.coupon_codes="",n.couponInputSelected=!1,n.noCouponSelected=!0,n.couponsShown=!n.couponsShown,r.post("/api/orders/cal_entries_price",{entries:i.selectedItemsObjects(),address_id:i.getAddress().id,coupon_codes:[],logistic_provider:n.selectedProvider.name}).then(function(t){n.order=t.order})},n.selectCoupon=function(t){n.coupon_codes=t,n.couponsShown=!n.couponsShown,n.couponInputSelected=!1,n.noCouponSelected=!1,r.post("/api/orders/cal_entries_price",{entries:i.selectedItemsObjects(),address_id:i.getAddress().id,coupon_codes:[n.coupon_codes.code],logistic_provider:n.selectedProvider.name}).then(function(t){n.order=t.order})},n.selectInputCoupon=function(){n.coupon_codes="",n.couponInputSelected=!0,n.noCouponSelected=!1},n.confirmCoupon=function(){n.couponInputSelected=!0,r.post("/api/orders/cal_entries_price",{entries:i.selectedItemsObjects(),address_id:i.getAddress().id,coupon_codes:[n.couponInput],logistic_provider:n.selectedProvider.name}).then(function(t){n.coupon_codes={code:n.couponInput,description:n.couponInput},0===t.order.discount.length?n.coupon_codes.description="无效折扣码":(n.coupon_codes.saving=t.order.discount[0].value,n.couponsShown=!n.couponsShown),n.order=t.order}).catch(function(){n.$emit("alert","something wrong..")})}}function addressCtrl(t,n,e,r,i){e.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"}),r.get("/api/address/all").then(function(t){e.addresses=t.addresses}),e.editShown=!1,e.toggleEditShown=function(){e.editShown=!e.editShown},e.removeAddr=function(t){r.get("/api/address/del/"+t).then(function(n){"OK"==n.message?angular.forEach(e.addresses,function(n,r){n.id===t&&e.addresses.splice(r,1)}):e.$emit("alert",n.error)})},e.ngCart=i,e.selectedAddress="",e.selectAddress=function(t){e.selectedAddress=t},e.confirmAddress=function(){i.setAddress(e.selectedAddress),t.$ionicGoBack()}}function fourZeroFour_controller(){}function feedbackCtrl(t,n){t.feedback=function(){n.post("/api/users/feedback",{feedback:t.text}).then(function(){t.$emit("alert","感谢您的反馈，我们会及时与您联系。")})}}function csCtrl(t,n){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"})}function faqCtrl(t,n){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"})}function categoryCtrl(t,n,e,r){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"}),e.get("/api/categories").then(function(t){n.categories=t.categories}),n.goCategory=function(t){r.go("tab.categories",{en:t.en,cn:t.cn})}}function couponsCtrl(t,n,e){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"}),n.user=e}function aboutCtrl(t,n,e,r){n.$on("$ionicView.beforeEnter",function(){t.hideTabs="tabs-item-hide"}),n.platform=ionic.Platform,n.appUpdateService=r}function notificationCtrl(t,n,e,r){n.$on("$ionicView.beforeEnter",function(){t.hideTabs=""}),n.zoom=function(t){ionic.Platform.isAndroid()?PhotoViewer.show(t,""):ImageViewer.show(t)},n.notices=[];var i=0;r.getNotices(i).then(function(t){n.notices=t.notices,i++}),n.doRefresh=function(){i=0,r.getNotices(i).then(function(t){n.notices=t.notices,i++}),n.$broadcast("scroll.refreshComplete")},n.loadMore=function(){r.getNotices(i).then(function(t){n.notices=n.notices.concat(t.notices),n.$broadcast("scroll.infiniteScrollComplete"),i++})},n.moreDataCanBeLoaded=function(){return r.hasNextPage()},n.isEmpty=function(){return r.isEmpty()}}function introCtrl(t,n,e,r,i,o){function s(t){n.slideIndex=t}var a=ionic.Platform.platform();n.slideIndex=0,n.slideChanged=s,n.next=function(){i.next()},n.previous=function(){i.previous()},n.device=a&&"android"==a?"android":"iphone",n.slides=[{top:"专属轻社区，分享交流，互助互惠",img:"img/intro/intro3.jpg"},{top:"晒图卖萌刷心情，展现特别的你",img:"img/intro/intro4.jpg"},{top:"家乡特色，闪电发货，海外直邮",img:"img/intro/intro1.jpg"},{top:"私人包裹 & 寄出国，省心又省力",img:"img/intro/intro2.jpg"}],n.goHome=function(){e.go("tab.explore"),o.set("introPage","alreadyShow")}}function PhotoService(t,n,e,r,i,o,s,a,c){function l(t){function n(t){var n=c.defer();if(1===t.pieces&&t.allowFilter===!0||t.allowEdit===!0){var e={quality:t.quality?t.quality:m.quality,aspectRatio:t.aspectRatio?t.aspectRatio:m.aspectRatio,allowRotation:t.allowRotation?t.allowRotation:m.allowRotation,allowEdit:t.allowEdit?t.allowEdit:m.allowEdit,correctOrientation:t.correctOrientation?t.correctOrientation:m.correctOrientation,targetWidth:t.width?t.width:m.targetWidth,targetHeight:t.height?t.height:m.targetHeight,saveToPhotoAlbum:t.saveToPhotoAlbum?t.saveToPhotoAlbum:m.saveToPhotoAlbum,destinationType:window.cordova?Camera.DestinationType.DATA_URL:null,encodingType:window.cordova?Camera.EncodingType.JPEG:null,popoverOptions:window.cordova?CameraPopoverOptions:null};e.sourceType=Camera.PictureSourceType.PHOTOLIBRARY,s.getPicture(e).then(function(t){n.resolve("data:image/jpeg;base64,"+t)},function(t){n.reject("Error When taking Photo:"+t)})}if(t.allowFilter===!1){var e={maximumImagesCount:t.pieces,width:t.width?t.width:m.targetWidth,height:t.height?t.height:m.targetHeight,quality:t.quality?t.quality:m.quality,outputType:imagePicker.OutputType.BASE64_STRING};ionic.Platform.isAndroid()||(e.outputType=imagePicker.OutputType.BASE64_STRING),a.getPictures(e).then(function(t){for(var e=[],r=0;r<t.length;r++)e.push("data:image/jpeg;base64,"+t[r].replace(/(\r\n|\n|\r)/g,""));
n.resolve(e)},function(t){n.reject("error when choosing photos: "+t)})}return n.promise}var e=c.defer(),t=t||{};return window.cordova?n(t).then(function(t){e.resolve(t)}):r.$broadcast("alert","请到设置允许打开相机"),e.promise}function d(t,n){var r=c.defer();return e.crop({url:t,aspectRatio:n.aspectRatio?n.aspectRatio:!1,allowRotation:n.allowRotation?n.allowRotation:!1,width:n.width?n.width:m.targetWidth,height:n.height?n.height:m.targetHeight,cancelText:"取消",chooseText:"确定"}).then(function(t){r.resolve(t)}),r.promise}function u(t,n){var e='<ion-modal-view class="modal-capture"><ion-header-bar class="bar bar-header"><button class="button button-clear button-icon ion-ios-arrow-back" ng-click="closeFilter()"></button><div class="title"></div><button class="button button-icon " ng-click="submitFilter()">下一步</button></ion-header-bar><ion-content class="has-header has-carousel"><photo-filter image="image" loading="loading"></photo-filter></ion-content><div class="bar bar-subfooter bar-carousel"><photo-tag tags="form.tags" type="form.type" ng-if="currentTab==\'标签\'"></photo-tag><photo-carousel image="image" loading="loading" ng-if="currentTab==\'滤镜\'"></photo-carousel></div><div class="bar bar-footer"><div class="bar-filter" ng-repeat="tab in [\'标签\', \'滤镜\']" ng-click="changeTab(tab)"><div class="footer-tab" ng-class="{\'active\': currentTab==tab}" >{{tab}}</div></div></div></ion-modal-view>',i=r.$new(!0);i.image=t,i.form={photo:"",tags:[],type:""},i.submitFilter=function(){if(!i.form.type)return void i.$emit("alert","请选择一个标签");var t=document.getElementById("vin-image");i.form.photo=t.src,n(i.form),i.closeFilter()},i.closeFilter=function(){i.modalFilter.hide(),i.modalFilter.remove()},i.currentTab="标签",i.changeTab=function(t){i.currentTab=t},i.modalFilter=o.fromTemplate(e,{scope:i}),i.modalFilter.show()}function p(t){for(var n=atob(t.split(",")[1]),e=[],r=0;r<n.length;r++)e.push(n.charCodeAt(r));var i="image/jpeg";return new Blob([new Uint8Array(e)],{type:i})}function g(t,n,e,r){var i=p(t),o=new AWS.S3({params:{Bucket:"maybi-img"}}),s={Key:n,Body:i,ContentEncoding:"base64",ContentType:"image/jpeg",ACL:"public-read"};o.putObject(s,function(t,n){t?r(t):e(n)}).on("httpUploadProgress",function(t){})}var m={jrCrop:!1,quality:80,allowEdit:!1,correctOrientation:!0,targetWidth:800,targetHeight:800,saveToPhotoAlbum:!1,allowRotation:!1,aspectRatio:0};return{open:l,crop:d,filter:u,upload:g}}function ionCropDirective(t,n){function e(e,r){function i(){document.getElementById("browseBtn").click()}function o(){var t=[{text:'<i class="icon ion-camera"></i> 拍照'},{text:'<i class="icon ion-images"></i> 相册'}];n.show({buttons:t,titleText:"裁剪",cancelText:"取消",buttonClicked:function(t){return 1===t&&document.getElementById("browseBtn").click(),!0}})}function s(t){var n=t.target.files[0],r=new FileReader;r.readAsDataURL(n),r.onload=function(t){var n=t.target.result;e.crop(n)},angular.element(document.getElementById("browseBtn")).val("")}function a(n){t.crop({url:n,width:e.option?e.option.width:200,height:e.option?e.option.height:200,cancelText:"Cancel",chooseText:"Save"}).then(function(t){var n=t.toDataURL();e.ngModel=n})}e.action=o,r.bind("click",i),e.crop=a,angular.element(document.getElementById("browseBtn")).on("change",s)}return{restrict:"A",scope:{ngModel:"=",option:"=",cropSave:"&"},templateUrl:"photogram/ionCrop.html",link:e}}function PhotoFilterFactory(t,n,e){function r(n,r){function i(){var t=document.getElementById("vin-image"),n=t.src;r(n),o()}function o(){a.modal.hide(),a.modal.remove()}var s='<ion-modal-view class="modal-capture"><ion-header-bar><button class="button button-clear button-icon ion-ios-arrow-back" ng-click="closeCapture()"></button><div class="title"></div><button class="button button-icon " ng-click="submitCapture()">下一步</button></ion-header-bar><ion-content><photo-filter image="form.photo"></photo-filter></ion-content></ion-modal-view>',n=n.toDataURL(),a=t.$new(!0);a.closeCapture=o,a.submitCapture=i,a.form={photo:n},a.modal=e.fromTemplate(s,{scope:a}),a.modal.show()}return{load:r}}function photoFilterDirective(){return{restrict:"E",scope:{image:"=",loading:"="},transclude:!0,templateUrl:"photogram/photoFilter.html"}}function photoFilterCarouselDirective(t){return{restrict:"E",scope:{image:"=",loading:"="},templateUrl:"photogram/photoFilterCarousel.html",link:function(n){n.filters=t.filters,n.applyFilter=function(e){var r=document.getElementById("original-image"),i=document.getElementById("vin-image");i.src=r.src,n.loading=!0,"normal"==e?n.loading=!1:t.effect(e).then(function(){n.loading=!1})}}}}function photoTag(){return{restrict:"E",scope:{tags:"=",type:"="},templateUrl:"photogram/photoTag.html",link:function(t){t.tags=[],t.selectType=function(n){t.type=n}}}}function vintageDirective(){return{restrict:"A",scope:{filter:"=",name:"@",image:"=",loading:"="},template:'<img ng-src="{{ image }}" id="{{ name }}">'}}function Vintage(t){function n(n){var e=t.defer(),i=document.getElementById("vin-image"),o={onError:function(){alert("ERROR")},onStop:function(){e.resolve(n)}},s="random"!=n?r[n]:r[n]();return new VintageJS(i,o,s),e.promise}var e={vintage:"葡萄",sepia:"褐色",greenish:"绿意",reddish:"泛红",random:"随机"},r={vintage:{curves:function(){for(var t=function(t){return-12*Math.sin(2*t*Math.PI/255)+t},n=function(t){return-.2*Math.pow(255*t,.5)*Math.sin(Math.PI*(-195e-7*Math.pow(t,2)+.0125*t))+t},e=function(t){return-.001045244139166791*Math.pow(t,2)+1.2665372554875318*t},r=function(t){return.57254902*t+53},i={r:[],g:[],b:[]},o=0;255>=o;++o)i.r[o]=n(t(o)),i.g[o]=e(t(o)),i.b[o]=r(t(o));return i}(),screen:{r:227,g:12,b:169,a:.15},vignette:.7,viewFinder:!1},sepia:{curves:function(){for(var t=function(t){return-12*Math.sin(2*t*Math.PI/255)+t},n={r:[],g:[],b:[]},e=0;255>=e;++e)n.r[e]=t(e),n.g[e]=t(e),n.b[e]=t(e);return n}(),sepia:!0},greenish:{curves:function(){for(var t=function(t){return-12*Math.sin(2*t*Math.PI/255)+t},n={r:[],g:[],b:[]},e=0;255>=e;++e)n.r[e]=t(e),n.g[e]=t(e),n.b[e]=t(e);return n}(),vignette:.6,lighten:.1,screen:{r:255,g:255,b:0,a:.15}},reddish:{curves:function(){for(var t=function(t){return-12*Math.sin(2*t*Math.PI/255)+t},n={r:[],g:[],b:[]},e=0;255>=e;++e)n.r[e]=t(e),n.g[e]=t(e),n.b[e]=t(e);return n}(),vignette:.6,lighten:.1,screen:{r:255,g:0,b:0,a:.15}},random:function(){var t,n=30-Math.floor(60*Math.random()),e=30-Math.floor(60*Math.random()),r=function(){if(.5<=Math.random())return!1;for(var t=5<=Math.random(),n=5<=Math.random()?n:function(t){return t},e=t?e:function(t){return t},r=t?r:function(t){return t},i=t?i:function(t){return t},t={r:[],g:[],b:[]},o=0;255>=o;++o)t.r[o]=e(n(o)),t.g[o]=r(n(o)),t.b[o]=i(n(o));return t}();return t=.5<=Math.random()?!1:{r:Math.floor(255*Math.random()),g:Math.floor(255*Math.random()),b:Math.floor(255*Math.random()),a:.4*Math.random()},{contrast:n,brightness:e,curves:r,screen:t,desaturate:Math.random(),vignette:Math.random(),lighten:.3*Math.random(),noise:Math.floor(50*Math.random()),viewFinder:!1,sepia:.5<=Math.random()}}};return{filters:e,effect:n}}function PhotogramFactory(t,n,e,r,i,o,s){function a(){var t=r.defer();return e.get(n.SERVER_URL+"/api/post/list",{params:{type:$,page:C,per_page:S}}).success(function(n,e){200===e&&"OK"==n.message?(n.posts.length<S&&(k=!1),C++,t.resolve(n)):t.reject()}).error(function(){t.reject()}),t.promise}function c(){var t=r.defer();return k=!0,_=!1,e.get(n.SERVER_URL+"/api/post/list",{params:{type:$,page:0,per_page:S}}).success(function(n,e){200===e&&"OK"==n.message?(n.posts.length<S&&(k=!1),C=1,0===n.posts.length&&(_=!0),t.resolve(n)):t.reject()}).error(function(){t.reject()}),t.promise}function l(t,i){var o=r.defer();return k=!0,_=!1,e.get(n.SERVER_URL+"/api/post/list",{params:{page:i,per_page:S,user_id:t}}).success(function(t,n){200===n&&"OK"==t.message?(t.posts.length<S&&(k=!1),0==i&&0===t.posts.length&&(_=!0),o.resolve(t)):o.reject()}).error(function(){o.reject()}),o.promise}function d(t,i){var o=r.defer();return k=!0,_=!1,e.get(n.SERVER_URL+"/api/post/likes",{params:{page:i,per_page:S,user_id:t}}).success(function(t,n){200===n&&"OK"==t.message?(t.posts.length<S&&(k=!1),0==i&&0===t.posts.length&&(_=!0),o.resolve(t)):o.reject()}).error(function(){o.reject()}),o.promise}function u(t){var i=r.defer();return k=!0,_=!1,e.get(n.SERVER_URL+"/api/post/list",{params:{type:$,page:0,per_page:S,title:t}}).success(function(t,n){200===n&&"OK"==t.message?(t.posts.length<S&&(k=!1),0===t.posts.length&&(_=!0),C=1,i.resolve(t)):i.reject()}).error(function(){i.reject()}),i.promise}function p(o){var a=r.defer(),c="primary/"+(new Date).getTime()+".jpeg";s.upload(o.primary_image,c,function(){e.post(n.SERVER_URL+"/api/post/image_uploaded",{url:c,type:"primary_image"}),i.$broadcast("alert","发送成功")},function(t){return i.$broadcast("alert","发送失败，请重试"),a.reject(t),a.promise}),o.primary_image="http://assets.maybi.cn/"+c;var l=[];return angular.forEach(o.photos,function(t,r){var i="photo/"+r+"/"+(new Date).getTime()+".jpeg";s.upload(t,i,function(){e.post(n.SERVER_URL+"/api/post/image_uploaded",{url:i,type:"photos"})},function(t){return a.reject(t),a.promise}),l.push("http://assets.maybi.cn/"+i)}),o.photos=l,t.post("/api/post/create",o).then(function(t){a.resolve(t)}).catch(function(t){a.reject(t)}),a.promise}function g(n){var e=r.defer();return t.post("/api/post/delete/"+n).then(function(t){e.resolve(t)}).catch(function(t){e.reject(t)}),e.promise}function m(n){var e=r.defer();return t.get("/api/post/detail/"+n).then(function(t){e.resolve(t)}).catch(function(t){e.reject(t)}),e.promise}function h(n,e){var i=r.defer();return t.post("/api/post/comment/add",{post_id:n,content:e}).then(function(t){i.resolve(t)}).catch(function(t){i.reject(t)}),i.promise}function v(n,e){var i=r.defer();return t.post("/api/post/comment/delete",{comment_id:n,post_id:e}).then(function(t){i.resolve(t)}).catch(function(t){i.reject(t)}),i.promise}function f(n){var e=r.defer();return t.post("/api/post/like/"+n).then(function(t){e.resolve(t)}).catch(function(t){e.reject(t)}),e.promise}function b(n){var e=r.defer();return t.post("/api/post/unlike/"+n).then(function(t){e.resolve(t)}).catch(function(t){e.reject(t)}),e.promise}function w(n,e){var i=r.defer();return t.post("/api/post/report",{post_id:n,subject:e}).then(function(t){i.resolve(t)}).catch(function(t){i.reject(t)}),i.promise}var y=[],$="",k=!0,_=!1,C=0,S=10;return{post:p,delPost:g,getDetail:m,search:u,addComment:h,deleteComment:v,like:f,unlike:b,report:w,getUserPosts:l,getUserLikes:d,fetchTopPosts:c,increaseNewPosts:a,getPosts:function(){return y},setCurrentTab:function(t){$=t},getCurrentTab:function(){return $},hasNextPage:function(){return k},isEmpty:function(){return _}}}function photoList(t,n,e,r,i,o){return{restrict:"E",scope:{post:"=",withAffix:"="},replace:!0,link:function(n){n.like=function(){n.post.is_liked?(n.post.is_liked=!1,n.post.num_likes-=1,t.unlike(n.post.post_id).then(function(){}).catch(function(){n.post.is_liked=!0,n.post.num_likes+=1})):(n.post.is_liked=!0,n.post.num_likes+=1,t.like(n.post.post_id).then(function(){}).catch(function(){n.post.is_liked=!1,n.post.num_likes-=1}))},n.goPost=function(){for(var t in i.current.views)var t=t;"tab-explore"==t?i.go("tab.postDetail",{postID:n.post.post_id}):i.go("tab.myPostDetail",{postID:n.post.post_id})},n.actions=function(){o.popup(n.post)},n.zoom=function(){ionic.Platform.isAndroid()?PhotoViewer.show(n.post.primary_image,""):ImageViewer.show(n.post.primary_image)},n.goUser=function(){i.go("tab.userDetail",{userID:n.post.user.id})},n.searchTag=function(){}},templateUrl:function(t,n){return"undefined"==typeof n.withAffix?"photogram/photoList.html":"photogram/photoListNoAffix.html"}}}function photoShare(t,n,e,r,i,o){this.popup=function(s){function a(){var r=[{text:"垃圾广告"},{text:"虚假信息"},{text:"恶意攻击"},{text:"暴力色情"},{text:"触犯法规"},{text:"其他原因"}];return e.show({buttons:r,titleText:"举报原因",cssClass:"actions-menu",cancelText:"取消",buttonClicked:function(e){var i=r[e].text;return n.report(s.post_id,i).then(function(){t.$emit("alert","已举报")}),!0}}),!0}function c(e){if(0==e)if(t.IsWechatInstalled&&t.IsQQInstalled)i.popup(s,"post");else{var o="分享图片",a="分享",c=s.primary_image,l="http://www.may.bi";r.share(o,a,c,l).then(function(t){},function(n){t.$emit("alert",n)})}else 1==e&&n.delPost(s.post_id).then(function(){t.$emit("alert","删除成功")});return!0}var l={};l.destructiveText='<i class="icon fa fa-info-circle"></i> 举报',l.cancelText="取消",l.buttonClicked=c,l.destructiveButtonClicked=a,l.cssClass="actions-menu",l.buttons=[{text:'<i class="icon fa fa-share-alt"></i> 分享'}],s.user.id==o.getUser().id&&l.buttons.push({text:'<i class="icon fa fa-trash"></i> 删除'}),e.show(l)}}angular.module("maybi",["ionic","ionic.service.core","ngCordova","angularMoment","templates","ionic-native-transitions","ion-BottomSheet","ion-affix","ion-photo","ion-geo","maybi.controllers","maybi.services","maybi.directives","maybi.photogram","maybi.constants","maybi.filters","tag-select"]).run(["$ionicPlatform","$rootScope","$state","JPush","$ionicHistory","$ionicModal","$ionicLoading","$cordovaToast","amMoment","AuthService","ngCart","Storage","FetchData",function(t,n,e,r,i,o,s,a,c,l,d,u,p){t.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault(),Wechat.isInstalled(function(t){n.IsWechatInstalled=t},function(){n.IsWechatInstalled=!1}),YCQQ.checkClientInstalled(function(){n.IsQQInstalled=!0},function(){n.IsQQInstalled=!1}),plugins.jPushPlugin.init(),plugins.jPushPlugin.setApplicationIconBadgeNumber(0),document.addEventListener("jpush.openNotification",r.onOpenNotification,!1),document.addEventListener("jpush.receiveNotification",r.onReceiveNotification,!1),document.addEventListener("jpush.receiveMessage",r.onReceiveMessage,!1)}),c.changeLocale("zh-cn"),n.$on("ngCart:change",function(t,n){d.$save(),window.cordova?a.show(n,"short","center"):s.show({template:n,duration:1e3})}),n.$state=e,angular.isObject(u.get("cart"))?d.$restore(u.get("cart")):(d.init(),p.get("/api/cart").then(function(t){d.$loadCart(t.cart)})),o.fromTemplateUrl("auth.html",{scope:n}).then(function(t){n.authDialog=t}),n.showAuthBox=function(){n.authDialog.show()},n.closeAuthBox=function(){n.authDialog.hide()},n.$on("$stateChangeStart",function(t,e){if(l.isLoggedIn()===!1){var r=u.get("access_token");r?l.authenticate(r).then(function(){}).catch(function(){u.remove("access_token")}):e.loginRequired&&n.authDialog.show()}}),n.$on("alertStart",function(t,n,e){var r=e||{};angular.extend(r,{template:n||'<ion-spinner icon="spiral"></ion-spinner>'}),s.show(r)}),n.$on("alertEnd",function(){s.hide()}),n.$on("alert",function(t,n,e){if(window.cordova)a.show(n,"short","center");else{var r=e||{};angular.extend(r,{template:n||'<ion-spinner icon="spiral"></ion-spinner>',duration:1e3}),s.show(r)}}),"alreadyShow"!==u.get("introPage")&&e.go("intro")}]).config(["$httpProvider","$stateProvider","$urlRouterProvider","$ionicConfigProvider","$ionicNativeTransitionsProvider",function(t,n,e,r){r.views.maxCache(5),n.state("tab",{url:"","abstract":!0,templateUrl:"tabs.html",controller:"tabsCtrl"}).state("intro",{url:"/intro",templateUrl:"intro.html",controller:"introCtrl"}).state("tab.home",{url:"/home",nativeTransitions:null,views:{"tab-home":{controller:"homeCtrl",templateUrl:"home.html"}},loginRequired:!0}).state("tab.cateHome",{url:"/cateHome",nativeTransitions:null,views:{"tab-home":{controller:"cateHomeCtrl",templateUrl:"cateHome.html"}},loginRequired:!0}).state("tab.noti",{url:"/notification",nativeTransitions:null,views:{"tab-noti":{controller:"notificationCtrl",templateUrl:"notification.html"}},loginRequired:!0}).state("logout",{url:"/logout",controller:"logoutCtrl"}).state("tab.explore",{url:"/explore",nativeTransitions:null,views:{"tab-explore":{templateUrl:"photogram/home.html",controller:"exploreCtrl"}},loginRequired:!0}).state("tab.postDetail",{url:"/postDetail/:postID",views:{"tab-explore":{templateUrl:"photogram/postDetail.html",controller:"postDetailCtrl"}}}).state("tab.userDetail",{url:"/userDetail/:userID",views:{"tab-explore":{templateUrl:"userDetail.html",controller:"userDetailCtrl"}}}).state("tab.accountUserDetail",{url:"/userDetail/:userID",views:{"tab-account":{templateUrl:"userDetail.html",controller:"userDetailCtrl"}}}).state("tab.userList",{url:"/userList/:userID/:userType",views:{"tab-explore":{templateUrl:"userList.html",controller:"userListCtrl"}}}).state("tab.myuserList",{url:"/myuserList/:userID/:userType",views:{"tab-account":{templateUrl:"userList.html",controller:"userListCtrl"}}}).state("tab.account",{url:"/account",nativeTransitions:null,views:{"tab-account@tab":{templateUrl:"account.html",controller:"accountCtrl"}}}).state("tab.coupons",{url:"/coupons",views:{"tab-account@tab":{templateUrl:"coupons.html",controller:"couponsCtrl"}}}).state("tab.settings",{url:"/settings",views:{"tab-account@tab":{templateUrl:"settings.html",controller:"settingsCtrl"}}}).state("tab.profile",{url:"/account/profile",views:{"tab-account":{templateUrl:"profile.html",controller:"profileCtrl"}}}).state("tab.about",{url:"/about",views:{"tab-account@tab":{templateUrl:"about.html",controller:"aboutCtrl"}}}).state("tab.cart",{url:"/cart",nativeTransitions:null,views:{"tab-home":{templateUrl:"cart.html",controller:"cartCtrl"}}}).state("tab.checkout",{url:"/checkout",views:{"tab-home":{templateUrl:"checkout.html",controller:"checkoutCtrl"}}}).state("tab.categories",{url:"/categories",views:{"tab-home":{templateUrl:"category.html",controller:"categoryCtrl"}}}).state("tab.category",{url:"/category/:en/:cn",views:{"tab-home":{templateUrl:"item/items.html",controller:"itemsCtrl"}}}).state("tab.search",{url:"/search/:query",views:{"tab-home":{templateUrl:"item/items.html",controller:"itemsCtrl"}}}).state("tab.payment.success",{url:"/payment/success",views:{"tab-home":{controller:"paymentSuccessCtrl"}}}).state("tab.payment.cancel",{url:"/payment/cancel",views:{"tab-home":{controller:"paymentCancelCtrl"}}}).state("tab.item",{url:"/item/:itemID",views:{"tab-home":{templateUrl:"item.html",controller:"itemCtrl"}}}).state("tab.board",{url:"/board/:boardID",views:{"tab-home":{templateUrl:"board.html",controller:"boardCtrl"}}}).state("tab.address",{url:"/address",cache:!1,views:{"tab-home":{templateUrl:"address.html",controller:"addressCtrl"}}}).state("tab.address_list",{url:"/address/list",cache:!1,views:{"tab-account":{templateUrl:"address_list.html",controller:"addressCtrl"}}}).state("tab.orders",{url:"/orders",views:{"tab-account":{templateUrl:"orders.html",controller:"ordersCtrl"}}}).state("tab.order_detail",{url:"/order/:order_id",views:{"tab-account":{templateUrl:"order.html",controller:"orderDetailCtrl"}}}).state("tab.order_logistic",{url:"/order/logistics/:order_id",views:{"tab-account":{templateUrl:"logistics.html",controller:"logisticsDetailCtrl"}}}).state("tab.order_transfer",{url:"/order/transfer/:order_id",views:{"tab-account":{templateUrl:"transfer_logistics.html",controller:"logisticsDetailCtrl"}}}).state("tab.express",{url:"/express",views:{"tab-home":{templateUrl:"expressForm.html",controller:"expressCtrl"}}}).state("tab.express_add",{url:"/express/add",views:{"tab-home":{templateUrl:"expressItem_add.html",controller:"expressItemAddCtrl"}}}).state("tab.order_entry",{url:"/order/entry/:itemID",views:{"tab-account":{templateUrl:"item.html",controller:"itemCtrl"}}}).state("tab.calculate",{url:"/calculate",views:{"tab-home":{templateUrl:"calFee.html",controller:"calculateCtrl"}}}).state("tab.favors",{url:"/favors",views:{"tab-account":{templateUrl:"favors.html",controller:"favorCtrl"}}}).state("tab.like_posts",{url:"/like_posts",views:{"tab-account":{templateUrl:"photogram/like_posts.html",controller:"likePostsCtrl"}}}).state("tab.myPostDetail",{url:"/myPostDetail/:postID",views:{"tab-account":{templateUrl:"photogram/postDetail.html",controller:"postDetailCtrl"}}}).state("tab.my_posts",{url:"/my_posts",views:{"tab-account":{templateUrl:"photogram/my_posts.html",controller:"myPostsCtrl"}}}).state("tab.faq",{url:"/faq",views:{"tab-account":{templateUrl:"faq.html",controller:"faqCtrl"}}}).state("tab.limit",{url:"/limit",views:{"tab-home":{templateUrl:"limit.html",controller:"faqCtrl"}}}).state("tab.cs",{url:"/customer-service",views:{"tab-account":{templateUrl:"cs.html",controller:"csCtrl"}}}).state("tab.feedback",{url:"/feedback",views:{"tab-account":{templateUrl:"feedback.html",controller:"feedbackCtrl"}}}),e.otherwise("/explore"),t.interceptors.push("timeoutHttpIntercept"),AWS.config.update({accessKeyId:"AKIAI4JD55P3DQLOXQKQ",secretAccessKey:"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"}),AWS.config.region="us-west-1"}]),homeCtrl.$inject=["$scope","$rootScope","$log","$timeout","$state","$ionicModal","ngCart","$ionicSlideBoxDelegate","Board","Items","FetchData","Categories"],cateHomeCtrl.$inject=["$scope","$rootScope","$log","$timeout","$state","$ionicModal","$ionicScrollDelegate","ngCart","Items","FetchData","Categories"],introCtrl.$inject=["$rootScope","$scope","$state","FetchData","$ionicSlideBoxDelegate","Storage"],exploreCtrl.$inject=["$scope","$rootScope","$state","$ionicModal","$ionicPopover","Photogram","FetchData"],notificationCtrl.$inject=["$rootScope","$scope","$state","Notification"],myPostsCtrl.$inject=["$scope","$rootScope","$state","$ionicModal","$ionicPopover","AuthService","Photogram"],likePostsCtrl.$inject=["$scope","$rootScope","$state","$ionicModal","$ionicPopover","AuthService","Photogram"],postDetailCtrl.$inject=["$scope","$rootScope","$state","$stateParams","Photogram","AuthService","$ionicPopup","photoShare"],userDetailCtrl.$inject=["$scope","$rootScope","$state","FetchData","$stateParams","AuthService","Photogram","User","$ionicScrollDelegate"],userListCtrl.$inject=["$scope","$rootScope","$state","FetchData","$stateParams","AuthService","User"],tabsCtrl.$inject=["$scope","$rootScope","$state","$ionicModal","$cordovaToast","Photogram","PhotoService","$timeout","geoService","FetchData"],feedbackCtrl.$inject=["$scope","FetchData","$rootScope"],csCtrl.$inject=["$rootScope","$scope"],faqCtrl.$inject=["$rootScope","$scope"],couponsCtrl.$inject=["$rootScope","$scope","AuthService"],categoryCtrl.$inject=["$rootScope","$scope","FetchData","$state"],authCtrl.$inject=["$rootScope","$scope","FetchData","$state","AuthService","$ionicModal","$cordovaFacebook"],signupCtrl.$inject=["$rootScope","$scope","AuthService"],accountCtrl.$inject=["$rootScope","$scope","AuthService","User","Photogram","$ionicScrollDelegate"],profileCtrl.$inject=["$scope","AuthService","$state","$rootScope","PhotoService","$http","ENV","$ionicPopup"],bindEmailCtrl.$inject=["$rootScope","$scope","AuthService"],forgotPWCtrl.$inject=["$rootScope","$scope","AuthService"],settingsCtrl.$inject=["$rootScope","$scope","$state","AuthService"],paymentSuccessCtrl.$inject=["$location","$timeout"],itemCtrl.$inject=["$scope","$rootScope","$stateParams","FetchData","$ionicModal","$ionicSlideBoxDelegate","sheetShare","$cordovaSocialSharing"],itemsCtrl.$inject=["$rootScope","$scope","Items","$state","$stateParams"],boardCtrl.$inject=["$scope","$rootScope","$stateParams","FetchData","$state"],favorCtrl.$inject=["$rootScope","$scope","FetchData","$state"],ordersCtrl.$inject=["$rootScope","$scope","FetchData","ngCart"],calculateCtrl.$inject=["$rootScope","$scope","$location","FetchData"],expressCtrl.$inject=["$rootScope","$scope","FetchData","ngCart","AuthService","$state","expressList"],expressItemAddCtrl.$inject=["$rootScope","$scope","expressList"],orderDetailCtrl.$inject=["$rootScope","$scope","$state","$stateParams","FetchData","ngCart","$ionicPopup"],logisticsDetailCtrl.$inject=["$rootScope","$scope","$stateParams","$state","FetchData","ngCart"],cartCtrl.$inject=["FetchData","$rootScope","$scope","ngCart"],checkoutCtrl.$inject=["$state","$scope","$rootScope","FetchData","ngCart"],addressCtrl.$inject=["$rootScope","$state","$scope","FetchData","ngCart"],aboutCtrl.$inject=["$rootScope","$scope","$state","appUpdateService"];var controllersModule=angular.module("maybi.controllers",[]);controllersModule.controller("homeCtrl",homeCtrl),controllersModule.controller("cateHomeCtrl",cateHomeCtrl),controllersModule.controller("introCtrl",introCtrl),controllersModule.controller("exploreCtrl",exploreCtrl),controllersModule.controller("notificationCtrl",notificationCtrl),controllersModule.controller("myPostsCtrl",myPostsCtrl),controllersModule.controller("likePostsCtrl",likePostsCtrl),controllersModule.controller("postDetailCtrl",postDetailCtrl),controllersModule.controller("userDetailCtrl",userDetailCtrl),controllersModule.controller("userListCtrl",userListCtrl),controllersModule.controller("tabsCtrl",tabsCtrl),controllersModule.controller("feedbackCtrl",feedbackCtrl),controllersModule.controller("csCtrl",csCtrl),controllersModule.controller("faqCtrl",faqCtrl),controllersModule.controller("couponsCtrl",couponsCtrl),controllersModule.controller("categoryCtrl",categoryCtrl),controllersModule.controller("authCtrl",authCtrl),controllersModule.controller("signupCtrl",signupCtrl),controllersModule.controller("accountCtrl",accountCtrl),controllersModule.controller("profileCtrl",profileCtrl),controllersModule.controller("bindEmailCtrl",bindEmailCtrl),controllersModule.controller("forgotPWCtrl",forgotPWCtrl),controllersModule.controller("settingsCtrl",settingsCtrl),controllersModule.controller("paymentSuccessCtrl",paymentSuccessCtrl),controllersModule.controller("paymentCancelCtrl",paymentCancelCtrl),controllersModule.controller("itemCtrl",itemCtrl),controllersModule.controller("itemsCtrl",itemsCtrl),controllersModule.controller("boardCtrl",boardCtrl),controllersModule.controller("favorCtrl",favorCtrl),controllersModule.controller("ordersCtrl",ordersCtrl),controllersModule.controller("calculateCtrl",calculateCtrl),controllersModule.controller("expressCtrl",expressCtrl),controllersModule.controller("expressItemAddCtrl",expressItemAddCtrl),controllersModule.controller("orderDetailCtrl",orderDetailCtrl),controllersModule.controller("logisticsDetailCtrl",logisticsDetailCtrl),controllersModule.controller("cartCtrl",cartCtrl),controllersModule.controller("checkoutCtrl",checkoutCtrl),controllersModule.controller("addressCtrl",addressCtrl),controllersModule.controller("fourZeroFour_controller",fourZeroFour_controller),controllersModule.controller("aboutCtrl",aboutCtrl),angular.module("maybi.services",[]).factory("timeoutHttpIntercept",function(){return{request:function(t){return t.timeout=1e4,t}}}).service("sheetShare",["$rootScope","$bottomSheet",function(t,n){function e(e,r){n.show({buttons:[[{btText:"微信好友",btClass:"icon fa fa-weixin",btId:"0",hideOnClick:!0},{btText:"朋友圈",btClass:"icon pyq",btId:"1"},{btText:"微博",btClass:"icon fa fa-weibo",btId:"2"},{btText:"QQ好友",btClass:"icon fa fa-qq",btId:"3"}]],titleText:"分享到",buttonClicked:function(n){if("post"==r)var i=e.title.substr(0,24),o="来自美比，比邻中国的海外生活。",s="http://www.may.bi/",a=e.small_url;else var i=e.title.substr(0,24),o="来自美比，比邻中国的海外生活。",s="http://may.bi/#/items/"+e.item_id,a=e.small_thumbnail;var c=function(){t.$broadcast("alert","分享成功")},l=function(n){t.$broadcast("alert",n)};if(0==n.btId||1==n.btId)window.Wechat.share({message:{title:i,description:o,thumb:a,media:{type:Wechat.Type.LINK,webpageUrl:s}},scene:n.btId},c,l);else if(2==n.btId){var d={};d.url=s,d.title=i,d.description=o,d.imageUrl=a,d.defaultText="",window.YCWeibo.shareToWeibo(c,l,d)}else if(3==n.btId){var d={};d.url=s,d.title=i,d.description=o,d.imageUrl=a,d.appName="美比客户端",window.YCQQ.shareToQQ(function(){},l,d)}}})}this.popup=e}]).service("share",["$rootScope","$ionicActionSheet",function(t,n){function e(e){function r(n){var r=e.title,i="美比，给您比邻中国的海外生活。",o="http://may.bi/#/items/"+e.item_id,s=e.small_thumbnail,a=function(){t.$broadcast("alert","分享成功")},c=function(n){t.$broadcast("alert",n)};if(0==n||1==n)window.Wechat.share({message:{title:r,description:i,thumb:s,media:{type:Wechat.Type.LINK,webpageUrl:o}},scene:n},a,c);else if(2==n){var l={};l.url=o,l.title=r,l.description=i,l.imageUrl=s,l.defaultText="",window.YCWeibo.shareToWeibo(a,c,l)}else if(3==n){var l={};l.url=o,l.title=r,l.description=i,l.imageUrl=s,l.appName="美比客户端",window.YCQQ.shareToQQ(function(){},c,l)}}var i={};i.cancelText="取消",i.buttonClicked=r,i.buttons=[{text:'<i class="icon fa fa-weixin"></i> 发送给微信好友'},{text:'<i class="icon fa fa-weixin"></i> 分享到朋友圈'},{text:'<i class="icon fa fa-weibo"></i> 分享到微博'},{text:'<i class="icon fa fa-qq"></i> 发送给QQ好友'}],n.show(i)}this.popup=e}]).factory("Storage",function(){return{set:function(t,n){return window.localStorage.setItem(t,window.JSON.stringify(n))},get:function(t){return window.JSON.parse(window.localStorage.getItem(t))},remove:function(t){return window.localStorage.removeItem(t)}}}).factory("AuthService",["ENV","$http","Storage","$state","$q",function(t,n,e,r,i){var o=!1,s=e.get("user")||{};return{isLoggedIn:function(){return o?!0:!1},login:function(r,a){var c=i.defer();return n.post(t.SERVER_URL+"/api/auth/login_email",{email:r,password:a}).success(function(t,n){200===n&&"OK"==t.message?(o=!0,s=t.user,e.set("user",t.user),e.set("access_token",t.remember_token),window.cordova&&window.cordova.plugins&&plugins.jPushPlugin.setAlias(t.user.id),c.resolve()):(o=!1,c.reject())}).error(function(){o=!1,c.reject()}),c.promise},setUsername:function(r){var o=i.defer();return n.post(t.SERVER_URL+"/api/users/update_username",{username:r}).success(function(t,n){200===n&&"OK"==t.message?(s=t.user,e.set("user",t.user),o.resolve(t)):o.reject(t)}).error(function(t){o.reject(t)}),o.promise},updateAvatar:function(r){var o=i.defer();return n.post(t.SERVER_URL+"/api/users/update_avatar",{avatar_url:r}).success(function(t,n){200===n&&"OK"==t.message?(s=t.user,e.set("user",t.user),o.resolve(t)):o.reject(t)}).error(function(t){o.reject(t)}),o.promise},bindEmail:function(r,a){var c=i.defer();return n.post(t.SERVER_URL+"/api/auth/bind_email",{email:r,user_id:a}).success(function(t,n){200===n&&"OK"==t.message?(o=!0,s=t.user,e.set("user",t.user),e.set("access_token",t.remember_token),window.cordova&&window.cordova.plugins&&plugins.jPushPlugin.setAlias(t.user.id),c.resolve()):(o=!1,c.reject(t))}).error(function(){o=!1,c.reject()}),c.promise},forgotPassword:function(e){var r=i.defer();return n.post(t.SERVER_URL+"/api/auth/forgot_password",{email:e}).success(function(t,n){200===n&&"OK"==t.message?r.resolve():(o=!1,r.reject(t))}).error(function(){o=!1,r.reject()}),r.promise},logout:function(){var r=i.defer();return n.get(t.SERVER_URL+"/api/auth/logout").success(function(){o=!1,s={},e.remove("user"),e.remove("access_token"),r.resolve()}).error(function(){o=!1,r.reject()}),r.promise},authenticate:function(r){var a=i.defer();return n.post(t.SERVER_URL+"/api/auth/login_with_token",{token:r}).success(function(t,n){200===n&&"OK"==t.message?(o=!0,s=t.user,e.set("user",t.user),e.set("access_token",t.remember_token),window.cordova&&window.cordova.plugins&&plugins.jPushPlugin.setAlias(t.user.id),a.resolve()):(o=!1,a.reject())}).error(function(){o=!1,a.reject()}),a.promise},oauth:function(r,a){var c=i.defer();return n.get(t.SERVER_URL+"/api/auth/oauth/"+r,{params:a}).success(function(t){"OK"==t.message&&t.login===!0?(o=!0,s=t.user,e.set("user",t.user),e.set("access_token",t.remember_token),window.cordova&&window.cordova.plugins&&plugins.jPushPlugin.setAlias(t.user.id),c.resolve(t)):"OK"==t.message&&t.login===!1&&(o=!1,c.resolve(t))}).error(function(){o=!1,c.reject()}),c.promise},register:function(r){var a=i.defer();return n.post(t.SERVER_URL+"/api/auth/signup",{email:r.email,password:r.password,name:r.name}).success(function(t,n){200===n&&"OK"==t.message?(o=!0,s=t.user,e.set("user",t.user),e.set("access_token",t.remember_token),window.cordova&&window.cordova.plugins&&plugins.jPushPlugin.setAlias(t.user.id),a.resolve()):(o=!1,a.reject(t))}).error(function(){a.reject()}),a.promise},getUser:function(){return s}}}]).factory("User",["ENV","$http","$state","$q",function(t,n,e,r){function i(e){var i=r.defer();
return n.get(t.SERVER_URL+"/api/users/unfollow/"+e).success(function(){i.resolve()}).error(function(){i.reject()}),i.promise}function o(e){var i=r.defer();return n.get(t.SERVER_URL+"/api/users/follow/"+e).success(function(){i.resolve()}).error(function(){i.reject()}),i.promise}function s(e,i){var o=r.defer();return l=!0,d=!1,n.get(t.SERVER_URL+"/api/users/followers",{params:{page:i,per_page:u,user_id:e}}).success(function(t,n){200===n&&"OK"==t.message?(t.users.length<u&&(l=!1),0==i&&0===t.users.length&&(d=!0),o.resolve(t)):o.reject()}).error(function(){o.reject()}),o.promise}function a(e,i){var o=r.defer();return l=!0,d=!1,n.get(t.SERVER_URL+"/api/users/followings",{params:{page:i,per_page:u,user_id:e}}).success(function(t,n){200===n&&"OK"==t.message?(t.users.length<u&&(l=!1),0==i&&0===t.users.length&&(d=!0),o.resolve(t)):o.reject()}).error(function(){o.reject()}),o.promise}function c(e,i){var o=r.defer();return l=!0,d=!1,n.get(t.SERVER_URL+"/api/post/"+e+"/likes",{params:{page:i,per_page:u}}).success(function(t,n){200===n&&"OK"==t.message?(t.users.length<u&&(l=!1),0==i&&0===t.users.length&&(d=!0),o.resolve(t)):o.reject()}).error(function(){o.reject()}),o.promise}var l=!0,d=!1,u=20;return{getFollowers:s,getFollowings:a,getPostLikeUsers:c,follow:o,unfollow:i,hasNextPage:function(){return l},isEmpty:function(){return d}}}]).factory("Items",["ENV","$http","$log","$q","$rootScope","Storage",function(t,n,e,r){var i=[],o="",s=!0,a=0,c=12,l=!1;return{fetchTopItems:function(){var e=r.defer();return s=!0,l=!1,n.get(t.SERVER_URL+"/api/items",{params:{main_category:o,page:0,per_page:c}}).success(function(t,n){200===n&&"OK"==t.message?(t.items.length<c&&(s=!1),a=1,e.resolve(t),0===t.items.length&&(l=!0)):e.reject()}).error(function(){e.reject()}),e.promise},searchItems:function(e,i,o){var d=r.defer();return s=!0,l=!1,n.get(t.SERVER_URL+"/api/items",{params:{sub_category:i,page:o,per_page:c,title:e}}).success(function(t,n){200===n&&"OK"==t.message?(t.items.length<c&&(s=!1),a=1,d.resolve(t),0==o&&0===t.items.length&&(l=!0)):d.reject()}).error(function(){d.reject()}),d.promise},getItems:function(){return i},setCurrentTab:function(t){o=t},getCurrentTab:function(){return o},increaseNewItems:function(){var e=r.defer();return n.get(t.SERVER_URL+"/api/items",{params:{main_category:o,page:a,per_page:c}}).success(function(t,n){200===n&&"OK"==t.message?(t.items.length<c&&(s=!1),a++,e.resolve(t)):e.reject()}).error(function(){e.reject()}),e.promise},hasNextPage:function(){return s},isEmpty:function(){return l}}}]).factory("FetchData",["$rootScope","$http","$q","ENV","$ionicLoading",function(t,n,e,r,i){return{get:function(t,o){var s=r.SERVER_URL+t,a=e.defer();return n({method:"GET",url:s,params:o}).success(function(t,n){200===n&&"OK"==t.message?a.resolve(t):(i.show(404==n||302==n?{template:"请先登录",duration:1e3}:{template:t.error||"出错了",duration:1e3}),a.reject())}).error(function(t,n){i.show({template:"网络出错, "+n,duration:1e3}),a.reject()}),a.promise},post:function(t,o){var s=r.SERVER_URL+t,a=e.defer();return n({method:"POST",url:s,data:o}).success(function(t,n){200===n&&"OK"==t.message?a.resolve(t):(i.show(404==n||302==n?{template:"请先登录",duration:1e3}:{template:t.error||"出错了",duration:1e3}),a.reject())}).error(function(t,n){i.show({template:"网络出错, "+n,duration:1e3}),a.reject()}),a.promise}}}]).service("expressList",function(){var t=[];this.get=function(){return t},this.add=function(n){t.push(n)},this.empty=function(){t=[]}}).service("ngCart",["$rootScope","$http","ngCartItem","Storage","ENV",function(t,n,e,r,i){this.attrMap={size:"尺寸",color:"颜色",style:"样式"},this.init=function(){this.$cart={shipping:null,taxRate:null,tax:null,items:[],selectedItems:[]},this.$addr={id:void 0,data:{}}},this.setAddress=function(t){this.$addr.id=t.id,this.$addr.data=t},this.getAddress=function(){var t=this;return void 0===this.$addr.id&&n.get(i.SERVER_URL+"/api/address/default").success(function(n){n.address&&t.setAddress(n.address)}),this.$addr},this.addItem=function(e,r,o,s){var a=this;n.post(i.SERVER_URL+"/api/cart/add/"+e,{quantity:s}).success(function(t){a.$loadCart(t.cart)}).error(function(){}),t.$broadcast("specsModal:hide"),t.$broadcast("ngCart:change","商品已添加到购物车")},this.selectItem=function(t){var n=this.getItemById(t);"object"==typeof n&&this.$cart.selectedItems.push(n)},this.getItemById=function(t){var n=this.getCart().items,e=!1;return angular.forEach(n,function(n){n.getId()===t&&(e=n)}),e},this.getSelectedItemById=function(t){var n=this.getCart().selectedItems,e=!1;return angular.forEach(n,function(n){n.getId()===t&&(e=n)}),e},this.setShipping=function(t){return this.$cart.shipping=t,this.getShipping()},this.getShipping=function(){return 0===this.getCart().items.length?0:this.getCart().shipping},this.setTaxRate=function(t){return this.$cart.taxRate=+parseFloat(t).toFixed(2),this.getTaxRate()},this.getTaxRate=function(){return this.$cart.taxRate},this.getTax=function(){return+parseFloat(this.getSubTotal()/100*this.getCart().taxRate).toFixed(2)},this.setCart=function(t){return this.$cart=t,this.getCart()},this.getCart=function(){return this.$cart},this.getItems=function(){return this.getCart().items},this.getSelectedItems=function(){return this.getCart().selectedItems},this.getTotalItems=function(){var t=0,n=this.getItems();return angular.forEach(n,function(n){t+=n.getQuantity()}),t},this.getTotalSelectedItems=function(){var t=0,n=this.getSelectedItems();return angular.forEach(n,function(n){t+=n.getQuantity()}),t},this.getTotalUniqueItems=function(){return this.getCart().items.length},this.getSubTotal=function(){var t=0;return angular.forEach(this.getCart().selectedItems,function(n){t+=n.getTotal()}),+parseFloat(t).toFixed(2)},this.totalCost=function(){return+parseFloat(this.getSubTotal()+this.getShipping()+this.getTax()).toFixed(2)},this.removeItemById=function(e){var r=this,o=this.getCart();angular.forEach(o.items,function(t,n){t.getId()===e&&o.items.splice(n,1)}),n.post(i.SERVER_URL+"/api/cart/entry/delete",{skus:[e]}).success(function(){r.$loadCart(res.cart)}),t.$broadcast("ngCart:change","商品已从购物车清除")},this.removeSelectedItemById=function(t){var n=this.getCart();angular.forEach(n.selectedItems,function(e,r){e.getId()===t&&n.selectedItems.splice(r,1)}),this.setCart(n)},this.empty=function(){t.$broadcast("ngCart:change","已成功清空购物车"),this.$cart.items=[],localStorage.removeItem("cart")},this.isEmpty=function(){return this.$cart.items.length>0?!1:!0},this.selectedItemsObjects=function(){if(0===this.getSelectedItems().length)return!1;var t=[];return angular.forEach(this.getSelectedItems(),function(n){t.push({item_id:n._data.item.item_id,sku:n._id,quantity:n._quantity})}),t},this.toObject=function(){if(0===this.getSelectedItems().length)return!1;var t=[];return angular.forEach(this.getSelectedItems(),function(n){t.push(n.toObject())}),{shipping:this.getShipping(),tax:this.getTax(),taxRate:this.getTaxRate(),subTotal:this.getSubTotal(),totalCost:this.totalCost(),items:t}},this.$restore=function(t){var n=this;n.init(),angular.forEach(t.items,function(t){n.$cart.items.push(new e(t._id,t._name,t._price,t._quantity,t._data))}),this.$save()},this.$loadCart=function(t){var n=this;n.init(),angular.forEach(t,function(t){n.$cart.items.push(new e(t.spec.sku,t.item.title,t.unit_price,t.quantity,t))}),this.$save()},this.$save=function(){return r.set("cart",this.getCart())}}]).service("ngCartItem",["$rootScope","$log",function(t,n){var e=function(t,n,e,r,i){this.setId(t),this.setName(n),this.setPrice(e),this.setQuantity(r),this.setData(i)};return e.prototype.setId=function(t){t?this._id=t:n.error("An ID must be provided")},e.prototype.getId=function(){return this._id},e.prototype.setName=function(t){t?this._name=t:n.error("A name must be provided")},e.prototype.getName=function(){return this._name},e.prototype.setPrice=function(t){var e=parseFloat(t);e?0>=e?n.error("A price must be over 0"):this._price=e:n.error("A price must be provided")},e.prototype.getPrice=function(){return this._price},e.prototype.setQuantity=function(t,e){var r=parseInt(t);r%1===0?(e===!0?this._quantity+=r:this._quantity=r,this._quantity<1&&(this._quantity=1),this._quantity>=5&&(this._quantity=5)):(this._quantity=1,n.info("Quantity must be an integer and was defaulted to 1"))},e.prototype.getQuantity=function(){return this._quantity},e.prototype.setData=function(t){t&&(this._data=t)},e.prototype.getData=function(){return this._data?this._data:void n.info("This item has no data")},e.prototype.getTotal=function(){return+parseFloat(this.getQuantity()*this.getPrice()).toFixed(2)},e.prototype.toObject=function(){return{id:this.getId(),name:this.getName(),price:this.getPrice(),quantity:this.getQuantity(),data:this.getData(),total:this.getTotal()}},e}]).service("fulfilmentProvider",["ngCart","$rootScope","fulfilmentNewOrder","fulfilmentTransferOrder","fulfilmentExistedOrder",function(t,n,e,r,i){this._obj={service:void 0,settings:void 0},this.setService=function(t){this._obj.service=t},this.setSettings=function(t){this._obj.settings=t},this.checkout=function(){if("new"==this._obj.settings.order_type){if(void 0===t.getAddress().id)return void n.$broadcast("ngCart:change","请添加地址");if(void 0===this._obj.settings.logistic_provider)return void n.$broadcast("ngCart:change","请选择运输方式");var o=e}else if("transfer"==this._obj.settings.order_type){if(void 0===t.getAddress().id)return void n.$broadcast("ngCart:change","请添加地址");if(void 0===this._obj.settings.logistic_provider)return void n.$broadcast("ngCart:change","请选择运输方式");var o=r}else if("existed"==this._obj.settings.order_type)var o=i;return o.checkout(this._obj.service,this._obj.settings)}}]).service("fulfilmentNewOrder",["$rootScope","$http","ngCart","ENV","$injector",function(t,n,e,r,i){this.checkout=function(o,s){return t.$broadcast("alertStart","正在处理，请稍等.."),n.post(r.SERVER_URL+"/api/orders/create_order",{entries:e.selectedItemsObjects(),address_id:e.getAddress().id,coupon_codes:s.coupon?[s.coupon]:[],logistic_provider:s.logistic_provider}).then(function(t){var n=i.get("fulfilment_"+o);n.checkout(t.data)},function(){t.$broadcast("alertEnd"),t.$broadcast("alert","sorry...something wrong(1)..")})}}]).service("fulfilmentExistedOrder",["$rootScope","$http","ngCart","ENV","$injector",function(t,n,e,r,i){this.checkout=function(n,e){t.$broadcast("alertStart","正在处理，请稍等..");var r=i.get("fulfilment_"+n);return r.checkout(e)}}]).service("fulfilmentTransferOrder",["$rootScope","$http","ngCart","ENV","$injector",function(t,n,e,r,i){this.checkout=function(o,s){return t.$broadcast("alertStart","正在处理，请稍等.."),n.post(r.SERVER_URL+"/api/orders/update_transfer_order",{order_id:s.order_id,address_id:e.getAddress().id,coupon_codes:s.coupon?[s.coupon]:[],logistic_provider:s.logistic_provider}).then(function(t){var n=i.get("fulfilment_"+o);n.checkout(t.data)},function(){t.$broadcast("alertEnd"),t.$broadcast("alert","sorry...something wrong(1)..")})}}]).service("fulfilment_paypal",["$rootScope","$http","PaypalService","ENV","$state","$timeout",function(t,n,e,r,i,o){this.checkout=function(s){t.$broadcast("alertEnd");var a="Maybi Order "+s.order.sid;e.initPaymentUI().then(function(){e.makePayment(s.order.final,a).then(function(e){n.post(r.SERVER_URL+"/payment/paypal/notify",{payment:e,order_id:s.order_id}).success(function(n){"OK"==n.message?(t.$broadcast("alert","支付成功"),o(function(){i.go("tab.order_detail",{order_id:s.order_id},{reload:!0})},1e3)):t.$broadcast("alert","支付失败")}).error(function(){t.$broadcast("alert","系统好像出问题。。")})}).catch(function(n){t.$broadcast("alert",n)})})}}]).service("fulfilment_wechat",["$rootScope","$http","ENV","$state","$timeout",function(t,n,e,r,i){this.checkout=function(o){n.post(e.SERVER_URL+"/payment/checkout/sdk/"+o.order_id,{payment_method:"wechat"}).then(function(n){t.$broadcast("alertEnd");var e=n.data.data,s={mch_id:e.partnerid,prepay_id:e.prepayid,nonce:e.noncestr,timestamp:e.timestamp,sign:e.sign};Wechat.sendPaymentRequest(s,function(){t.$broadcast("alert","支付成功"),i(function(){r.go("tab.order_detail",{order_id:o.order_id},{reload:!0})},1e3)},function(n){t.$broadcast("alert","Failed: "+n)})},function(){t.$broadcast("alertEnd"),t.$broadcast("alert","oppps...something wrong(2)..")})}}]).factory("PaypalService",["$q","$ionicPlatform","paypalSettings","$filter","$timeout",function(t,n,e,r,i){function o(){return d=t.defer(),n.ready().then(function(){var t={PayPalEnvironmentProduction:e.PAYPAL_LIVE_CLIENT_ID,PayPalEnvironmentSandbox:e.PAYPAL_SANDBOX_CLIENT_ID};PayPalMobile.init(t,c)}),d.promise}function s(t,n){var e=new PayPalPayment(""+t,"USD",""+n,"Sale");return e}function a(){var t=new PayPalConfiguration({merchantName:e.ShopName,merchantPrivacyPolicyURL:e.MerchantPrivacyPolicyURL,merchantUserAgreementURL:e.MerchantUserAgreementURL});return t}function c(){n.ready().then(function(){PayPalMobile.prepareToRender(e.ENV,a(),function(){i(function(){d.resolve()})})})}function l(e,o){var a=t.defer();return e=r("number")(e,2),n.ready().then(function(){PayPalMobile.renderSinglePaymentUI(s(e,o),function(t){i(function(){a.resolve(t)})},function(t){i(function(){a.reject(t)})})}),a.promise}var d,u={initPaymentUI:o,createPayment:s,configuration:a,onPayPalMobileInit:c,makePayment:l};return u}]).factory("appUpdateService",["$ionicPopup","$timeout","$ionicLoading",function(t,n,e){function r(){e.show({template:"正在检查更新...",animation:"fade-in",showBackdrop:!0,duration:3e3,showDelay:0}),a.check().then(function(t){t&&i()},function(t){})}function i(){e.hide();var n=t.confirm({title:"版本升级",cssClass:"text-center",template:"有新的版本了,是否要升级?",cancelText:"取消",okText:"升级"});n.then(function(t){e.show({template:"正在更新...",animation:"fade-in",showBackdrop:!0,showDelay:0}),t?a.update().then(function(){e.hide(),e.show({template:"更新成功!",animation:"fade-in",showBackdrop:!0,duration:2e3,showDelay:0})},function(t){e.hide(),e.show({template:"更新失败!"+t,animation:"fade-in",showBackdrop:!0,duration:2e3,showDelay:0})},function(t){e.show({template:"已经下载："+parseInt(t)+"%"})}):e.hide()})}function o(){a.info().then(function(t){var n=t.binary_version,e=t.deploy_uuid;s="NO_DEPLOY_LABEL"!=e?e:n})}var s,a=new Ionic.Deploy;return{getVersions:function(){return o(),s},checkUpdate:function(){r()},update:function(){i()}}}]).factory("Notification",["ENV","$http","$log","$q","$rootScope","Storage",function(t,n,e,r){var i=!0,o=20,s=!1;return{getNotices:function(e){var a=r.defer();return i=!0,s=!1,n.get(t.SERVER_URL+"/api/post/activities",{params:{page:e,per_page:o}}).success(function(t,n){200===n&&"OK"==t.message?(t.notices.length<o&&(i=!1),0==e&&0===t.notices.length&&(s=!0),a.resolve(t)):a.reject()}).error(function(){a.reject()}),a.promise},hasNextPage:function(){return i},isEmpty:function(){return s}}}]).factory("Board",["ENV","$http","$log","$q","$rootScope","Storage",function(t,n,e,r){var i=!0,o=5,s=!1;return{getBoards:function(e){var a=r.defer();return i=!0,s=!1,n.get(t.SERVER_URL+"/api/boards",{params:{page:e,per_page:o}}).success(function(t,n){200===n&&"OK"==t.message?(t.boards.length<o&&(i=!1),0==e&&0===t.boards.length&&(s=!0),a.resolve(t)):a.reject()}).error(function(){a.reject()}),a.promise},hasNextPage:function(){return i},isEmpty:function(){return s}}}]).factory("JPush",["ENV","$http","$log","$q","$rootScope","appUpdateService",function(t,n,e,r,i,o){function s(t){try{var n;n="Android"==ionic.Platform.platform()?window.plugins.jPushPlugin.openNotification.alert:t.aps.alert}catch(e){}}function a(t){try{var n;n="Android"==ionic.Platform.platform()?window.plugins.jPushPlugin.receiveNotification.alert:t.aps.alert}catch(e){}}function c(t){try{var n;n="Android"==ionic.Platform.platform()?window.plugins.jPushPlugin.receiveMessage.message:t.content,"update"==n&&o.checkUpdate()}catch(e){}}return{onOpenNotification:s,onReceiveNotification:a,onReceiveMessage:c}}]),angular.module("maybi.directives",[]).directive("ngcartAddtocart",["ngCart",function(t){return{restrict:"E",scope:{id:"@",name:"@",quantity:"@",quantityMax:"@",price:"@",data:"="},transclude:!0,templateUrl:function(t,n){return"undefined"==typeof n.templateUrl?"ngCart/addtocart.html":n.templateUrl},link:function(n,e,r){n.ngCart=t,n.attrs=r,n.inCart=function(){return t.getItemById(r.id)},n.q=n.inCart()?t.getItemById(r.id).getQuantity():parseInt(n.quantity),n.qtyOpt=[];for(var i=1;i<=n.quantityMax;i++)n.qtyOpt.push(i);n.alertWarning=function(){n.$emit("alert","请选择有效商品")}}}}]).directive("ngcartSummary",["ngCart",function(t){return{restrict:"E",link:function(n){n.ngCart=t},scope:{},transclude:!0,templateUrl:function(t,n){return"undefined"==typeof n.templateUrl?"ngCart/summary.html":n.templateUrl}}}]).directive("ngcartCheckout",["ngCart","fulfilmentProvider","$timeout","$ionicActionSheet",function(t,n,e,r){return{restrict:"E",link:function(e){e.ngCart=t,e.showPaymentMethods=function(){function t(t){var r={0:"paypal",1:"wechat"};n.setService(r[t]),n.setSettings(e.settings),n.checkout()}var i={};i.buttonClicked=t,i.buttons=[{text:'<i class="icon fa fa-paypal"></i> Paypal支付$'},{text:'<i class="icon fa fa-wechat"></i> 微信支付￥'}],r.show(i)}},scope:{settings:"=",show:"="},replace:!0,templateUrl:function(t,n){return"undefined"==typeof n.templateUrl?"ngCart/checkout.html":n.templateUrl}}}]).directive("zoomView",["$compile","$ionicModal","$ionicPlatform","$cordovaSocialSharing",function(t,n,e,r){return{restrict:"A",link:function(i,o,s){e.ready(function(){o.attr("ng-click","showZoomView()"),o.removeAttr("zoom-view"),t(o)(i);var e='<ion-modal-view class="zoom-view"><ion-header-bar><button ng-click="closeZoomView()" class="button button-clear button-light button-icon ion-ios-close-empty"></button></ion-header-bar><ion-content ng-click="closeZoomView()"><ion-scroll zooming="true" direction="xy" style="width: 100%; height: 100%; position: absolute; top: 0; bottom: 0; left: 0; right: 0; "><img ng-src="{{ngSrc}}" style="width: 100%!important; display:block; width: 100%; height: auto; max-width: 400px; max-height: 700px; margin: auto; padding: 10px; " /></ion-scroll> </ion-content><ion-footer-bar><h1 class="title"></h1><button class="button button-light button-icon ion-ios-download-outline" ng-click="downloadFile()"></button></ion-footer-bar>';i.zoomViewModal=n.fromTemplate(e,{scope:i,animation:"slide-in-right"}),i.showZoomView=function(){i.zoomViewModal.show(),i.ngSrc=s.zoomSrc},i.closeZoomView=function(){i.zoomViewModal.hide()},i.downloadFile=function(){var t="分享图片",n="分享",e=i.ngSrc,o="http://www.may.bi";r.share(t,n,e,o).then(function(t){},function(t){i.broadcast("alert",t)})}})}}}]).directive("showMore",["$timeout",function(t){return{templateUrl:"showMore.html",restrict:"A",replace:!0,scope:{title:"="},link:function(n,e,r){function i(){var t=e.find("p")[0].offsetHeight;t>o&&n.expanded===!1&&(n.expandable=!0)}var o=parseInt(r.showMore);n.expanded=!1,n.expandable=!1,t(function(){i()},300),n.toggle=function(){n.expanded=!n.expanded},n.showLessStyle={"max-height":o+"px",overflow:"hidden","margin-bottom":"6px"}}}}]).directive("addressForm",["$rootScope","$ionicModal","FetchData","ngCart","$state",function(t,n,e,r,i){return{restrict:"A",scope:{addrId:"=",addresses:"="},link:function(t,o){t.ngCart=r,t.addr={};var s=t.addrId;s&&e.get("/api/address/get/"+s).then(function(n){t.addr=n.address}),n.fromTemplateUrl("add_address.html",{scope:t,animation:"slide-in-right"}).then(function(n){t.addressModal=n}),t.closeModal=function(){t.addressModal.hide()},o.bind("click",function(){t.addressModal.show()}),e.get("/api/address/hierarchy").then(function(n){t.COUNTRIES=n.countries}),t.$watch('addr["country"]',function(){e.get("/api/address/hierarchy/"+t.addr.country).then(function(n){t.REGIONS=n.regions})}),t.ngCart=r,t.saveAddress=function(){s?e.post("/api/address/update/"+s,{receiver:t.addr.receiver,street1:t.addr.street1,street2:t.addr.street2,city:t.addr.city,state:t.addr.state,postcode:t.addr.postcode,country:t.addr.country,mobile_number:t.addr.mobile_number}).then(function(){t.addressModal.hide(),i.transitionTo(i.current,i.$current.params,{reload:!0,inherit:!0,notify:!0})}):e.post("/api/address/add",{receiver:t.addr.receiver,street1:t.addr.street1,street2:t.addr.street2,city:t.addr.city,state:t.addr.state,postcode:t.addr.postcode,country:t.addr.country,mobile_number:t.addr.mobile_number}).then(function(){t.addressModal.hide(),i.transitionTo(i.current,i.$current.params,{reload:!0,inherit:!0,notify:!0})})}}}}]).directive("followBtn",["User","AuthService",function(t,n){return{restrict:"E",scope:{user:"="},transclude:!0,templateUrl:"user/followButton.html",link:function(e){e.currentUserID=n.getUser().id,e.follow=function(){n.getUser();e.user.is_following?(e.user.is_following=!1,e.user.num_followers-=1,t.unfollow(e.user.id).then(function(){e.$emit("alert","已取消关注")}).catch(function(){e.user.is_following=!0,e.user.num_followers+=1})):(e.user.is_following=!0,e.user.num_followers+=1,t.follow(e.user.id).then(function(){e.$emit("alert","关注成功")}).catch(function(){e.user.is_following=!1,e.user.num_followers-=1}))}}}}]).directive("headerShrink",["$document",function(){return{restrict:"A",link:function(t,n){var e=n[0],r=document.body.querySelector(".avatar-section");t.$on("userDetailContent.scroll",function(t,n){var i=n.__scrollTop;i>=0&&(r.style[ionic.CSS.TRANSFORM]="translate3d(0, -"+Math.min(148,i)+"px, 0)",e.style.top=Math.max(64,250-i)+"px")})}}}]).directive("itemCarousel",["$state",function(t){return{restrict:"E",scope:{board:"="},templateUrl:"itemCarousel.html",link:function(n){n.items=n.board.items,n.goItem=function(n){t.go("tab.item",{itemID:n})},n.goBoard=function(){t.go("tab.board",{boardID:n.board.id})}}}}]),angular.module("maybi.constants",[]).constant("$ionicLoadingConfig",{template:"请求中..."}).constant("Categories",{"":"全部",food:"食品",home:"家居",clothes:"服饰",accessories:"配饰",electronics:"数码","office and school supplies":"办公文具",sports:"休闲健身"}).constant("ENV",{DEBUG:!1,SERVER_URL:"http://api.maybi.cn"}).constant("paypalSettings",{PAYPAL_LIVE_CLIENT_ID:"",PAYPAL_SANDBOX_CLIENT_ID:"",ENV:"PayPalEnvironmentProduction",ShopName:"Maybi Shop",MerchantPrivacyPolicyURL:"",MerchantUserAgreementURL:""}),angular.module("maybi.filters",[]).filter("reverse",function(){return function(t){return angular.isArray(t)?t.slice().reverse():!1}}).filter("nl2br",["$sce",function(t){return function(n,e){var e=e||!0,r=e?"<br />":"<br>",n=(n+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+r+"$2");return t.trustAsHtml(n)}}]),angular.module("templates",[]).run(["$templateCache",function(t){t.put("about.html",'<ion-view>\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n      <div class="title">关于我们</div>\r\n  </div>\r\n  <ion-content class="has-header account">\r\n    <ion-list>\r\n        <div class="about">\r\n          <div class="logo"></div>\r\n        </div>\r\n\r\n      <ion-item class="item item-icon-left">\r\n          <i class="icon ion-ios-flag"></i>\r\n          版本号\r\n          <span class="item-note">\r\n              {{appUpdateService.getVersions()}}\r\n          </span>\r\n      </ion-item>\r\n      <ion-item class="item item-icon-left item-icon-right" ng-click="$state.go(\'intro\')">\r\n          <i class="icon ion-ios-information-empty"></i>\r\n          介绍页\r\n          <i class="icon ion-ios-arrow-right"></i>\r\n      </ion-item>\r\n      <ion-item class="item item-icon-left item-icon-right"\r\n          onclick="window.open(\'http://may.bi/#/faq\', \'_blank\', \'location=no,toolbarposition=top,closebuttoncaption=关闭\')">\r\n          <i class="icon ion-ios-help-outline"></i>\r\n          常见问题\r\n          <i class="icon ion-ios-arrow-right"></i>\r\n      </ion-item>\r\n      <ion-item class="item item-icon-left item-icon-right"\r\n          onclick="window.open(\'http://may.bi/#/customer-service\', \'_blank\', \'location=no,toolbarposition=top,closebuttoncaption=关闭\')">\r\n          <i class="icon ion-ios-chatboxes"></i>\r\n          联系客服\r\n          <i class="icon ion-ios-arrow-right"></i>\r\n      </ion-item>\r\n      <ion-item class="item item-icon-left item-icon-right"\r\n          ng-click="$state.go(\'tab.feedback\')">\r\n          <i class="icon ion-ios-compose-outline"></i>\r\n          意见反馈\r\n          <i class="icon ion-ios-arrow-right"></i>\r\n      </ion-item>\r\n      <ion-item class="item item-icon-left item-icon-right"\r\n          onclick="window.open(\'itms-apps://itunes.apple.com/app/id1080870817\', \'_system\')" ng-if="platform.isIOS()">\r\n          <i class="icon ion-bag"></i>\r\n          评分鼓励\r\n          <i class="icon ion-ios-arrow-right"></i>\r\n      </ion-item>\r\n      <div class="copyright">\r\n        <p>Copyright @ 2015</p>\r\n        <p>深圳市美比科技有限公司</p>\r\n\r\n      </div>\r\n    </ion-list>\r\n  </ion-content>\r\n</ion-view>\r\n'),t.put("account.html",'<ion-view>\r\n    <div class="buttons">\r\n        <button class="button button-clear icon ion-ios-gear account-setting-btn pull-right"\r\n            ng-click="$state.go(\'tab.settings\')" ng-if="user.getUser().name"></button>\r\n    </div>\r\n    <div class="avatar-section">\r\n        <div ng-if="user.getUser().name">\r\n            <a class="logo" ng-click="$state.go(\'tab.profile\')"\r\n                style="background: url({{user.getUser().avatar_url}}) center no-repeat; background-size: cover">\r\n            </a>\r\n            <div class="avatar-wrap">\r\n                <p><img class="avatar" ng-src="{{user.getUser().avatar_url}}" alt=""></p>\r\n                <p ng-if="user.getUser().name" class="user">{{user.getUser().name}}</p>\r\n            </div>\r\n            <div class="social-btns">\r\n                <a ng-href="#/myuserList/{{user.getUser().id}}/followers">\r\n                    <strong>{{user.getUser().num_followers}} </strong>粉丝\r\n                </a>\r\n                <a ng-href="#/myuserList/{{user.getUser().id}}/followings">\r\n                    <strong>{{user.getUser().num_followings}} </strong>关注\r\n                </a>\r\n            </div>\r\n        </div>\r\n        <div ng-click="showAuthBox()" ng-if="!user.getUser().name">\r\n            <a\r\n                class="logo"\r\n                style="background: url(img/b7.jpg) center no-repeat; background-size: cover">\r\n            </a>\r\n            <div class="avatar-wrap">\r\n                <p><img class="avatar" ng-src="{{user.getUser().avatar_url}}" alt=""></p>\r\n                <p ng-if="!user.getUser().name" class="login-btn">登陆</p>\r\n            </div>\r\n         </div>\r\n\r\n    </div>\r\n\r\n  <ion-content class="account-view" style="top:250px" overflow-scroll=\'false\' delegate-handle="userDetailContent" on-scroll="onUserDetailContentScroll()" header-shrink scroll-event-interval="5">\r\n    <ion-list>\r\n      <div class="button-bar bar-light icon-top">\r\n          <button class="button button-icon" ng-click="$state.go(\'tab.cart\')">\r\n              <i class="icon ion-ios-cart"></i>\r\n              购物车\r\n          </button>\r\n          <button class="button button-icon" ng-click="$state.go(\'tab.orders\')">\r\n              <i class="icon ion-ios-paper-outline"></i>\r\n              订单\r\n          </button>\r\n          <button class="button button-icon" ng-click="$state.go(\'tab.coupons\')">\r\n              <i class="icon ion-ios-pricetags"></i>\r\n              折扣券\r\n          </button>\r\n      </div>\r\n\r\n      <div class="item item-divider"></div>\r\n\r\n      <div class="button-bar bar-light switch-bar">\r\n          <button class="button button-icon" ng-click="switchListStyle(\'grid\')"\r\n              ng-class="gridStyle==\'grid\'? \'active\': \'\'">\r\n              <i class="icon ion-grid"></i>\r\n          </button>\r\n          <button class="button button-icon" ng-click="switchListStyle(\'list\')"\r\n              ng-class="gridStyle==\'list\'? \'active\': \'\'">\r\n              <i class="icon ion-navicon"></i>\r\n          </button>\r\n      </div>\r\n\r\n    </ion-list>\r\n\r\n    <ion-refresher\r\n        pulling-text="下拉刷新..."\r\n        on-refresh="doRefresh()"\r\n        spinner="spiral">\r\n    </ion-refresher>\r\n    <div class="view-post">\r\n        <div class="list card " ng-if="gridStyle == \'list\'"\r\n            ng-repeat="post in posts track by $index">\r\n            <photo-list post="post" with-affix="false"></photo-list>\r\n        </div>\r\n        <div class="" ng-if="gridStyle==\'grid\'">\r\n            <div class="col col-33 grid-image" ng-repeat="post in posts track by $index">\r\n                <img ng-src="{{::post.small_url}}" ng-click="zoom(post.primary_image)">\r\n            </div>\r\n        </div>\r\n\r\n        <div class="center-ico" ng-if="isEmpty()" style=" margin-top: 20px;">\r\n            <i class="icon ion-ios-camera" style="font-size: 80pt;"\r\n                ng-click="togglePhotoModal()"></i>\r\n\r\n            <h1 >发布一条心情<br>出来露个脸呗</h1>\r\n        </div>\r\n\r\n        <ion-infinite-scroll\r\n            on-infinite="loadMore()"\r\n            distance="1"\r\n            spinner=\'spiral\'\r\n            ng-if="moreDataCanBeLoaded()">\r\n        </ion-infinite-scroll>\r\n    </div>\r\n\r\n  </ion-content>\r\n</ion-view>\r\n'),t.put("address.html",'<!-- 地址栏 -->\r\n<ion-view>\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n      <div class="title">选择地址</div>\r\n      <button class="button button-clear button-dark icon"\r\n          ng-class="editShown?\'ion-ios-color-wand-outline\': \'ion-ios-trash-outline\'"\r\n          ng-click="toggleEditShown()"></button>\r\n  </div>\r\n\r\n  <ion-content class="has-header">\r\n<section>\r\n<div class="address-select-info" ng-show="addresses.length != 0">\r\n    <div class="address-row" ng-repeat="addr in addresses"\r\n        ng-click="selectAddress(addr)">\r\n        <span class="addr-icon"></span>\r\n        <div class="address-info">\r\n            <div class="">{{addr.receiver}}</div>\r\n            <div class="">{{addr.street1}}</div>\r\n            <div class="">{{addr.street2}}</div>\r\n            <div class="">{{addr.city}}, {{addr.state}}</div>\r\n            <div class="">{{addr.country}}, {{addr.postcode}}</div>\r\n        </div>\r\n        <div ng-hide="editShown">\r\n            <span class="address-edit">\r\n                <a address-form addr-id="addr.id">修改地址</a>\r\n            </span>\r\n            <span class="select-icon select"\r\n                ng-class="{\'selected\': selectedAddress == addr}">\r\n            </span>\r\n        </div>\r\n        <div  ng-show="editShown">\r\n            <span class="close-icon" ng-click="removeAddr(addr.id)">\r\n        </div>\r\n    </div>\r\n</div>\r\n</section>\r\n\r\n<section>\r\n<div class="address-select-info" address-form>\r\n    <div class="address-row">\r\n        <span class="addr-icon"></span>\r\n        <div class="address-info">\r\n            <div class="">新增收件地址</div>\r\n        </div>\r\n        <div class="go-add">+</div>\r\n    </div>\r\n\r\n</div>\r\n</section>\r\n\r\n  </ion-content>\r\n\r\n    <ion-footer-bar class="bar-assertive footer-button" ng-click="confirmAddress()" >\r\n        <div class="title">确定</div>\r\n    </ion-footer-bar>\r\n</ion-view>\r\n'),t.put("address_list.html",'<!-- 地址栏 -->\r\n<ion-view>\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n      <div class="title">地址管理</div>\r\n      <button class="button button-clear button-dark icon"\r\n          ng-class="editShown?\'ion-ios-color-wand-outline\': \'ion-ios-trash-outline\'"\r\n          ng-click="toggleEditShown()"></button>\r\n  </div>\r\n\r\n  <ion-content class="has-header">\r\n\r\n<section>\r\n<div class="address-select-info" ng-show="addresses.length != 0">\r\n    <div class="address-row" ng-repeat="addr in addresses track by $index">\r\n        <span class="addr-icon"></span>\r\n        <div class="address-info">\r\n            <div class="">{{addr.receiver}}</div>\r\n            <div class="">{{addr.street1}}</div>\r\n            <div class="">{{addr.street2}}</div>\r\n            <div class="">{{addr.city}}, {{addr.state}}</div>\r\n            <div class="">{{addr.country}}, {{addr.postcode}}</div>\r\n        </div>\r\n        <div ng-hide="editShown">\r\n            <span class="address-edit">\r\n                <a href address-form addr-id="addr.id">修改地址</a>\r\n            </span>\r\n        </div>\r\n        <div  ng-show="editShown">\r\n            <span class="close-icon" ng-click="removeAddr(addr.id)">\r\n        </div>\r\n    </div>\r\n</div>\r\n</section>\r\n<section>\r\n<div class="address-select-info" address-form >\r\n    <div class="address-row">\r\n        <span class="addr-icon"></span>\r\n        <div class="address-info">\r\n            <div class="">新增收件地址</div>\r\n        </div>\r\n        <div class="go-add">+</div>\r\n    </div>\r\n\r\n</div>\r\n</section>\r\n\r\n  </ion-content>\r\n</ion-view>\r\n'),t.put("add_address.html",'<!-- 添加地址 -->\r\n<ion-modal-view >\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="closeModal()"></button>\r\n      <div class="title">编辑地址</div>\r\n      <button class="button button-clear button-dark" ng-click="saveAddress()">\r\n          保存\r\n      </button>\r\n  </div>\r\n\r\n  <ion-content class="has-header" style="overflow-y:hidden;">\r\n\r\n<section>\r\n<form name="addressForm" class="addressForm">\r\n\r\n    <div class="list">\r\n        <label class="item item-input">\r\n            <div class="input-label" ng-class="{\'warning\': addressForm.receiver.$error.required && !addressForm.receiver.$pristine}">\r\n                收件人全称\r\n            </div>\r\n            <input type="text" ng-model="addr.receiver" name="receiver" required />\r\n        </label>\r\n        <label class="item item-input item-select">\r\n            <div class="input-label" ng-class="addressForm.country.$error.required && !addressForm.country.$pristine">\r\n                国家\r\n            </div>\r\n            <select ng-model="addr.country" name="country" required>\r\n                <option ng-selected="addr.country== k" value="{{k}}" ng-repeat="k in COUNTRIES">{{k}}</option>\r\n            </select>\r\n        </label>\r\n        <label class="item item-input">\r\n            <div class="input-label" ng-class="{\'warning\': addressForm.street1.$error.required && !addressForm.street1.$pristine}">\r\n                地址 1\r\n            </div>\r\n            <input type="text" ng-model="addr.street1" name="street1" required />\r\n        </label>\r\n        <label class="item item-input">\r\n            <div class="input-label">\r\n                地址 2\r\n            </div>\r\n            <input type="text" ng-model="addr.street2" name="street2" required />\r\n        </label>\r\n        <label class="item item-input">\r\n            <div class="input-label" ng-class="{\'warning\': addressForm.city.$error.required && !addressForm.city.$pristine}">\r\n                城市\r\n            </div>\r\n            <input type="text" ng-model="addr.city" name="city" required />\r\n        </label>\r\n        <label class="item item-input item-select">\r\n            <div class="input-label" ng-class="addressForm.state.$error.required && !addressForm.state.$pristine">\r\n                州/省\r\n            </div>\r\n            <select ng-model="addr.state" name="state" required>\r\n                <option ng-selected="addr.state == k" value="{{k}}" ng-repeat="(k, v) in REGIONS">{{v}}</option>\r\n            </select>\r\n        </label>\r\n        <label class="item item-input">\r\n            <div class="input-label" ng-class="{\'warning\': addressForm.postcode.$error.required && !addressForm.postcode.$pristine}">\r\n                邮编\r\n            </div>\r\n            <input type="text" ng-model="addr.postcode" name="postcode" required />\r\n        </label>\r\n        <label class="item item-input">\r\n            <div class="input-label" ng-class="{\'warning\': addressForm.mobile_number.$error.required && !addressForm.mobile_number.$pristine}">\r\n                联系电话\r\n            </div>\r\n            <input type="text" ng-model="addr.mobile_number" name="mobile_number" required />\r\n        </label>\r\n    </div>\r\n</form>\r\n</section>\r\n\r\n  </ion-content>\r\n\r\n</ion-modal-view>\r\n'),t.put("auth.html",'<ion-modal-view>\r\n  <ion-header-bar>\r\n    <button class="button button-clear icon ion-ios-close-empty" ng-click="closeAuthBox()"></button>\r\n    <div class="title">登陆</div>\r\n  </ion-header-bar>\r\n  <ion-content class="login-page overlay-content" ng-controller="authCtrl" >\r\n      <div class="logo"></div>\r\n      <div class="logo-desc">比邻中国的海外生活</div>\r\n    <div class="list list-inset">\r\n      <label class="item item-input">\r\n        <input type="email" placeholder="邮箱地址" ng-model="email">\r\n      </label>\r\n\r\n      <label class="item item-input">\r\n        <input type="password" placeholder="密码" ng-model="password">\r\n      </label>\r\n    </div>\r\n\r\n    <button class="button button-block login-btn" ng-click="login()">\r\n        登陆\r\n    </button>\r\n\r\n    <div class="list login-btn-group">\r\n        <button class="button button-clear button-dark pull-left" ng-click="showForgotPWBox()">\r\n            忘记密码?\r\n        </button>\r\n        <button class="button button-clear button-dark pull-right" ng-click="showSignupBox()">\r\n            邮箱注册\r\n        </button>\r\n    </div>\r\n\r\n    <div class="third-party-box">\r\n        <p>使用第三方账号登陆</p>\r\n\r\n        <i ng-show="IsWechatInstalled" ng-click="oauthLogin(\'wechat_app\')" class="login-icon1 fa fa-wechat"></i>\r\n        <i ng-click="oauthLogin(\'weibo_app\')" class="login-icon1 fa fa-weibo"></i>\r\n        <i ng-click="oauthLogin(\'facebook_app\')" class="login-icon1 fa fa-facebook"></i>\r\n    </div>\r\n  </ion-content>\r\n</ion-modal-view>\r\n'),t.put("bindEmail.html",'<ion-modal-view>\r\n  <ion-header-bar>\r\n    <div class="buttons">\r\n      <button class="button button-clear icon ion-ios-arrow-back button-dark" ng-click="closeBindEmailBox()"></button>\r\n    </div>\r\n    <div class="title">绑定邮箱</div>\r\n  </ion-header-bar>\r\n  <ion-content class="login-page overlay-content" scroll="false" ng-controller="bindEmailCtrl">\r\n    <div class="list list-inset">\r\n      <label class="item item-input">\r\n        <input type="email" placeholder="邮箱地址" ng-model="bindEmailForm.email">\r\n      </label>\r\n    </div>\r\n\r\n    <button class="button button-block login-btn" ng-click="bind()">绑定</button>\r\n\r\n  </ion-content>\r\n</ion-modal-view>\r\n'),t.put("board.html",'<ion-view>\r\n    <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n      <div class="title">{{::board.title}}</div>\r\n    </div>\r\n\r\n    <ion-content class="has-header homepage">\r\n        <div class="item item-banner-image">\r\n            <img ng-src="{{::board.image}}">\r\n        </div>\r\n\r\n        <ion-item class="item board-desc" style="border-left: 3px solid #ea004f;">\r\n            {{::board.desc}}\r\n        </ion-item>\r\n\r\n        <div class="col col-50 "\r\n             style="display: inline-block"\r\n             ng-repeat="item in board.items track by $index" ng-click="goItem(item.item_id)">\r\n            <div class="item item-image">\r\n                <img ng-src="{{::item.thumbnail}}" cache-src>\r\n            </div>\r\n            <div class="item item-text-wrap" href="#">\r\n                <h2 class="product-title" style="overflow: hidden;">{{::item.title}}</h2>\r\n                <p class="product-prices">\r\n                    <span class="curr-price">{{::item.price | currency}}</span>\r\n                    <del class="orig-price">{{::item.orig_price | currency}}</del>\r\n                </p>\r\n            </div>\r\n        </div>\r\n\r\n\r\n\r\n\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("calFee.html",'<!-- 运费估算 -->\r\n<ion-view>\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n      <div class="title">运费估算</div>\r\n  </div>\r\n\r\n  <ion-content class="has-header">\r\n\r\n<section>\r\n<form name="queryForm" ng-submit="queryFee()">\r\n    <div class="list">\r\n        <label class="item item-input item-select">\r\n           <div class="input-label" ng-class="{\'warning\': queryForm.country.$error.required && !queryForm.country.$pristine}">\r\n                国家\r\n            </div>\r\n            <select placeholder="请选择寄往国家" ng-model="query.country" name="country"\r\n                ng-options="country for country in COUNTRIES" required>\r\n            </select>\r\n        </label>\r\n        <label class="item item-input">\r\n            <div class="input-label" ng-class="{\'warning\': queryForm.weight.$error.required && !queryForm.weight.$pristine}">\r\n               重量\r\n            </div>\r\n            <input style="margin-right: 12px" class="text-right" placeholder="请输入商品重量" type="number" ng-model="query.weight" name="weight" required /><span class="cal-unit">克</span>\r\n       </label>\r\n    </div>\r\n    <div class="padding">\r\n        <button class="button button-block button-assertive button-cart">费用估算</button>\r\n    </div>\r\n</form>\r\n</section>\r\n\r\n<section>\r\n<div class="address-select-info">\r\n    <div class="address-row" ng-repeat="provider in provider_prices track by $index">\r\n        <div class="address-info provider">\r\n            <div class="info-header">{{provider.name}}\r\n                ({{provider.service_intro.duration}})</div>\r\n            <div class="desc">首重{{provider.init_weight}}g/${{provider.init_price}}，\r\n                续重{{provider.continued_weight}}g/${{provider.continued_price}}</div>\r\n            <div class="desc">{{provider.rule_desc}}</div>\r\n        </div>\r\n        <div>\r\n            <span class="provider-price">\r\n                {{provider.cn_shipping | currency }}\r\n            </span>\r\n        </div>\r\n    </div>\r\n</div>\r\n</section>\r\n\r\n  </ion-content>\r\n</ion-view>\r\n'),t.put("cart.html",'<!-- 购物车 -->\r\n\r\n<ion-view>\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear button-dark icon ion-ios-arrow-back"  ng-click="$state.go(\'tab.home\')"></button>\r\n      <div class="title">购物车</div>\r\n      <button class="button button-clear button-dark icon" ng-class="editShown?\'ion-ios-color-wand-outline\': \'ion-ios-trash-outline\'"  ng-click="toggleEditShown()"></button>\r\n\r\n  </div>\r\n  <ion-content class="has-header has-footer has-subfooter">\r\n\r\n    <div class="center-ico"  ng-show="ngCart.getTotalItems() === 0">\r\n        <i class="icon ion-ios-cart-outline"></i>\r\n        <h1 >购物车为空\r\n        </h1>\r\n    </div>\r\n\r\n    <div ng-show="ngCart.getTotalItems() > 0">\r\n\r\n        <table class="table ngCart cart-table">\r\n            <thead>\r\n            <tr>\r\n                <td class="check-cell" ng-click="selectAllEntries()">\r\n                    <i class="icon select-icon"\r\n                        ng-class=" isSelectedAll? \'ion-ios-checkmark selected\':\'ion-ios-circle-outline\'"\r\n                        ng-hide="editShown">\r\n                    </i>\r\n                </td>\r\n\r\n                <td></td>\r\n                <td></td>\r\n                <td></td>\r\n            </tr>\r\n            </thead>\r\n\r\n            <tbody>\r\n            <tr ng-repeat="item in ngCart.getCart().items track by $index">\r\n                <td class="check-cell">\r\n                    <span class="close-icon" ng-show="editShown" ng-click="ngCart.removeItemById(item.getId())">\r\n                    </span>\r\n                    <i class="icon select-icon"\r\n                        ng-class=" ngCart.getSelectedItemById(item.getId())? \'ion-ios-checkmark selected\':\'ion-ios-circle-outline\'"\r\n                        ng-hide="editShown"\r\n                        ng-click="selectEntry(item.getId())">\r\n                    </i>\r\n\r\n                </td>\r\n\r\n                <td class="img-cell">\r\n                    <div>\r\n                        <a ng-href="#/item/{{item.getData().item.item_id}}">\r\n                            <img ng-src="{{item.getData().spec.images[0]}}">\r\n                        </a>\r\n                    </div>\r\n                </td>\r\n                <td class="info-cell">\r\n                    <div>{{ item.getName() }}</div>\r\n                    <div>\r\n                        <span ng-repeat="(k, v) in item.getData().spec.attributes">\r\n                            {{ngCart.attrMap[k]}}: {{v}}\r\n                        </span>\r\n                    </div>\r\n                    <div class="btn-group">\r\n                        <button class="btn del-num"\r\n                            ng-class="{\'disabled\':item.getQuantity()==1}"\r\n                            ng-click="setQuantity(item, -1, true)">-</button>\r\n                        <button class="btn num">{{ item.getQuantity() | number }}</button>\r\n                        <button class="btn add-num"\r\n                            ng-click="setQuantity(item, 1, true)">+</button>\r\n                    </div>\r\n                </td>\r\n                <td class="price-cell">{{ item.getTotal() | currency }}</td>\r\n            </tr>\r\n            </tbody>\r\n            <tfoot>\r\n            <tr ng-show="ngCart.getShipping()">\r\n                <td></td>\r\n                <td></td>\r\n                <td>Shipping:</td>\r\n                <td>{{ ngCart.getShipping() | currency }}</td>\r\n            </tr>\r\n            <tr>\r\n                <td class="check-cell">\r\n                </td>\r\n                <td></td>\r\n                <td colspan="2" class="total">商品总价: {{ ngCart.totalCost() | currency }}</td>\r\n            </tr>\r\n            </tfoot>\r\n\r\n        </table>\r\n    </div>\r\n\r\n  </ion-content>\r\n    <div class="bar bar-subfooter bar-stable">\r\n        <a class="button button-clear">\r\n            总价:  <span class="footer-price"> {{ ngCart.totalCost() |currency}}</span>\r\n        </a>\r\n        <button class="button button-assertive button-cart pull-right" ng-click="$state.go(\'tab.checkout\')">\r\n            结算({{ngCart.getTotalSelectedItems()}})\r\n\r\n        </button>\r\n    </div>\r\n\r\n</ion-view>\r\n'),t.put("category.html",'<ion-view>\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n      <div class="title">商品类目</div>\r\n  </div>\r\n  <ion-content class="has-header categories">\r\n        <div class="cate-row" ng-repeat="cate in categories">\r\n            <ion-item class="main">{{cate.cn}}</ion-item>\r\n            <div class="sub-list">\r\n                <div class="sub" ng-repeat="sub in cate.sub_list">\r\n                    <a ng-href="#/category/{{sub.en}}/{{sub.cn}}">{{sub.cn}}</a>\r\n                </div>\r\n            </div>\r\n        </div>\r\n  </ion-content>\r\n</ion-view>\r\n'),t.put("cateHome.html",'<ion-view>\r\n    <form>\r\n    <div class="bar bar-header item-input-inset">\r\n      <a href="#/home" class="button button-icon icon ion-navicon"></a>\r\n      <label class="item-input-wrapper">\r\n        <i class="icon ion-ios-search placeholder-icon"></i>\r\n        <input type="search" placeholder="搜索商品，种类" ng-model="searchQuery">\r\n        <input type="submit" ng-click="searchItem(searchQuery)" style="position: absolute; left: -9999px; width: 1px; height: 1px;"/>\r\n      </label>\r\n      <span class="cart-num">{{ ngCart.getTotalItems() }}</span>\r\n      <a href="#/cart" class="button button-icon icon ion-ios-cart"></a>\r\n    </div>\r\n    </form>\r\n    <div class="bar bar-subheader">\r\n      <ion-scroll direction="x" scrollbar-x="false" id="category-scroll" delegate-handle="cateScroll">\r\n        <div class="cate-scroll-row" >\r\n            <a href class="main-cate-tab" ng-repeat="(k, v) in Categories" ng-class="{\'active\': currentTab==k}" ng-click="changeTab(k, $index)">{{v}}</a>\r\n        </div>\r\n      </ion-scroll>\r\n    </div>\r\n    <ion-content class="has-header has-subheader homepage"  overflow-scroll="true">\r\n\r\n        <ion-item class="item" style="border-left: 3px solid #ea004f;">\r\n            美比严选\r\n            <span class="item-note" style="color: #ea004f;">\r\n                全场满$79.99免邮\r\n            </span>\r\n        </ion-item>\r\n\r\n        <ion-slide-box show-pager="false"\r\n            on-slide-changed="slideHasChanged($index)"\r\n            active-slide="currentIndex">\r\n            <ion-slide ng-repeat="(k,v) in Categories">\r\n\r\n                <div ng-if="currentTab==k">\r\n                    <ion-refresher\r\n                        pulling-text="下拉刷新..."\r\n                        on-refresh="doRefresh()"\r\n                        spinner="spiral">\r\n                    </ion-refresher>\r\n\r\n                    <div class="col col-50 "\r\n                         style="display: inline-block"\r\n                        ng-repeat="item in items track by $index" ng-click="goItem(item.item_id)">\r\n                        <div class="item item-image">\r\n                            <img ng-src="{{::item.thumbnail}}">\r\n                        </div>\r\n                        <div class="item item-text-wrap" href="#">\r\n                            <h2 class="product-title" style="overflow: hidden;">{{::item.title}}</h2>\r\n                            <p class="product-prices">\r\n                                <span class="curr-price">{{::item.price | currency}}</span>\r\n                                <del class="orig-price">{{::item.orig_price | currency}}</del>\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="center-ico" ng-if="isEmpty()">\r\n                        <i class="icon ion-ios-grid-view-outline"></i>\r\n\r\n                        <h1 >暂无此类商品</h1>\r\n                    </div>\r\n\r\n                    <ion-infinite-scroll\r\n                        on-infinite="loadMore()"\r\n                        distance="1"\r\n                        spinner=\'spiral\'\r\n                        ng-if="moreDataCanBeLoaded()">\r\n                    </ion-infinite-scroll>\r\n\r\n                </div>\r\n                <div ng-if="currentTab!=k">\r\n                    <div style="background:#f9f9f9;padding-top:100%;height:0"></div>\r\n                </div>\r\n\r\n\r\n\r\n            </ion-slide>\r\n        </ion-slide-box>\r\n\r\n\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("checkout.html",'<!-- 购物车 -->\r\n<ion-view>\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back button-dark"\r\n          ng-click="$state.go(\'tab.cart\')"></button>\r\n\r\n      <div class="title">结算</div>\r\n  </div>\r\n  <ion-content class="has-header has-footer">\r\n\r\n<section>\r\n<div class="checkout-info" ng-click="gotoAddress()">\r\n    <div ng-show="addr.id">\r\n        <span class="addr-icon"></span>\r\n        <div class="address-info">\r\n            <div class="addr-header">收货人信息: </div>\r\n            <div class="">{{addr.data.receiver}}</div>\r\n            <div class="">{{addr.data.street1}}</div>\r\n            <div class="">{{addr.data.street2}}</div>\r\n            <div class="">{{addr.data.city}}, {{addr.data.state}}</div>\r\n            <div class="">{{addr.data.country}}, {{addr.data.postcode}}</div>\r\n        </div>\r\n        <div class="select-arrow address"></div>\r\n    </div>\r\n    <div ng-hide="addr.id">\r\n        <span class="addr-icon"></span>\r\n        <div class="address-info">\r\n            <div class="">新增收件地址</div>\r\n        </div>\r\n        <div class="go-add">+</div>\r\n    </div>\r\n</div>\r\n</section>\r\n\r\n<section class="clearfix" ng-cloak>\r\n<div class="" ng-show="ngCart.getTotalSelectedItems() > 0">\r\n\r\n    <table class="table ngCart cart-table">\r\n        <tbody>\r\n        <tr ng-repeat="item in ngCart.getCart().selectedItems track by $index">\r\n            <td class="img-cell">\r\n                <div>\r\n                    <a ng-href="#/item/{{item.getData().item.item_id}}">\r\n                        <img ng-src="{{item.getData().spec.images[0]}}">\r\n                    </a>\r\n                </div>\r\n            </td>\r\n            <td class="info-cell">\r\n                <div>{{ item.getName() }}</div>\r\n                <div>\r\n                    <span ng-repeat="(k, v) in item.getData().spec.attributes">\r\n                        {{ngCart.attrMap[k]}}: {{v}}\r\n                    </span>\r\n                </div>\r\n                <div class="btn-group cart-btn">\r\n                    <span>数量: {{ item.getQuantity() | number }}</span>\r\n                </div>\r\n            </td>\r\n            <td class="price-cell">{{ item.getTotal() | currency }}</td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n</div>\r\n</section>\r\n\r\n<section>\r\n<div class="checkout-info">\r\n    <div class="icon partner-icon address"></div>\r\n    <div class="partner-info" ng-click="showProviderChoices()">\r\n        <div ng-show="selectedProvider" class="selected-partner">{{selectedProvider.display_name}} ({{selectedProvider.service_intro.duration}}):\r\n            <span class="detail-price selectable">{{selectedProvider.cn_shipping | currency }}</span>\r\n        </div>\r\n        <div ng-hide="selectedProvider" class="selected-partner">请选择运输方式</div>\r\n    </div>\r\n    <div class="select-arrow" ng-class="{\'down-arrow\': providersShown}"></div>\r\n</div>\r\n<div ng-show="providersShown" class="checkout-choices">\r\n    <div class="select-row" ng-repeat="provider in provider_prices"\r\n        ng-click="selectPartner(provider)">\r\n        <span class="select-icon"\r\n            ng-class="{\'selected\': selectedProvider.name == provider.name}">\r\n        </span>\r\n        <div class="checkout-choice">\r\n            {{provider.display_name}} ({{provider.service_intro.duration}})\r\n            <span class="detail-price selectable">{{provider.cn_shipping | currency }}</span>\r\n        </div>\r\n    </div>\r\n</div>\r\n</section>\r\n\r\n<section>\r\n<div class="checkout-info">\r\n    <div class="icon coupon-icon address"></div>\r\n    <div class="coupon-info" ng-click="showCouponsChoices()">\r\n        <div ng-show="coupon_codes" class="">{{coupon_codes.description}}\r\n            <span class="detail-price selectable">-{{coupon_codes.saving }}</span>\r\n        </div>\r\n        <div ng-hide="coupon_codes" class="">使用折扣码/优惠券 </div>\r\n    </div>\r\n    <div class="select-arrow" ng-class="{\'down-arrow\': couponsShown}"></div>\r\n</div>\r\n<div ng-show="couponsShown" class="checkout-choices">\r\n    <div class="select-row" ng-click="noCoupon()">\r\n        <span class="select-icon"\r\n            ng-class="{\'selected\': noCouponSelected == true}">\r\n        </span>\r\n        <div class="checkout-choice">\r\n            不使用\r\n        </div>\r\n    </div>\r\n    <div class="select-row" ng-repeat="coupon in availableCoupons"\r\n        ng-click="selectCoupon(coupon)">\r\n        <span class="select-icon"\r\n            ng-class="{\'selected\': coupon_codes.code == coupon.code}">\r\n        </span>\r\n        <div class="checkout-choice">\r\n            <span>{{coupon.description}}</span>\r\n            <span class="detail-price selectable">-{{coupon.saving | currency }}</span>\r\n        </div>\r\n    </div>\r\n    <div class="select-row">\r\n        <span class="select-icon"\r\n            ng-click="selectInputCoupon()"\r\n            ng-class="{\'selected\': couponInputSelected}">\r\n        </span>\r\n        <div class="checkout-choice">\r\n            <span>折扣码</span>\r\n            <input ng-model="couponInput" type="text" class="coupon-input" placeholder="输入折扣码">\r\n            <span class="detail-price selectable">-{{coupon_codes.saving}}</span>\r\n            <span ng-click="confirmCoupon()" class="use-btn">使用</span>\r\n        </div>\r\n    </div>\r\n</div>\r\n</section>\r\n\r\n\r\n<section>\r\n<div class="checkout-info">\r\n    <div class="item-info-table">\r\n        <dl class="item-info-field">\r\n            <dt class="">商品总价: </dt>\r\n            <dd class="detail-price">{{order.amount_usd | currency }}</dd>\r\n        </dl>\r\n        <dl class="item-info-field">\r\n            <dt class="">运费: </dt>\r\n            <dd class="detail-price">{{order.cn_shipping | currency }}</dd>\r\n        </dl>\r\n        <dl class="item-info-field">\r\n            <dt class="">税费: </dt>\r\n            <dd class="detail-price">0</dd>\r\n        </dl>\r\n    </div>\r\n\r\n</div>\r\n</section>\r\n  </ion-content>\r\n\r\n  <ion-footer-bar align-title="left" class="bar-stable">\r\n    <a class="button button-clear">\r\n        总计: <span class="footer-price"> {{ order.final |currency}}</span>\r\n    </a>\r\n    <h1 class="title"></h1>\r\n    <ngcart-checkout settings="{ coupon: coupon_codes.code,\r\n                        logistic_provider: selectedProvider.name,\r\n                        order_type: \'new\'}">\r\n                        去付款</ngcart-checkout>\r\n  </ion-footer-bar>\r\n</ion-view>\r\n'),t.put("coupons.html",'<ion-view>\r\n    <ion-header-bar>\r\n        <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n        <div class="title">折扣券</div>\r\n    </ion-header-bar>\r\n\r\n    <ion-content class="has-header has-footer">\r\n\r\n        <ion-list>\r\n            <ion-item class="item" ng-repeat="c in user.getUser().consumable_coupons">\r\n                {{c.description}}  {{c.number}}张\r\n                <span class="item-note">\r\n                    有效期 {{c.expire_date}}\r\n                </span>\r\n\r\n            </ion-item>\r\n        </ion-list>\r\n        <div class="center-ico" ng-if="notices.==0">\r\n            <i class="icon ion-ios-camera"></i>\r\n\r\n            <h1 >暂无动态</h1>\r\n        </div>\r\n\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("explore.html",'<ion-view view-title="Chats">\r\n  <ion-content>\r\n    <ion-list>\r\n      <ion-item class="item-remove-animate item-avatar item-icon-right" ng-repeat="chat in chats" type="item-text-wrap" href="#/tab/chats/{{chat.id}}">\r\n        <img ng-src="{{chat.face}}">\r\n        <h2>{{chat.name}}</h2>\r\n        <p>{{chat.lastText}}</p>\r\n        <i class="icon ion-chevron-right icon-accessory"></i>\r\n\r\n        <ion-option-button class="button-assertive" ng-click="remove(chat)">\r\n          Delete\r\n        </ion-option-button>\r\n      </ion-item>\r\n    </ion-list>\r\n  </ion-content>\r\n</ion-view>\r\n'),t.put("expressForm.html",'<!-- 代寄出国 -->\r\n<ion-view>\r\n    <div class="bar bar-header">\r\n        <button class="button button-clear icon ion-ios-arrow-back" ng-click="$state.go(\'tab.home\')">首页</button>\r\n        <div class="title">代寄出国</div>\r\n    </div>\r\n\r\n    <ion-content class="has-header">\r\n        <div class="logistic-row">\r\n            <ul class="progress-indicator">\r\n                <li class="completed">\r\n                    <span class="bubble"></span>\r\n                    <div class="logistic-status">核验清单</div>\r\n                </li>\r\n                <li ng-repeat="status in STATUES">\r\n                    <span class="bubble"></span>\r\n                    <div class="logistic-status">{{status}}</div>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <div class="checkout-info" ng-click="gotoAddress()">\r\n            <div ng-show="addr.id">\r\n                <span class="addr-icon"></span>\r\n                <div class="address-info">\r\n                    <p class="addr-header">寄往收货人信息: </p>\r\n                    <div class="">{{addr.data.receiver}}</div>\r\n                    <div class="">{{addr.data.street1}}</div>\r\n                    <div class="">{{addr.data.street2}}</div>\r\n                    <div class="">{{addr.data.city}}, {{addr.data.state}}</div>\r\n                    <div class="">{{addr.data.country}}, {{addr.data.postcode}}</div>\r\n                </div>\r\n                <div class="select-arrow address"></div>\r\n            </div>\r\n            <div ng-hide="addr.id">\r\n                <span class="addr-icon"></span>\r\n                <div class="address-info">\r\n                    <div class="">填写收件人信息</div>\r\n                </div>\r\n                <div class="go-add">+</div>\r\n            </div>\r\n        </div>\r\n        <div class="">\r\n            <table class="table ngCart cart-table express">\r\n                <thead>\r\n                <tr>\r\n                    <td class="title">\r\n                        <span>物品名称</span>\r\n                    </td>\r\n                    <td class="cate">\r\n                        <span><a href="" onclick="window.open(\'http://may.bi/#/limit\', \'_blank\', \'location=no,toolbarposition=top,closebuttoncaption=关闭\')">敏感物品</a></span>\r\n                    </td>\r\n                    <td class="quantity">\r\n                        <span>数量</span>\r\n                    </td>\r\n                    <td class="value">\r\n                        <span>申报价值</span>\r\n                    </td>\r\n                    <td class="note">\r\n                        <span>备注</span>\r\n                    </td>\r\n                    <td class="ico"></td>\r\n                </tr>\r\n                </thead>\r\n\r\n                <tbody>\r\n                <tr ng-repeat="entry in entries track by $index">\r\n                    <td class="title">\r\n                        {{ entry.title }}\r\n                    </td>\r\n                    <td class="cate">\r\n                        {{ entry.main_category==\'special\'? \'是\': \'否\' }}\r\n                    </td>\r\n                    <td class="quantity">\r\n                        {{ entry.quantity }}\r\n                    </td>\r\n                    <td class="value">\r\n                        ￥{{ entry.amount }}\r\n                    </td>\r\n                    <td class="note">\r\n                        {{ entry.remark }}\r\n                    </td>\r\n                    <td class="ico">\r\n                        <span class="close-icon" ng-click="removeEntry(entry)">\r\n                        </span>\r\n                    </td>\r\n                </tr>\r\n                </tbody>\r\n            </table>\r\n\r\n            <button class="button button-block" ng-click="addEntry()">\r\n                <i class="ion-ios-plus-outline"></i>\r\n                添加代寄物品\r\n            </button>\r\n        </div>\r\n        <div class="express-noti">\r\n\r\n            <p class="notice">下单须知: </p>\r\n\r\n            <p>1. 提交清单后，美比工作人员会先核实，核实通过后订单进入“跟踪快递”。</p>\r\n\r\n            <p>2. “跟踪快递”状态后，用户把待寄物品寄到美比仓库收货地址，并尽快填写包裹的快递单号。</p>\r\n\r\n            <p>3. 包裹到达仓库之后，进入“入库称重”，用户根据称得重量，选择运输方式后交付运费。</p>\r\n\r\n            <p>4. 交付运费后，订单进入"支付运费"。仓库人员将24小时内提交运输。</p>\r\n\r\n        </div>\r\n    </ion-content>\r\n    <ion-footer-bar class="bar-stable item-button-right">\r\n        <button class="button button-assertive button-cart" ng-click="submit()">提交清单</button>\r\n    </ion-footer-bar>\r\n</ion-view>\r\n'),t.put("expressItem_add.html",'<!-- 添加代寄物品 -->\r\n<ion-view>\r\n    <div class="bar bar-header">\r\n        <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n        <div class="title">添加代寄物品</div>\r\n        <button class="button button-clear button-dark" ng-click="addItem()">保存</button>\r\n    </div>\r\n\r\n    <ion-content class="has-header">\r\n        <div class="list">\r\n            <label class="item item-input">\r\n                <span class="input-label">物品名称</span>\r\n                <input type="text" ng-model="item.title">\r\n            </label>\r\n            <label class="item item-toggle">\r\n                敏感物品\r\n                <label class="toggle toggle-assertive">\r\n                    <input type="checkbox" ng-model="item.main_category">\r\n                    <div class="track">\r\n                        <div class="handle"></div>\r\n                    </div>\r\n                </label>\r\n            </label>\r\n            <label class="item item-input">\r\n                <span class="input-label">数量</span>\r\n                <input type="number" ng-model="item.quantity">\r\n            </label>\r\n            <label class="item item-input">\r\n                <span class="input-label">申报价值(￥)</span>\r\n                <input type="number" ng-model="item.amount">\r\n            </label>\r\n            <label class="item item-input">\r\n                <span class="input-label">备注</span>\r\n                <input type="text" placeholder="如颜色，尺寸" ng-model="item.remark">\r\n            </label>\r\n        </div>\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("favors.html",'<!-- 商品列表 -->\r\n<ion-view>\r\n    <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n      <div class="title">收藏商品</div>\r\n    </div>\r\n    <ion-content class="has-header homepage">\r\n        <div class="col col-50 animated fadeIn"\r\n            collection-repeat="item in items" ng-click="goItem(item.item_id)">\r\n            <div class="item item-image">\r\n                <img ng-src="{{item.thumbnail}}" cache-src>\r\n            </div>\r\n            <div class="item item-text-wrap" href="#">\r\n                <h2 class="product-title" style="overflow: hidden;">{{item.title}}</h2>\r\n                <p class="product-prices">\r\n                    <span class="curr-price">{{item.price | currency}}</span>\r\n                    <del class="orig-price">{{item.orig_price | currency}}</del>\r\n                </p>\r\n            </div>\r\n        </div>\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("feedback.html",'<!-- 意见反馈 -->\r\n<ion-view>\r\n    <div class="bar bar-header">\r\n        <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n        <div class="title">意见反馈</div>\r\n    </div>\r\n\r\n    <ion-content class="has-header">\r\n        <div class="faq-row">\r\n            <div class="faq-title">\r\n                意见反馈:\r\n            </div>\r\n            <div class="faq-desc">\r\n                <textarea ng-model="text" class="ng-pristine ng-untouched ng-valid"></textarea>\r\n                <button ng-click="feedback()" class="button button-assertive pull-right button">提交</button>\r\n            </div>\r\n        </div>\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("forgotPassword.html",'<ion-modal-view>\r\n  <ion-header-bar>\r\n    <div class="buttons">\r\n      <button class="button button-clear icon ion-ios-arrow-back button-dark" ng-click="closeForgotPWBox()"></button>\r\n    </div>\r\n    <div class="title">忘记密码</div>\r\n  </ion-header-bar>\r\n  <ion-content class="login-page overlay-content" scroll="false" ng-controller="forgotPWCtrl">\r\n    <div class="list list-inset">\r\n      <label class="item item-input">\r\n        <input type="email" placeholder="邮箱地址" ng-model="forgotPWForm.email">\r\n      </label>\r\n    </div>\r\n\r\n    <button class="button button-block login-btn" ng-click="submit()">提交</button>\r\n\r\n  </ion-content>\r\n</ion-modal-view>\r\n'),t.put("home.html",'<ion-view>\r\n    <form>\r\n    <div class="bar bar-header item-input-inset">\r\n      <a href="#/cateHome" class="button button-icon icon ion-grid"></a>\r\n      <label class="item-input-wrapper">\r\n        <i class="icon ion-ios-search placeholder-icon"></i>\r\n        <input type="search" placeholder="搜索商品，种类" ng-model="searchQuery">\r\n        <input type="submit" ng-click="searchItem(searchQuery)" style="position: absolute; left: -9999px; width: 1px; height: 1px;"/>\r\n      </label>\r\n      <span class="cart-num">{{ ngCart.getTotalItems() }}</span>\r\n      <a href="#/cart" class="button button-icon icon ion-ios-cart"></a>\r\n    </div>\r\n    </form>\r\n    <ion-content class="has-header homepage"  overflow-scroll="true">\r\n        <ion-slide-box delegate-handle="image-viewer">\r\n            <!--ng-style="{\'height\':(banners?\'auto\':\'0px\'),\'padding-top\':(banners?\'0\':\'42.1875%\')}">-->\r\n            <ion-slide ng-repeat="banner in banners track by $index" >\r\n                <img ng-src="{{ ::banner.img }}" ng-click="redirectTo(banner)">\r\n            </ion-slide>\r\n        </ion-slide-box>\r\n\r\n        <div class="row intro-box">\r\n            <div class="col col-25">\r\n                <a href="#/categories">\r\n                    <i class="icon category"></i>\r\n                    <p>商品分类</p>\r\n                </a>\r\n\r\n            </div>\r\n            <div class="col col-25">\r\n                <a href="#/calculate">\r\n                    <i class="icon calculate"></i>\r\n                    <p>运费估算</p>\r\n                </a>\r\n            </div>\r\n            <div class="col col-25">\r\n                <a href="#/express">\r\n                    <i class="icon send"></i>\r\n                    <p>待寄出国</p>\r\n                </a>\r\n\r\n            </div>\r\n            <div class="col col-25">\r\n                <a href="#/limit">\r\n                    <i class="icon limit"></i>\r\n                    <p>邮寄限制</p>\r\n                </a>\r\n            </div>\r\n        </div>\r\n\r\n        <ion-item class="item" style="border-left: 3px solid #ea004f;">\r\n            美周专题\r\n        </ion-item>\r\n\r\n\r\n        <ion-refresher\r\n            pulling-text="下拉刷新..."\r\n            on-refresh="doRefresh()"\r\n            spinner="spiral">\r\n        </ion-refresher>\r\n\r\n        <div class="animated fadeIn" ng-repeat="board in boards track by $index" >\r\n            <div class="item item-banner-image">\r\n                <div class="tri"></div>\r\n                <img ng-src="{{ ::board.image }}" ng-click="goBoard(board.id)">\r\n            </div>\r\n            <item-carousel board="board"></item-carousel>\r\n            <div class="item item-divider"></div>\r\n        </div>\r\n        <ion-infinite-scroll\r\n            on-infinite="loadMore()"\r\n            distance="1"\r\n            spinner=\'spiral\'\r\n            ng-if="moreDataCanBeLoaded()">\r\n        </ion-infinite-scroll>\r\n\r\n\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("intro.html",'<ion-view class="view-intro">\r\n\r\n    <ion-content scroll="false">\r\n        <div class="intro-slider">\r\n            <ion-slide-box active-slide="slideIndex" show-pager="true" on-slide-changed="slideChanged($index)">\r\n\r\n                <ion-slide ng-repeat="item in slides">\r\n\r\n                    <div class="content" ng-if="$index == slideIndex">\r\n                        <span class="top"><h2>{{ item.top }}</h2></span>\r\n\r\n                        <div class="phone {{ device }}">\r\n                            <img ng-src="{{ item.img }}">\r\n                        </div>\r\n                    </div>\r\n\r\n                </ion-slide>\r\n\r\n                <ion-slide>\r\n                    <div class="content" ng-if="slides.length == slideIndex">\r\n\r\n                        <div class="last">\r\n                            <div class="logo2 step1">\r\n                                <img src="img/icon.jpg">\r\n                                <span class="icon2-logo"></span>\r\n                            </div>\r\n\r\n                            <p>比邻中国的海外生活</p>\r\n\r\n                            <button class="button button-block button-clear step2" ui-sref="tab.explore" ng-click="goHome()">开始</button>\r\n                        </div>\r\n\r\n                    </div>\r\n                </ion-slide>\r\n            </ion-slide-box>\r\n\r\n        </div>\r\n\r\n        <!--\r\n        <button class="button button-positive button-fab left" ng-if="slideIndex" ng-click="previous()"><i class="icon ion-ios-arrow-left"></i></button>\r\n\r\n        <button class="button button-positive button-fab right" ng-hide="slideIndex === slides.length" ng-click="next()"><i class="icon ion-ios-arrow-right"></i></button>\r\n        -->\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("item.html",'<!-- 商品详情 -->\r\n<ion-view>\r\n    <div class="buttons">\r\n      <button class="button button-clear icon ion-ios-arrow-back item-header-button" ng-click="$ionicGoBack()"></button>\r\n      <button class="button button-clear icon ion-share item-header-button pull-right" ng-click="share(item)"></button>\r\n    </div>\r\n\r\n  <ion-content class="item-page has-footer">\r\n\r\n    <ion-slide-box delegate-handle="image-viewer"\r\n        ng-style="{\'height\':(images?\'auto\':\'0px\'),\'padding-top\':(images?\'0\':\'100%\')}">\r\n        <ion-slide ng-repeat="img in images">\r\n            <img ng-src="{{ img.url }}" ng-click="zoom(img.url)">\r\n        </ion-slide>\r\n    </ion-slide-box>\r\n\r\n    <ion-item class="item item-details">\r\n        <div class="item-title">\r\n            {{ item.title }}\r\n        </div>\r\n        <div class="product-prices">\r\n            <span class="curr-price">{{item.price | currency}}</span>\r\n            <del class="orig-price">{{item.orig_price | currency}}</del>\r\n            <div class="product-discount">{{item.discount}}% Off</div>\r\n        </div>\r\n    </ion-item>\r\n    <ion-item class="item item-details">\r\n        <div class="item-info">\r\n            <div class="item-info-table">\r\n                <dl class="item-info-field">\r\n                    <dt class="item-info-key">运费：</dt>\r\n                    <dd class="item-info-val">满 $79 免运费</dd>\r\n                </dl>\r\n                <dl class="item-info-field">\r\n                    <dt class="item-info-key">商品编号：</dt>\r\n                    <dd class="item-info-val">{{item.item_id}}</dd>\r\n                </dl>\r\n                <dl class="item-info-field">\r\n                    <dt class="item-info-key">商品重量：</dt>\r\n                    <dd class="item-info-val">{{item.weight}}g</dd>\r\n                </dl>\r\n                <dl class="item-info-field">\r\n                    <dt class="item-info-key">库存所在地：</dt>\r\n                    <dd class="item-info-val">中国</dd>\r\n                </dl>\r\n            </div>\r\n        </div>\r\n    </ion-item>\r\n    <ion-item class="item item-desc">\r\n        <p class="info-header">商品详情:</p>\r\n        <div class="description" ng-bind-html="item.detail"></div>\r\n    </ion-item>\r\n  </ion-content>\r\n  <div class="bar bar-footer bar-light">\r\n      <button class="button button-clear icon ion-ios-heart"\r\n          ng-class="{\'like-icon button-assertive\':item.is_favored, \'button-light\':!item.is_favored}"\r\n          ng-click="favor(item.item_id)">\r\n          <span class="footer-price">{{item.price | currency}}</span>\r\n      </button>\r\n      <button class="button button-assertive button-cart icon ion-ios-cart"\r\n          ng-click="showSpecsBox()">\r\n          加入购物车\r\n      </button>\r\n  </div>\r\n</ion-view>\r\n'),t.put("itemCarousel.html",'<ion-scroll direction="x" scrollbar-x="false" class="wide-as-needed item-carousel">\r\n    <div class="col col-33 "\r\n         style="display: inline-block"\r\n        ng-repeat="item in items" ng-click="goItem(item.item_id)">\r\n        <div class="item item-image">\r\n            <img ng-src="{{::item.thumbnail}}">\r\n        </div>\r\n        <div class="item item-text-wrap" href="#">\r\n            <p class="">{{::item.title}}</p>\r\n            <p class="product-prices">\r\n                <span class="curr-price">{{::item.price | currency}}</span>\r\n            </p>\r\n        </div>\r\n    </div>\r\n    <div class="col col-33 "\r\n         style="display: inline-block"\r\n        ng-click="goBoard()">\r\n        <div class="item item-image">\r\n            <div class="item-image-text">\r\n                <p>查看全部<p>\r\n                <p>See All<p>\r\n            </div>\r\n        </div>\r\n        <div class="item item-text-wrap" style="background: transparent">\r\n            <p class="" style="color:transparent">See </p>\r\n            <p class="" style="color:transparent">All </p>\r\n        </div>\r\n    </div>\r\n</ion-scroll>\r\n'),t.put("limit.html",'<ion-view>\r\n    <div class="bar bar-header">\r\n        <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n        <div class="title">邮寄限制</div>\r\n    </div>\r\n\r\n\r\n    <ion-content class="has-header homepage">\r\n<div class="faq-row">\r\n    <div class="faq-title">普通商品:</div>\r\n    <div class="faq-desc">\r\n    衣物类、书箱、鞋帽类、围巾类、床上用品类、窗帘类、玩具类、各种背包、提包与行李箱类、女生用品（纸巾、卫生棉等）、文具类、餐具类、厨房用品类、各种石头类工艺品、画框类、电器及其它电子产品（不带电池）、其它不需要海关检验检疫的物品;\r\n    </div>\r\n</div>\r\n\r\n<div class="faq-row">\r\n    <div class="faq-title">敏感商品:</div>\r\n    <div class="faq-desc">\r\n    地方小吃、干货、茶叶、各种零食饼干、常用药品（感冒药、消炎药、肠胃药、清火去湿及其它非精神类或带有麻醉性质的药品）、光碟、带有电池的电子产品、国际品牌的全新物品、化妆品等；\r\n    </div>\r\n</div>\r\n\r\n\r\n<div class="faq-row">\r\n    <div class="faq-title">禁运商品:</div>\r\n    <div class="faq-desc">\r\n    液体类、粉末类、文物古玩类、来自疫区的食品药品、易燃易爆品、各种管制刀具（包括菜刀）、枪枝、鲜活类、毒品、化学品、色情及政治内容的阅读物、世界各国流通货币、有价证券、邮票等海关明令禁止运输的物品;\r\n    </div>\r\n</div>\r\n</section>\r\n\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("logistics.html",'<ion-view>\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n      <div class="title">物流详情</div>\r\n  </div>\r\n\r\n  <ion-content class="has-header">\r\n\r\n<section class="clearfix" ng-cloak>\r\n<div class="logistic-row">\r\n    <span class="">\r\n        包裹编号：{{logistic.partner_tracking_no}}\r\n    </span>\r\n    <span class="pull-right">\r\n        <ul class="logistic-nav">\r\n            <li class=""\r\n                ng-repeat="lo in order.logistics track by $index"\r\n                ng-if="order.logistics.length > 1"\r\n                ng-class="{\'current\': currTab==$index}"\r\n                ng-click="goTab($index, lo)">\r\n                包裹{{$index+1}}</li>\r\n        </ul>\r\n    </span>\r\n</div>\r\n<div class="">\r\n    <table class="table ngCart cart-table">\r\n        <tbody>\r\n        <tr ng-repeat="entry in logistic.entries track by $index">\r\n            <td class="img-cell">\r\n                <div>\r\n                    <img ng-src="{{entry.spec.images[0]}}">\r\n                </div>\r\n            </td>\r\n            <td class="info-cell">\r\n                <div>{{ entry.item.title }}</div>\r\n                <div>\r\n                    <span ng-repeat="(k, v) in entry.spec.attributes">\r\n                        {{ngCart.attrMap[k]}}: {{v}}\r\n                    </span>\r\n                </div>\r\n                <div class="btn-group cart-btn">\r\n                    <span>数量: {{ entry.quantity | number }}</span>\r\n                </div>\r\n            </td>\r\n            <td class="price-cell">{{ entry.amount_usd | currency }}</td>\r\n        </tr>\r\n    </table>\r\n</div>\r\n\r\n<div class="logistic-row">\r\n    <ul class="progress-indicator">\r\n        <li ng-class="{\'completed\': allStatus.indexOf(logistic.current_status) >= $index}"\r\n             ng-repeat="status in logistic.all_status">\r\n            <span class="bubble"></span>\r\n            <div class="logistic-status">{{status.desc}}</div>\r\n        </li>\r\n    </ul>\r\n</div>\r\n<div class="logistic-row">\r\n    <ul class="tracking">\r\n        <li ng-repeat="h in logistic.history | reverse">\r\n            <div class="">{{h.desc}}</div>\r\n            <div class="time">{{h.time}}</div>\r\n        </li>\r\n    </ul>\r\n</div>\r\n</section>\r\n\r\n  </ion-content>\r\n</ion-view>\r\n'),t.put("notification.html",'<ion-view class="view-post">\r\n    <ion-header-bar>\r\n        <div class="title">通知</div>\r\n    </ion-header-bar>\r\n\r\n    <ion-content class="has-header">\r\n\r\n    <ion-refresher\r\n        pulling-text="下拉刷新..."\r\n        on-refresh="doRefresh()"\r\n        spinner="spiral">\r\n    </ion-refresher>\r\n\r\n    <div class="list card notice" ng-repeat="notice in notices track by $index">\r\n        <div class="item item-avatar">\r\n            <img  ng-src="{{::notice.user.avatar_thumb}}" ng-click="zoom(notice.user.avatar_url)">\r\n            <h2>{{::notice.user.name}}\r\n                <div class="post-type notice">\r\n                    {{::notice.sub_title}}\r\n                </div>\r\n                <span class="item-note">{{::notice.created_at | amTimeAgo}}</span>\r\n            </h2>\r\n            <p class="post-body" ng-bind-html="notice.content | nl2br">\r\n        </div>\r\n    </div>\r\n    <div class="center-ico" ng-if="isEmpty()">\r\n        <i class="icon ion-ios-camera"></i>\r\n\r\n        <h1 >暂无动态</h1>\r\n    </div>\r\n    <ion-infinite-scroll\r\n        on-infinite="loadMore()"\r\n        distance="1"\r\n        spinner=\'spiral\'\r\n        ng-if="moreDataCanBeLoaded()">\r\n    </ion-infinite-scroll>\r\n\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("order.html",'<ion-view>\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$state.go(\'tab.orders\')"></button>\r\n      <div class="title">订单详情</div>\r\n  </div>\r\n\r\n  <ion-content class="has-header">\r\n\r\n<section class="orders">\r\n<div class="checkout-info">\r\n    <span class="addr-icon"></span>\r\n    <div class="address-info">\r\n        <p class="addr-header">收货人信息: </p>\r\n        <div class="">{{order.address.receiver}}</div>\r\n        <div class="">{{order.address.street1}}</div>\r\n        <div class="">{{order.address.street2}}</div>\r\n        <div class="">{{order.address.city}}, {{order.address.state}}</div>\r\n        <div class="">{{order.address.country}}, {{order.address.postcode}}</div>\r\n    </div>\r\n</div>\r\n</section>\r\n\r\n<section class="clearfix" ng-cloak>\r\n<div class="">\r\n    <table class="table ngCart cart-table">\r\n        <tbody>\r\n        <tr ng-repeat="entry in order.entries track by $index">\r\n            <td class="img-cell">\r\n                <div>\r\n                    <img ng-src="{{entry.spec.images[0]}}">\r\n                </div>\r\n            </td>\r\n            <td class="info-cell">\r\n                <div>{{ entry.item.title }}</div>\r\n                <div>\r\n                    <span ng-repeat="(k, v) in entry.spec.attributes">\r\n                        {{ngCart.attrMap[k]}}: {{v}}\r\n                    </span>\r\n                </div>\r\n                <div class="btn-group cart-btn">\r\n                    <span>数量: {{ entry.quantity | number }}</span>\r\n                </div>\r\n            </td>\r\n            <td class="price-cell">{{ entry.amount_usd | currency }}</td>\r\n        </tr>\r\n    </table>\r\n</div>\r\n</section>\r\n<section>\r\n<div class="checkout-info">\r\n    <div class="icon partner-icon address"></div>\r\n    <div class="partner-info">\r\n        <div class="selected-partner">{{order.provider.display_name}} ({{order.provider.service_intro.duration}}):\r\n            <span class="detail-price pull-right">{{order.cn_shipping | currency }}</span>\r\n        </div>\r\n    </div>\r\n</div>\r\n</section>\r\n\r\n<section>\r\n<div class="checkout-info">\r\n    <div class="icon coupon-icon address"></div>\r\n    <div class="coupon-info">\r\n        <div ng-show="order.discount.length==1" class="">{{order.discount[0].desc}}\r\n            <span class="detail-price pull-right">- {{order.discount[0].value | currency }}</span>\r\n        </div>\r\n        <div ng-show="order.discount.length==0" class="">\r\n            不使用\r\n        </div>\r\n    </div>\r\n</div>\r\n</section>\r\n\r\n\r\n<section>\r\n<div class="checkout-info">\r\n    <div class="item-info-table">\r\n        <dl class="item-info-field">\r\n            <dt class="">商品总价: </dt>\r\n            <dd class="detail-price">{{order.amount_usd | currency }}</dd>\r\n        </dl>\r\n        <dl class="item-info-field">\r\n            <dt class="">运费: </dt>\r\n            <dd class="detail-price">{{order.cn_shipping | currency }}</dd>\r\n        </dl>\r\n        <dl class="item-info-field">\r\n            <dt class="">税费: </dt>\r\n            <dd class="detail-price">0</dd>\r\n        </dl>\r\n    </div>\r\n</div>\r\n<div class="order-bottom">\r\n    <div class="">\r\n        订单号：{{order.short_id}}\r\n    </div>\r\n    <div class="">\r\n        创建时间: {{order.created_at}}\r\n    </div>\r\n</div>\r\n</section>\r\n  </ion-content>\r\n  <ion-footer-bar align-title="left" class="bar-stable">\r\n    <a class="button button-clear">\r\n        总计: <span class="footer-price"> {{ order.final |currency}}</span>\r\n    </a>\r\n    <h1 class="title"></h1>\r\n    <div class="buttons">\r\n        <ngcart-checkout ng-if="order.payment_status==\'UNPAID\'" settings="{ order_id: order.id , order_type: \'existed\'}">\r\n            去付款\r\n        </ngcart-checkout>\r\n        <button class="button button-clear" ng-disabled="order.payment_status==\'PAID\'"\r\n            ng-if="order.payment_status==\'PAID\'">\r\n            已付款\r\n        </button>\r\n        <button class="button button-default"\r\n            ng-click="cancelOrder()"\r\n            ng-if="order.payment_status==\'UNPAID\'">\r\n            取消订单\r\n        </button>\r\n    </div>\r\n  </ion-footer-bar>\r\n</ion-view>\r\n'),t.put("orders.html",'<!-- 商品详情 -->\r\n<ion-view>\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$state.go(\'tab.account\')"></button>\r\n      <div class="title">我的订单</div>\r\n  </div>\r\n\r\n  <ion-content class="has-header">\r\n\r\n<section>\r\n<div class="order-btn-row">\r\n    <div class="btn-group cart-btn">\r\n        <button class="btn order-btn"\r\n            ng-class="{\'active\': orderType == \'COMMODITIES\'}"\r\n            ng-click="setType(\'COMMODITIES\')">商城订单</button>\r\n        <button class="btn order-btn"\r\n            ng-class="{\'active\': orderType == \'TRANSFER\'}"\r\n            ng-click="setType(\'TRANSFER\')">转运订单</button>\r\n    </div>\r\n</div>\r\n<div class="order-detail" ng-repeat="order in orders track by $index">\r\n    <table ng-if="orderType==\'COMMODITIES\'" class="table ngCart cart-table">\r\n        <thead>\r\n        <tr>\r\n            <td class="padding  first-cell" colspan="2">\r\n                <button class="button button-clear button-dark button-small">\r\n                    订单号: {{order.short_id}}\r\n                </button>\r\n                <button class="button button-default button-small">\r\n                    状态:  {{order.current_status}}\r\n                </button>\r\n            </td>\r\n            <td class="detail-cell">\r\n                <a class="button button-stable button-small" ng-href="#/order/{{order.id}}">详情 <i class="icon ion-ios-arrow-right"></i></a>\r\n            </td>\r\n        </tr>\r\n        </thead>\r\n\r\n        <tbody>\r\n        <tr ng-repeat="entry in order.entries track by $index">\r\n\r\n            <td class="img-cell">\r\n                <div>\r\n                    <a ng-href="#/order/entry/{{entry.item.item_id}}">\r\n                        <img ng-src="{{entry.spec.images[0]}}">\r\n                    </a>\r\n                </div>\r\n            </td>\r\n            <td class="info-cell">\r\n                <div>{{ entry.item.title }}</div>\r\n                <div>\r\n                    <span ng-repeat="(k, v) in entry.spec.attributes">\r\n                        {{ngCart.attrMap[k]}}: {{v}}\r\n                    </span>\r\n                </div>\r\n                <div class="btn-group cart-btn">\r\n                    <span>数量: {{ entry.quantity | number }}</span>\r\n                </div>\r\n            </td>\r\n            <td class="price-cell">{{ entry.amount_usd | currency }}</td>\r\n        </tr>\r\n        </tbody>\r\n\r\n        <tfoot>\r\n        <tr>\r\n            <td class="status-cell" ng-if="order.payment_status==\'PAID\'">\r\n                <a class="button button-default  button-small"\r\n                    ng-href="#/order/logistics/{{order.id}}">\r\n                    查看物流\r\n                </a>\r\n            </td>\r\n\r\n            <td class="status-cell" ng-if="order.payment_status==\'UNPAID\'">\r\n                <a class="button button-asseritive button-cart button-small"\r\n                    ng-href="#/order/{{order.id}}">\r\n                    去付款\r\n                </a>\r\n            </td>\r\n            <td colspan="2" class="fee-cell">运费:\r\n                <span class="price-cell">{{ order.cn_shipping | currency }}</span>\r\n                总计:\r\n                <span class="price-cell">{{ order.final | currency }}</span>\r\n            </td>\r\n        </tr>\r\n        </tfoot>\r\n    </table>\r\n\r\n    <table ng-if="orderType==\'TRANSFER\'" class="table ngCart cart-table express">\r\n        <thead>\r\n        <tr>\r\n            <td class="padding first-cell" colspan="5">\r\n                <button class="button button-clear  button-dark button-small">\r\n                    订单号: {{order.short_id}}\r\n                </button>\r\n                <button class="button button-default button-small">\r\n                    状态:  {{order.current_status}}\r\n                </button>\r\n                <span class="pull-right">\r\n                    <a class="button button-default  button-small"\r\n                        ng-href="#/order/transfer/{{order.id}}">\r\n                        查看物流\r\n                    </a>\r\n                </span>\r\n            </td>\r\n\r\n        </tr>\r\n        <tr>\r\n            <td class="title1">\r\n                <span>商品名称:</span>\r\n            </td>\r\n            <td class="cate">\r\n                <span>类型:</span>\r\n            </td>\r\n            <td class="quantity1">\r\n                <span>数量:</span>\r\n            </td>\r\n            <td class="value">\r\n                <span>申报价值:</span>\r\n            </td>\r\n            <td class="note">\r\n                <span>备注:</span>\r\n            </td>\r\n        </tr>\r\n        </thead>\r\n\r\n        <tbody>\r\n        <tr ng-repeat="entry in order.entries track by $index">\r\n            <td class="title1">\r\n                {{ entry.title }}\r\n            </td>\r\n            <td class="cate">\r\n                {{ entry.main_category }}\r\n            </td>\r\n            <td class="quantity1">\r\n                {{ entry.quantity }}\r\n            </td>\r\n            <td class="value">\r\n                ￥{{ entry.amount }}\r\n            </td>\r\n            <td class="note">\r\n                {{ entry.remark }}\r\n            </td>\r\n        </tr>\r\n        </tbody>\r\n\r\n        <tfoot>\r\n        <tr>\r\n            <td class="status-cell" ng-if="order.payment_status==\'PAID\'">\r\n                <a class="button button-default  button-small"\r\n                    ng-href="#/order/logistics/{{order.id}}">\r\n                    查看物流\r\n                </a>\r\n            </td>\r\n\r\n            <td class="status-cell" ng-if="order.payment_status==\'UNPAID\' && order.status ==\'WAREHOUSE_IN\'">\r\n                <a class="button button-asseritive button-cart button-small"\r\n                    ng-href="#/order/transfer/{{order.id}}">\r\n                    去付款\r\n                </a>\r\n            </td>\r\n            <td colspan="4" class="fee-cell">运费:\r\n                <span class="price-cell">{{ order.cn_shipping | currency }}</span>\r\n                总计:\r\n                <span class="price-cell">{{ order.final | currency }}</span>\r\n            </td>\r\n        </tr>\r\n        </tfoot>\r\n    </table>\r\n\r\n</div>\r\n</section>\r\n  </ion-content>\r\n</ion-view>\r\n'),t.put("profile.html",'<ion-view>\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n      <div class="title">个人资料</div>\r\n  </div>\r\n  <ion-content class="has-header account">\r\n    <ion-list>\r\n\r\n      <ion-item class="item-divider">\r\n      </ion-item>\r\n\r\n      <ion-item class="item item-icon-right" ng-click="togglePhotoModal()">\r\n          上传头像\r\n          <i class="icon ion-ios-arrow-right"></i>\r\n      </ion-item>\r\n      <ion-item class="item item-icon-right"  ng-click="setUsername()">\r\n          用户名\r\n          <span class="item-note">\r\n              {{user.getUser().name}}\r\n          </span>\r\n          <i class="icon ion-ios-arrow-right"></i>\r\n      </ion-item>\r\n    </ion-list>\r\n  </ion-content>\r\n</ion-view>\r\n'),t.put("settings.html",'<ion-view>\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n      <div class="title">设置</div>\r\n  </div>\r\n  <ion-content class="has-header account">\r\n    <ion-list>\r\n      <ion-item class="item-divider"></ion-item>\r\n      <ion-item class="item item-icon-left item-icon-right" ng-click="$state.go(\'tab.like_posts\')">\r\n          <i class="icon ion-ios-grid-view-outline"></i>\r\n          赞过帖子\r\n          <i class="icon ion-ios-arrow-right"></i>\r\n      </ion-item>\r\n      <ion-item class="item item-icon-left item-icon-right" ng-click="$state.go(\'tab.favors\')">\r\n          <i class="icon ion-ios-heart-outline"></i>\r\n          收藏商品\r\n          <i class="icon ion-ios-arrow-right"></i>\r\n      </ion-item>\r\n      <ion-item class="item-divider"></ion-item>\r\n\r\n      <ion-item class="item item-icon-left item-icon-right" ng-click="$state.go(\'tab.profile\')">\r\n          <i class="icon ion-ios-person-outline"></i>\r\n          个人资料\r\n          <i class="icon ion-ios-arrow-right"></i>\r\n      </ion-item>\r\n\r\n      <ion-item class="item item-icon-left item-icon-right" ng-click="$state.go(\'tab.address_list\')">\r\n          <i class="icon ion-ios-location"></i>\r\n          收货地址\r\n          <i class="icon ion-ios-arrow-right"></i>\r\n      </ion-item>\r\n\r\n      <ion-item class="item-divider"></ion-item>\r\n\r\n      <ion-item class="item item-icon-right" ng-click="$state.go(\'tab.about\')">\r\n          关于我们\r\n          <i class="icon ion-ios-arrow-right"></i>\r\n      </ion-item>\r\n\r\n      <ion-item class="item-divider">\r\n      </ion-item>\r\n\r\n      <ion-item class="item item-icon-right" ng-click="logout()">\r\n          登出\r\n          <i class="icon ion-ios-arrow-right"></i>\r\n      </ion-item>\r\n      <ion-item class="item-divider"></ion-item>\r\n    </ion-list>\r\n  </ion-content>\r\n</ion-view>\r\n'),t.put("showMore.html","<div>\r\n    <div ng-style='expandable&&!expanded? showLessStyle : \"\"'>\r\n        <p ng-bind-html=\"title||'' | nl2br\"></p>\r\n    </div>\r\n    <div ng-if=\"expandable\" class=\"expand-btn\">\r\n        <button class=\"button button-small button-clear button-dark \"\r\n           ng-click='$event.stopPropagation();toggle()'>{{expanded? '收起':'展开全文'}}\r\n        </button>\r\n    </div>\r\n</div>\r\n"),t.put("signup.html",'<ion-modal-view>\r\n  <ion-header-bar>\r\n    <div class="buttons">\r\n      <button class="button button-clear icon ion-ios-arrow-back button-dark" ng-click="closeSignupBox()"></button>\r\n    </div>\r\n    <div class="title">注册</div>\r\n  </ion-header-bar>\r\n  <ion-content class="signup-page overlay-content" ng-controller="signupCtrl">\r\n    <div class="list list-inset">\r\n      <label class="item item-input">\r\n        <input type="email" placeholder="邮箱地址" ng-model="signupForm.email">\r\n      </label>\r\n\r\n      <label class="item item-input">\r\n        <input type="password" placeholder="密码" ng-model="signupForm.password">\r\n      </label>\r\n\r\n      <label class="item item-input">\r\n        <input type="text" placeholder="用户名" ng-model="signupForm.name">\r\n      </label>\r\n    </div>\r\n\r\n    <button class="button button-block login-btn" ng-click="signup()">\r\n        注册\r\n    </button>\r\n\r\n\r\n    <div class="third-party-box">\r\n        <p>使用第三方账号登陆</p>\r\n        <div ng-show="IsWechatInstalled" ng-click="oauthLogin(\'wechat\')" class="login-icon wechat"></div>\r\n        <div ng-click="oauthLogin(\'weibo\')" class="login-icon weibo"></div>\r\n        <div ng-click="oauthLogin(\'qq\')" class="login-icon qq"></div>\r\n\r\n    </div>\r\n  </ion-content>\r\n</ion-modal-view>\r\n'),t.put("specs-dialog.html",'<ion-modal-view>\r\n  <ion-header-bar>\r\n    <div class="buttons">\r\n      <button class="button button-clear" ng-click="closeSpecsBox()">关闭</button>\r\n    </div>\r\n  </ion-header-bar>\r\n  <ion-content class="topic-create">\r\n    <ion-item class="item item-thumbnail-left">\r\n        <img ng-src="{{selectedSpec.images[0]}}">\r\n        <h2>{{item.title}}</h2>\r\n        <p>{{selectedSpec.price | currency}} x {{quantity}}</p>\r\n        <div class="footer-price">{{subTotal(selectedSpec.price, quantity) | currency}}</div>\r\n    </ion-item>\r\n    <ion-item class="spec-options">\r\n        <div class="spec-options-table">\r\n            <dl class="spec-info-field" ng-repeat="(k, v) in item.attributes_desc">\r\n                <dt class="spec-info-key">{{v}}</dt>\r\n                <dd class="spec-info-val">\r\n                <span class="spec-attr"\r\n                    ng-class="{\'selected\': attr==selectedAttr[k],\r\n                            \'disabled\': remainSpec.indexOf(attr) == -1}"\r\n                    ng-click="setAttr(k, attr)"\r\n                    ng-repeat="attr in attrChoices[k]">\r\n                        {{attr}}\r\n                    </span>\r\n                </dd>\r\n            </dl>\r\n            <dl class="spec-info-field">\r\n                <dt class="spec-info-key">数量：</dt>\r\n                <dd class="spec-info-val">\r\n                    <div class="btn-group">\r\n                        <button class="btn del-num"\r\n                            ng-click="setQuantity(-1, true)">-</button>\r\n                        <button class="btn num">{{quantity}}</button>\r\n                        <button class="btn add-num"\r\n                            ng-click="setQuantity(1, true)">+</button>\r\n                    </div>\r\n                </dd>\r\n            </dl>\r\n        </div>\r\n    </ion-item>\r\n  </ion-content>\r\n\r\n    <ion-footer-bar  class="bar-assertive footer-button" >\r\n        <ngcart-addtocart id="{{selectedSpec.sku}}" name="{{item.title}}" price="{{selectedSpec.price}}" quantity="{{quantity}}" quantity-max="5" data="selectedSpecData">加入购物车</ngcart-addtocart>\r\n    </ion-footer-bar>\r\n\r\n</ion-modal-view>\r\n'),t.put("tabs.html",'<!--\r\nCreate tabs with an icon and label, using the tabs-positive style.\r\nEach tab\'s child <ion-nav-view> directive will have its own\r\nnavigation history that also transitions its views in and out.\r\n-->\r\n<ion-tabs class="maybi-tabs tabs-icon-top tabs-color-active-positive {{hideTabs}}">\r\n\r\n  <!-- Explore Tab -->\r\n  <ion-tab title="首页" icon-off="ion-aperture" icon-on="ion-aperture" href="#/explore">\r\n    <ion-nav-view name="tab-explore"></ion-nav-view>\r\n  </ion-tab>\r\n\r\n  <!-- Home Tab -->\r\n  <ion-tab title="购买" icon-off="ion-ios-cart-outline" icon-on="ion-ios-cart" href="#/home">\r\n    <ion-nav-view name="tab-home"></ion-nav-view>\r\n  </ion-tab>\r\n\r\n  <!-- Photo Tab -->\r\n  <ion-tab class="icon-center" title="" icon-off="icon-center" icon-on="icon-center" ng-click="togglePhotoModal()">\r\n    <ion-nav-view name="tab-capture"></ion-nav-view>\r\n  </ion-tab>\r\n\r\n  <!-- Noti Tab -->\r\n  <ion-tab title="通知" icon-off="ion-ios-bell-outline" icon-on="ion-ios-bell" href="#/notification">\r\n    <ion-nav-view name="tab-noti"></ion-nav-view>\r\n  </ion-tab>\r\n\r\n  <!-- Account Tab -->\r\n  <ion-tab title="我的" icon-off="ion-ios-person-outline" icon-on="ion-ios-person" href="#/account">\r\n    <ion-nav-view name="tab-account"></ion-nav-view>\r\n  </ion-tab>\r\n\r\n\r\n</ion-tabs>\r\n'),t.put("transfer_logistics.html",'<ion-view>\r\n  <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$state.go(\'tab.orders\')"></button>\r\n      <div class="title">物流详情</div>\r\n  </div>\r\n\r\n  <ion-content class="has-header">\r\n\r\n\r\n<section ng-if="order.payment_status == \'PAID\'">\r\n    <div class="checkout-info">\r\n        <span class="addr-icon"></span>\r\n        <div class="address-info">\r\n            <p class="addr-header">收货人信息: </p>\r\n            <div class="">{{order.address.receiver}}</div>\r\n            <div class="">{{order.address.street1}}</div>\r\n            <div class="">{{order.address.street2}}</div>\r\n            <div class="">{{order.address.city}}, {{order.address.state}}</div>\r\n            <div class="">{{order.address.country}}, {{order.address.postcode}}</div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="checkout-info">\r\n        <div class="icon partner-icon address"></div>\r\n        <div class="partner-info">\r\n            <div class="selected-partner">{{order.provider.display_name}} ({{order.provider.desc}}):\r\n                <span class="detail-price pull-right">{{order.cn_shipping | currency }}</span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="checkout-info">\r\n        <div class="icon coupon-icon address"></div>\r\n        <div class="coupon-info">\r\n            <div ng-show="order.discount.length==1" class="">{{order.discount[0].desc}}\r\n                <span class="detail-price pull-right">- {{order.discount[0].value | currency }}</span>\r\n            </div>\r\n            <div ng-show="order.discount.length==0" class="">\r\n                不使用\r\n            </div>\r\n        </div>\r\n    </div>\r\n</section>\r\n\r\n<section class="clearfix" ng-if="order.status == \'WAREHOUSE_IN\'">\r\n    <div class="checkout-info" ng-click="gotoAddress()">\r\n        <div ng-show="addr.id">\r\n            <span class="addr-icon"></span>\r\n            <div class="address-info">\r\n                <p class="addr-header">寄往收货人信息: </p>\r\n                <div class="">{{addr.data.receiver}}</div>\r\n                <div class="">{{addr.data.street1}}</div>\r\n                <div class="">{{addr.data.street2}}</div>\r\n                <div class="">{{addr.data.city}}, {{addr.data.state}}</div>\r\n                <div class="">{{addr.data.country}}, {{addr.data.postcode}}</div>\r\n            </div>\r\n            <div class="select-arrow address"></div>\r\n        </div>\r\n        <div ng-hide="addr.id">\r\n            <span class="addr-icon"></span>\r\n            <div class="address-info">\r\n                <div class="">填写收件人信息</div>\r\n            </div>\r\n            <div class="go-add">+</div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="checkout-info">\r\n        <div class="icon partner-icon address"></div>\r\n        <div class="partner-info" ng-click="showProviderChoices()">\r\n            <div ng-show="selectedProvider" class="selected-partner">\r\n                {{selectedProvider.display_name}} ({{selectedProvider.service_intro.duration}}):\r\n                <span class="detail-price selectable">{{selectedProvider.cn_shipping | currency }}</span>\r\n            </div>\r\n            <div ng-hide="selectedProvider" class="selected-partner">请选择运输方式</div>\r\n        </div>\r\n        <div class="select-arrow" ng-class="{\'down-arrow\': providersShown}"></div>\r\n    </div>\r\n    <div ng-show="providersShown" class="checkout-choices">\r\n        <div class="select-row" ng-repeat="provider in provider_prices"\r\n            ng-click="selectPartner(provider)">\r\n            <span class="select-icon"\r\n                ng-class="{\'selected\': selectedProvider.name == provider.name}">\r\n            </span>\r\n            <div class="checkout-choice">\r\n                {{provider.display_name}} ({{provider.service_intro.duration}})\r\n                <span class="detail-price selectable">{{provider.cn_shipping | currency }}</span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="checkout-info">\r\n        <div class="icon coupon-icon address"></div>\r\n        <div class="coupon-info" ng-click="showCouponsChoices()">\r\n            <div ng-show="coupon_codes" class="">{{coupon_codes.description}}\r\n                <span class="detail-price selectable">-{{coupon_codes.saving | currency }}</span>\r\n            </div>\r\n            <div ng-hide="coupon_codes" class="">使用折扣码/优惠券 </div>\r\n        </div>\r\n        <div class="select-arrow" ng-class="{\'down-arrow\': couponsShown}"></div>\r\n    </div>\r\n    <div ng-show="couponsShown" class="checkout-choices">\r\n        <div class="select-row" ng-click="noCoupon()">\r\n            <span class="select-icon"\r\n                ng-class="{\'selected\': noCouponSelected == true}">\r\n            </span>\r\n            <div class="checkout-choice">\r\n                不使用\r\n            </div>\r\n        </div>\r\n        <div class="select-row" ng-repeat="coupon in availableCoupons"\r\n            ng-click="selectCoupon(coupon)">\r\n            <span class="select-icon"\r\n                ng-class="{\'selected\': coupon_codes.code == coupon.code}">\r\n            </span>\r\n            <div class="checkout-choice">\r\n                {{coupon.description}}\r\n                <span class="detail-price selectable">-{{coupon.saving | currency }}</span>\r\n            </div>\r\n        </div>\r\n        <div class="select-row">\r\n            <span class="select-icon"\r\n                ng-click="selectInputCoupon()"\r\n                ng-class="{\'selected\': couponInputSelected}">\r\n            </span>\r\n            <div class="checkout-choice">\r\n                折扣码 <input ng-model="couponInput" type="text" class="" placeholder="输入折扣码">\r\n                <span class="detail-price selectable">-{{coupon_codes.saving}}</span>\r\n                <span ng-click="confirmCoupon()" class="use-btn">使用</span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</section>\r\n\r\n<section>\r\n    <div class="logistic-row">\r\n        <span class="">\r\n            包裹编号：{{logistic.partner_tracking_no}}\r\n        </span>\r\n        <span class="pull-right">\r\n            <ul class="logistic-nav">\r\n                <li class=""\r\n                    ng-repeat="lo in order.logistics"\r\n                    ng-if="order.logistics.length > 1"\r\n                    ng-class="{\'current\': currTab==$index}"\r\n                    ng-click="goTab($index, lo)">\r\n                    包裹{{$index+1}}</li>\r\n            </ul>\r\n        </span>\r\n    </div>\r\n\r\n    <table class="table ngCart cart-table">\r\n        <tbody>\r\n        <tr ng-repeat="entry in logistic.entries track by $index">\r\n            <td class="img-cell">\r\n                <div>\r\n                    <img ng-src="{{entry.item.primary_img}}">\r\n                </div>\r\n            </td>\r\n            <td class="info-cell">\r\n                <div>\r\n                    {{ entry.title }}\r\n                </div>\r\n                <div>\r\n                    <span>数量: {{ entry.quantity | number }}</span>\r\n                </div>\r\n                <div class="">\r\n                    备注:{{ entry.remark }}\r\n                </div>\r\n                <div class="tracking-note">\r\n                    <input type="text" placeholder="请填写快递单号"\r\n                        ng-model="entry.shipping_info.number">\r\n                    <button class="button button-energized button-small"\r\n                        ng-click="fillTracking(entry)">\r\n                        保存\r\n                    </button>\r\n                </div>\r\n            </td>\r\n            <td class="price-cell">￥{{ entry.amount }}</td>\r\n        </tr>\r\n    </table>\r\n\r\n    <div class="logistic-row">\r\n        <ul class="progress-indicator">\r\n            <li ng-class="{\'completed\': allStatus.indexOf(logistic.current_status) >= $index}"\r\n                 ng-repeat="status in logistic.all_status">\r\n                <span class="bubble"></span>\r\n                <div class="logistic-status">{{status.desc}}</div>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class="logistic-row">\r\n        <ul class="tracking">\r\n            <li ng-repeat="h in logistic.history| reverse">\r\n                <div class="">{{h.desc}}</div>\r\n                <div class="time">{{h.time}}</div>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</section>\r\n\r\n  </ion-content>\r\n\r\n  <ion-footer-bar align-title="left" class="bar-stable">\r\n    <a class="button button-clear">\r\n        总计: <span class="footer-price"> {{ order.final |currency}}</span>\r\n    </a>\r\n    <h1 class="title"></h1>\r\n    <div class="buttons">\r\n        <ngcart-checkout ng-if="order.status==\'WAREHOUSE_IN\'" settings="{ order_id: order.id , order_type: \'existed\'}">\r\n            去付款\r\n        </ngcart-checkout>\r\n        <button class="button button-default"\r\n            ng-click="cancelOrder()"\r\n            ng-if="order.payment_status==\'UNPAID\'">\r\n            取消订单\r\n        </button>\r\n    </div>\r\n  </ion-footer-bar>\r\n\r\n</ion-view>\r\n'),t.put("userDetail.html",'<!-- 用户详情 -->\r\n<ion-view>\r\n    <div class="buttons">\r\n        <button class="button button-clear icon ion-ios-arrow-back account-setting-btn pull-left" ng-click="$ionicGoBack()"></button>\r\n    </div>\r\n    <div class="avatar-section">\r\n        <a class="logo"\r\n            style="background: url({{::user.avatar_url}}) center no-repeat; background-size: cover">\r\n        </a>\r\n        <div class="avatar-wrap">\r\n            <p><img class="avatar" ng-src="{{::user.avatar_url}}" alt=""></p>\r\n            <p class="user">{{::user.name}} <follow-btn user="user"></p>\r\n        </div>\r\n        <div class="social-btns">\r\n            <a ng-href="#/userList/{{::user.id}}/followers">\r\n                <strong>{{user.num_followers}} </strong>粉丝\r\n            </a>\r\n            <a ng-href="#/userList/{{::user.id}}/followings">\r\n                <strong>{{user.num_followings}} </strong>关注\r\n            </a>\r\n        </div>\r\n    </div>\r\n\r\n    <ion-content class="account-view" overflow-scroll=\'false\' delegate-handle="userDetailContent" on-scroll="onUserDetailContentScroll()" header-shrink scroll-event-interval="5">\r\n      <div class="button-bar bar-light switch-bar">\r\n          <button class="button button-icon" ng-click="switchListStyle(\'grid\')"\r\n              ng-class="gridStyle==\'grid\'? \'active\': \'\'">\r\n              <i class="icon ion-grid"></i>\r\n          </button>\r\n          <button class="button button-icon" ng-click="switchListStyle(\'list\')"\r\n              ng-class="gridStyle==\'list\'? \'active\': \'\'">\r\n              <i class="icon ion-navicon"></i>\r\n          </button>\r\n      </div>\r\n\r\n      <div class="view-post">\r\n        <ion-refresher\r\n            pulling-text="下拉刷新..."\r\n            on-refresh="doRefresh()"\r\n            spinner="spiral">\r\n        </ion-refresher>\r\n        <div class="list card " ng-if="gridStyle == \'list\'"\r\n            ng-repeat="post in posts track by $index">\r\n            <photo-list post="post" with-affix="false"></photo-list>\r\n        </div>\r\n        <div class="" ng-if="gridStyle==\'grid\'">\r\n            <div class="col col-33 grid-image" ng-repeat="post in posts track by $index">\r\n                <img ng-src="{{::post.small_url}}" ng-click="zoom(post.primary_image)">\r\n            </div>\r\n        </div>\r\n\r\n        <div class="center-ico" ng-if="isEmpty()">\r\n            <i class="icon ion-ios-camera"></i>\r\n\r\n            <h1 >这人还没发布过</h1>\r\n        </div>\r\n\r\n        <ion-infinite-scroll\r\n            on-infinite="loadMore()"\r\n            distance="1"\r\n            spinner=\'spiral\'\r\n            ng-if="moreDataCanBeLoaded()">\r\n        </ion-infinite-scroll>\r\n\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("userList.html",'<ion-view class="view-post">\r\n    <ion-header-bar>\r\n        <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n        <div class="title">{{::title}}</div>\r\n    </ion-header-bar>\r\n\r\n    <ion-content class="has-header">\r\n\r\n    <ion-refresher\r\n        pulling-text="下拉刷新..."\r\n        on-refresh="doRefresh()"\r\n        spinner="spiral">\r\n    </ion-refresher>\r\n\r\n    <div class="list card notice" ng-repeat="user in users track by $index">\r\n        <div class="item item-avatar">\r\n            <img  ng-src="{{::user.avatar_thumb}}"\r\n                ng-click="zoom(user.avatar_url)">\r\n            <h2>{{::user.name}}\r\n                <span class="item-note">\r\n                <follow-btn user="user"></follow-btn>\r\n                </span>\r\n            </h2>\r\n        </div>\r\n    </div>\r\n    <div class="center-ico" ng-if="users.length==0">\r\n        <h1 >暂无用户</h1>\r\n    </div>\r\n    <ion-infinite-scroll\r\n        on-infinite="loadMore()"\r\n        distance="1"\r\n        spinner=\'spiral\'\r\n        ng-if="moreDataCanBeLoaded()">\r\n    </ion-infinite-scroll>\r\n\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("item/items.html",'<!-- 商品列表 -->\r\n<ion-view>\r\n    <div class="bar bar-header">\r\n      <button class="button button-clear icon ion-ios-arrow-back" ng-click="$ionicGoBack()"></button>\r\n      <div class="title">#{{title}}</div>\r\n    </div>\r\n    <ion-content class="has-header homepage">\r\n        <ion-refresher\r\n            pulling-text="下拉刷新..."\r\n            on-refresh="doRefresh()"\r\n            spinner="spiral">\r\n        </ion-refresher>\r\n\r\n        <div class="col col-50 animated fadeIn"\r\n            collection-repeat="item in items" ng-click="goItem(item.item_id)">\r\n            <div class="item item-image">\r\n                <img ng-src="{{item.thumbnail}}" cache-src>\r\n            </div>\r\n            <div class="item item-text-wrap" href="#">\r\n                <h2 class="product-title" style="overflow: hidden;">{{item.title}}</h2>\r\n                <p class="product-prices">\r\n                    <span class="curr-price">{{item.price | currency}}</span>\r\n                    <del class="orig-price">{{item.orig_price | currency}}</del>\r\n                </p>\r\n            </div>\r\n        </div>\r\n\r\n        <ion-infinite-scroll\r\n            on-infinite="loadMore()"\r\n            distance="1"\r\n            spinner=\'spiral\'\r\n            ng-if="moreDataCanBeLoaded()">\r\n        </ion-infinite-scroll>\r\n\r\n        <div class="center-ico" ng-if="isEmpty()">\r\n            <i class="icon ion-ios-grid-view-outline"></i>\r\n\r\n            <h1 >暂无此类商品</h1>\r\n        </div>\r\n\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("ngCart/addtocart.html",'<div class="title"\r\n       ng-click="ngCart.addItem(id, name, price, quantity, data)"\r\n       ng-transclude>加入购物车</button>\r\n</div>\r\n'),t.put("ngCart/checkout.html",'<div class="buttons">\r\n    <button class="button button-assertive button-large button-cart pull-right"  ng-click="showPaymentMethods()">去支付</button>\r\n</div>\r\n'),t.put("photogram/home.html",'<ion-view class="view-post">\r\n    <ion-header-bar class="bar bar-header">\r\n        <button class="button button-clear button-dark icon ion-navicon"\r\n              ng-click="openPopover($event)"></button>\r\n        <div class="title">美比</div>\r\n    </ion-header-bar>\r\n\r\n    <ion-content class="has-header" overflow-scroll="false" >\r\n        <ion-refresher\r\n            pulling-text="下拉刷新..."\r\n            on-refresh="doRefresh()"\r\n            spinner="spiral">\r\n        </ion-refresher>\r\n        <div ng-repeat="post in posts track by $index">\r\n            <photo-list post="post"></photo-list>\r\n        </div>\r\n\r\n        <div class="center-ico" ng-if="isEmpty()">\r\n            <i class="icon ion-ios-camera"></i>\r\n\r\n            <h1 >No photo</h1>\r\n        </div>\r\n\r\n        <ion-infinite-scroll\r\n            on-infinite="loadMore()"\r\n            distance="1"\r\n            spinner=\'spiral\'\r\n            ng-if="moreDataCanBeLoaded()">\r\n        </ion-infinite-scroll>\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("photogram/ionCrop.html",'<div>\r\n    <input type="file" id="browseBtn" image="image" accept="image/*" style="display: none"/>\r\n</div>\r\n'),t.put("photogram/like_posts.html",'<ion-view class="view-post">\r\n    <ion-header-bar class="bar bar-header">\r\n        <button class="button button-clear button-dark icon ion-ios-arrow-back"\r\n              ng-click="$ionicGoBack()"></button>\r\n        <div class="title">赞过帖子</div>\r\n    </ion-header-bar>\r\n\r\n    <ion-content class="has-header" overflow-scroll="false">\r\n        <ion-refresher\r\n            pulling-text="下拉刷新..."\r\n            on-refresh="doRefresh()"\r\n            spinner="spiral">\r\n        </ion-refresher>\r\n        <div class="list card "\r\n            ng-repeat="post in posts track by $index">\r\n            <photo-list post="post"></photo-list>\r\n        </div>\r\n\r\n        <div class="center-ico" ng-if="isEmpty()">\r\n            <i class="icon ion-ios-camera"></i>\r\n\r\n            <h1 >您还没赞过吧</h1>\r\n        </div>\r\n\r\n        <ion-infinite-scroll\r\n            on-infinite="loadMore()"\r\n            distance="1"\r\n            spinner=\'spiral\'\r\n            ng-if="moreDataCanBeLoaded()">\r\n        </ion-infinite-scroll>\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("photogram/locationModal.html",'<ion-modal-view id="ion-google-place-container">\r\n    <form>\r\n    <div class="bar bar-header item-input-inset">\r\n        <label class="item-input-wrapper">\r\n            <i class="icon ion-ios-search placeholder-icon"></i>\r\n            <input class="google-place-search" type="search" ng-model="searchQuery"\r\n                placeholder="输入邮编或地址">\r\n            <input type="submit" ng-click="search(searchQuery)" style="position: absolute; left: -9999px; width: 1px; height: 1px;"/>\r\n        </label>\r\n        <button class="button button-clear" ng-click="closeModal()">\r\n            取消\r\n        </button>\r\n    </div></form>\r\n    <ion-content class="has-header has-header">\r\n        <ion-list>\r\n            <ion-item type="item-text-wrap" ng-click="setCurrentLocation()" ng-if="displayCurrentLocation">\r\n                <i class="icon ion-ios-location"></i> 获取当前位置\r\n            </ion-item>\r\n            <ion-item ng-repeat="location in locations" type="item-text-wrap" ng-click="selectLocation(location)">\r\n                {{location}}\r\n            </ion-item>\r\n        </ion-list>\r\n    </ion-content>\r\n</ion-modal-view>\r\n'),t.put("photogram/my_posts.html",'<ion-view class="view-post">\r\n    <ion-header-bar class="bar bar-header">\r\n        <button class="button button-clear button-dark icon ion-ios-arrow-back"\r\n              ng-click="$ionicGoBack()"></button>\r\n        <div class="title">我的发布</div>\r\n    </ion-header-bar>\r\n\r\n    <ion-content class="has-header" overflow-scroll="false">\r\n        <ion-refresher\r\n            pulling-text="下拉刷新..."\r\n            on-refresh="doRefresh()"\r\n            spinner="spiral">\r\n        </ion-refresher>\r\n        <div class="list card "\r\n            ng-repeat="post in posts track by $index">\r\n            <photo-list post="post"></photo-list>\r\n        </div>\r\n\r\n        <div class="center-ico" ng-if="isEmpty()">\r\n            <i class="icon ion-ios-camera"></i>\r\n\r\n            <h1 >您还没发布过</h1>\r\n        </div>\r\n\r\n        <ion-infinite-scroll\r\n            on-infinite="loadMore()"\r\n            distance="1"\r\n            spinner=\'spiral\'\r\n            ng-if="moreDataCanBeLoaded()">\r\n        </ion-infinite-scroll>\r\n        <!--<div ng-if="!moreDataCanBeLoaded()" class="item item-divider no-more-data">没有更多数据啦!</div>-->\r\n\r\n    </ion-content>\r\n</ion-view>\r\n'),t.put("photogram/photoFilter.html",'<div>\r\n    <div class="capture-photo">\r\n        <img ng-src="{{image}}" id="original-image" style="display:none">\r\n        <div vin\r\n            filter="\'normal\'"\r\n            class="image"\r\n            ng-class="{disabled: loading}"\r\n            name="vin-image"\r\n            image="image"></div>\r\n        <ion-spinner ng-show="loading"></ion-spinner>\r\n    </div>\r\n</div>\r\n'),t.put("photogram/photoFilterCarousel.html",'<ion-scroll direction="x" scrollbar-x="false" class="wide-as-needed  photo-carousel">\r\n    <a ng-click="applyFilter(\'normal\')" >\r\n        <div class="image">\r\n            <img ng-src="img/vintage/normal.jpg" id="normal" >\r\n        </div>\r\n        <p>原图</p>\r\n    </a>\r\n    <a ng-repeat="(filter, cn) in filters" ng-click="applyFilter(filter)" >\r\n        <div class="image">\r\n            <img ng-src="img/vintage/{{filter}}.jpg" id="{{filter}}" >\r\n        </div>\r\n        <p>{{ cn }}</p>\r\n    </a>\r\n</ion-scroll>\r\n'),t.put("photogram/photoList.html",'<div class="list card"  ng-click="goPost()">\r\n    <div class="item item-avatar" ion-affix data-affix-within-parent-with-class="card">\r\n        <img  ng-src="{{post.user.avatar_thumb}}" ng-click="$event.stopPropagation();goUser()">\r\n        <h2>{{post.user.name}}\r\n            <div class="post-type" ng-class="{{\'post.type.en\'}}">\r\n                <i class="icon ion-bookmark"></i> {{post.type.cn}}\r\n            </div>\r\n            <span class="item-note">{{post.created_at | amTimeAgo}}</span>\r\n        </h2>\r\n    </div>\r\n\r\n    <div class="item item-image" >\r\n        <img ng-src="{{post.large_url}}"\r\n            ng-click="$event.stopPropagation();zoom()">\r\n    </div>\r\n    <div class="item item-body">\r\n        <p show-more=\'40\' class="post-body" title="post.title"></p>\r\n    </div>\r\n\r\n\r\n    <div class="item item-buttons">\r\n        <div class="row">\r\n            <div class="col col-50 text-left">\r\n                <button ng-click="$event.stopPropagation();like()"\r\n                    ng-class="post.is_liked ? \'ion-ios-heart\' : \'ion-ios-heart-outline\' "\r\n                    class="button button-clear button-dark icon-left button-heart">\r\n                    {{post.num_likes || \'喜欢\'}}\r\n                </button>\r\n                <button ng-click=""\r\n                    class="button button-clear button-dark icon-left ion-ios-chatbubble-outline">\r\n                    {{post.num_comments || \'评论\'}}\r\n                </button>\r\n                <button ng-click="$event.stopPropagation();actions()"\r\n                    class="button button-clear button-dark icon-left ion-ios-more" >\r\n                </button>\r\n            </div>\r\n            <div class="col col-50 text-left">\r\n                <button ng-click="$event.stopPropagation();sameCity()"\r\n                        ng-if="post.location"\r\n                    class="button button-clear button-dark icon-left ion-ios-location">\r\n                    <span>{{::post.location}}</span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="tag-row" style="margin-left:12px">\r\n        <button class="button button-small button-stable tag"\r\n            ng-repeat="tag in post.tags track by $index"\r\n            ng-click="$event.stopPropagation();searchTag(tag)">\r\n            {{::tag}}\r\n        </button>\r\n    </div>\r\n    <div class="item item-divider"></div>\r\n</div>\r\n'),t.put("photogram/photoListNoAffix.html",'<div class="list card"  ng-click="goPost()">\r\n    <div class="item item-avatar">\r\n        <img  ng-src="{{::post.user.avatar_thumb}}" ng-click="$event.stopPropagation();goUser()">\r\n        <h2>{{::post.user.name}}\r\n            <div class="post-type" ng-class="{{\'post.type.en\'}}">\r\n                <i class="icon ion-bookmark"></i> {{::post.type.cn}}\r\n            </div>\r\n            <span class="item-note">{{::post.created_at | amTimeAgo}}</span>\r\n        </h2>\r\n    </div>\r\n\r\n    <div class="item item-image" >\r\n        <img ng-src="{{::post.large_url}}"\r\n            ng-click="$event.stopPropagation();zoom()">\r\n    </div>\r\n    <div class="item item-body">\r\n        <p show-more=\'40\' class="post-body" title="post.title"></p>\r\n    </div>\r\n\r\n\r\n    <div class="item item-buttons">\r\n        <div class="row">\r\n            <div class="col col-50 text-left">\r\n                <button ng-click="$event.stopPropagation();like()"\r\n                    ng-class="post.is_liked ? \'ion-ios-heart\' : \'ion-ios-heart-outline\' "\r\n                    class="button button-clear button-dark icon-left button-heart">\r\n                    {{post.num_likes || \'喜欢\'}}\r\n                </button>\r\n                <button ng-click=""\r\n                    class="button button-clear button-dark icon-left ion-ios-chatbubble-outline">\r\n                    {{post.num_comments || \'评论\'}}\r\n                </button>\r\n                <button ng-click="$event.stopPropagation();actions()"\r\n                    class="button button-clear button-dark icon-left ion-ios-more" >\r\n                </button>\r\n            </div>\r\n            <div class="col col-50 text-left">\r\n                <button ng-click="$event.stopPropagation();sameCity()" ng-if="post.location"\r\n                    class="button button-clear button-dark icon-left ion-ios-location">\r\n                    <span>{{::post.location}}</span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="tag-row" style="margin-left:12px">\r\n        <button class="button button-small button-stable tag"\r\n            ng-repeat="tag in post.tags track by $index"\r\n            ng-click="$event.stopPropagation();searchTag(tag)">\r\n            {{::tag}}\r\n        </button>\r\n    </div>\r\n    <div class="item item-divider"></div>\r\n</div>\r\n'),t.put("photogram/photoTag.html",'<div class="photo-tag">\r\n    <div class="send">\r\n        <div class="arrow"></div>\r\n        选择下面一种标签..\r\n    </div>\r\n    <div class="row">\r\n        <div class="col col-33" ng-click="selectType(\'SERVICE\')">\r\n            <div tag-select tag-type="SERVICE" ng-model="tags"\r\n                class="tag tag-service"\r\n                ng-class="type==\'SERVICE\'? \'selected\':\'unselect\'"></div>\r\n            <p ng-class="type==\'SERVICE\'? \'selected\':\'\'">服务</p>\r\n        </div>\r\n        <div class="col col-33" ng-click="selectType(\'SHOW\')">\r\n            <div tag-select tag-type="SHOW" ng-model="tags"\r\n                class="tag tag-show"\r\n                ng-class="type==\'SHOW\'? \'selected\':\'unselect\'"></div>\r\n            <p ng-class="type==\'SHOW\'? \'selected\':\'\'">心情</p>\r\n        </div>\r\n        <div class="col col-33" ng-click="selectType(\'TRADE\')">\r\n            <div tag-select tag-type="TRADE" ng-model="tags"\r\n                class="tag tag-trade"\r\n                ng-class="type==\'TRADE\'? \'selected\':\'unselect\'"></div>\r\n            <p ng-class="type==\'TRADE\'? \'selected\':\'\'">买卖</p>\r\n        </div>\r\n\r\n    </div>\r\n</div>\r\n'),t.put("photogram/popover.html",'<ion-popover-view class="photo-popover">\r\n  <ion-content>\r\n\r\n    <ion-list>\r\n      <ion-item ng-click="changeTab(\'\')">\r\n          全部\r\n      </ion-item>\r\n      <ion-item ng-click="changeTab(\'service\')">\r\n          服务\r\n      </ion-item>\r\n      <ion-item ng-click="changeTab(\'trade\')">\r\n          买卖\r\n      </ion-item>\r\n      <ion-item ng-click="changeTab(\'show\')">\r\n          心情\r\n      </ion-item>\r\n    </ion-list>\r\n\r\n  </ion-content>\r\n</ion-popover-view>\r\n'),t.put("photogram/postDetail.html",'<ion-view class="view-post">\r\n    <ion-header-bar>\r\n        <button class="button button-clear button-dark icon ion-ios-arrow-back"\r\n              ng-click="$ionicGoBack()"></button>\r\n        <div class="title">详情</div>\r\n        <button class="button button-clear button-dark icon ion-ios-more"\r\n              ng-click="actions()"></button>\r\n    </ion-header-bar>\r\n\r\n    <ion-content class="has-header has-footer" overflow-scroll="false" >\r\n\r\n\r\n    <div class="list card animated fadeIn">\r\n        <div class="item item-avatar">\r\n            <img  ng-src="{{::post.user.avatar_thumb}}" ng-click="goUser(post.user.id)">\r\n            <h2>{{::post.user.name}}\r\n                <div class="post-type"\r\n                    ng-class="post.type?post.type.en:\'UNCLASSIFIED\'" >\r\n                    <i class="icon ion-bookmark"></i> {{::post.type.cn}}\r\n                </div>\r\n                <span class="item-note">{{::post.created_at | amTimeAgo}}</span>\r\n            </h2>\r\n        </div>\r\n\r\n        <div class="item item-image full-height"\r\n            ng-repeat="img in images"\r\n            ng-click="zoom(img)" >\r\n            <img ng-src="{{::img}}">\r\n        </div>\r\n\r\n        <div class="item item-body">\r\n            <p class="post-body" ng-bind-html="post.title || \'\' | nl2br">\r\n        </div>\r\n\r\n        <div class="item item-buttons">\r\n            <div class="row">\r\n                <div class="col col-60 text-left">\r\n                    <button ng-click="sameCity()" ng-if="post.location"\r\n                        class="button button-clear button-dark icon-left ion-ios-location">\r\n                        <span>{{::post.location}}</span>\r\n                    </button>\r\n                </div>\r\n                <div class="col col-40 text-right">\r\n                    <button ng-click="like()"\r\n                        ng-class="post.is_liked ? \'ion-ios-heart\' : \'ion-ios-heart-outline\' "\r\n                        class="button button-clear button-dark icon-left button-heart">\r\n                        {{post.num_likes || \'喜欢\'}}\r\n                    </button>\r\n                    <button\r\n                        class="button button-clear button-dark icon-left ion-ios-chatbubble-outline">\r\n                        {{post.num_comments || \'评论\'}}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="tag-row" style="margin-left:12px">\r\n            <button class="button button-small button-stable tag"\r\n                ng-repeat="tag in post.tags"\r\n                ng-click="searchTag(tag)">\r\n                {{::tag}}\r\n            </button>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="list avatar-row">\r\n        <div class="avatar-list">\r\n            <div class="avatar-pic" ng-repeat="like in post.likes|limitTo:7">\r\n                <img ng-src="{{::like.user.avatar_thumb}}" ng-click="goUser(like.user.id)">\r\n            </div>\r\n        </div>\r\n        <div class="more" >\r\n            <a ng-href="#/userList/{{::post.post_id}}/postLikes">\r\n                <img src="img/icons/more.jpg">\r\n            </a>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="item item-divider"></div>\r\n    <div class="list">\r\n        <div class="item item-avatar" ng-repeat="comment in post.comments" ng-click="deleteComment(comment)">\r\n            <img ng-src="{{::comment.user.avatar_thumb}}" ng-click="goUser(comment.user.id)">\r\n            <h2>{{::comment.user.name}}\r\n                <span class="item-note">\r\n                    {{::comment.created_at | amTimeAgo}}\r\n                </span>\r\n\r\n            </h2>\r\n            <p>{{::comment.content}}</p>\r\n\r\n        </div>\r\n    </div>\r\n    </ion-content>\r\n\r\n    <ion-footer-bar keyboard-attach  class="bar bar-stable item-input-inset">\r\n        <button ng-click="like()"\r\n            ng-class="post.is_liked ? \'ion-ios-heart\' : \'ion-ios-heart-outline\' "\r\n            class="button button-clear button-icon ">\r\n        </button>\r\n        <label class="item-input-wrapper">\r\n          <input ng-model="message" placeholder="说些什么" type="text"/>\r\n        </label>\r\n        <button class="button button-clear button-icon" ng-click="comment()">评论</button>\r\n    </ion-footer-bar>\r\n</ion-view>\r\n'),t.put("photogram/postModal.html",'<ion-modal-view class="modal-post">\r\n    <ion-header-bar>\r\n        <button class="button button-clear button-dark" ng-click="closePost()">取消</button>\r\n        <div class="title">发布信息</div>\r\n    </ion-header-bar>\r\n    <ion-scroll direction="y" style="right: 0;bottom: 0;left: 0;position: absolute;"\r\n        class="has-header has-footer">\r\n        <div class="list">\r\n            <div class="item item-input post-textarea wide-as-needed primary_image">\r\n                <a ng-click="editImage(form.primary_image)" style="bottom: 16px;">\r\n                    <div class="image" style="background-image: url({{form.primary_image}});\r\n                                background-position: center;\r\n                                background-repeat: no-repeat;\r\n                                background-size: cover;">\r\n                    </div>\r\n                </a>\r\n                <textarea ng-model="form.title" autofocus placeholder="描述一下吧"></textarea>\r\n            </div>\r\n            <div class="item item-divider"></div>\r\n\r\n            <ion-item class="item item-icon-left item-icon-right" ng-click="getLocation()">\r\n                <i class="icon ion-ios-location"></i>\r\n                发布于\r\n                <div class="item-note">\r\n                    <ion-google-place placeholder="输入地址或邮编"\r\n                        ng-model="form.location"\r\n                        geocode="form.geo"\r\n                        current-location="true" ></ion-google-place>\r\n                </div>\r\n                <i class="icon ion-ios-arrow-right"></i>\r\n            </ion-item>\r\n            <div class="item item-icon-left item-icon-right item-tag" ng-model="form.tags" tag-type="{{form.type}}" tag-select>\r\n                <i class="icon ion-ios-pricetags energized"></i>\r\n                标签\r\n                <div class="item-note">\r\n                    添加\r\n                </div>\r\n                <i class="icon ion-ios-arrow-right"></i>\r\n            </div>\r\n            <div class="tag-row" style="margin-left:12px">\r\n                <span class="tag selected"\r\n                    ng-repeat="tag in form.tags"\r\n                    ng-click="setOption(tag)">\r\n                    {{tag}} <i class="ion-ios-close-empty"></i>\r\n                </span>\r\n            </div>\r\n            <!--<div class="row tag-row">\r\n                <div class="col col-20 tag-text">推荐标签</div>\r\n                <div class="col col-80">\r\n                    <ion-scroll direction="x" scrollbar-x="false">\r\n                        <div style="width:400px">\r\n                            <span class="tag"\r\n                                ng-repeat="tag in [\'买卖\',\'服务\',\'房屋\',\'心情\',\'晒\', \'约\']"\r\n                                ng-click="setOption(tag)">\r\n                                {{tag}} <i class="ion-ios-plus-empty"></i>\r\n                            </span>\r\n                        </div>\r\n                    </ion-scroll>\r\n                </div>\r\n            </div>-->\r\n            <div class="item item-input item-stacked-label">\r\n                <div class="input-label">补充图片\r\n                    <div class="add-image"\r\n                        ng-click="increasePhotosModal()"\r\n                        ng-show="form.photos.length < 4">\r\n                        <i class="icon ion-ios-plus-empty"></i>\r\n                    </div>\r\n                </div>\r\n                <ion-scroll direction="x" scrollbar-x="false" class="wide-as-needed">\r\n                    <a ng-repeat="photo in form.photos track by $index">\r\n                       <i class="icon ion-ios-close"\r\n                           ng-click="editAdditionImage($index)" ></i>\r\n                        <div class="image add" style="background-image: url({{photo}});\r\n                                    background-position: center;\r\n                                    background-repeat: no-repeat;\r\n                                    background-size: cover;">\r\n                        </div>\r\n                    </a>\r\n                </ion-scroll>\r\n            </div>\r\n        </div>\r\n\r\n    </ion-scroll>\r\n    <ion-footer-bar class="bar-assertive footer-button"\r\n        ng-click="submitPost(form)" keyboard-attach >\r\n        <div class="title">发表 <i class="icon ion-arrow-right-c"></i></div>\r\n    </ion-footer-bar>\r\n</ion-modal-view>\r\n'),t.put("photogram/tagsModal.html",' <ion-modal-view class="tag-modal">\r\n    <ion-header-bar>\r\n        <button class="button button-clear button-dark" ng-click="closeModal()">取消</button>\r\n        <div class="title">添加标签</div>\r\n        <button class="button button-clear button-dark" ng-click="confirmTags()">确定</button>\r\n    </ion-header-bar>\r\n    <div class="bar bar-subheader item-input-inset">\r\n        <label class="item-input-wrapper">\r\n            <i class="icon ion-ios-search placeholder-icon"></i>\r\n            <input type="search" placeholder="搜索或添加新标签" ng-model="ui.searchQuery">\r\n        </label>\r\n        <button class="button button-clear button-icon icon ion-ios-close-empty"\r\n            ng-click="clearSearch()">\r\n        </button>\r\n    </div>\r\n\r\n    <ion-content class="has-subheader has-header has-footer">\r\n        <div class="list">\r\n            <ion-item ng-click="addNewTag()" ng-if="ui.searchQuery">\r\n                <i class="icon ion-ios-plus-empty"></i> 添加新标签: {{ui.searchQuery}}\r\n            </ion-item>\r\n            <div class="item item-divider">{{options.name}}</div>\r\n            <div class="item item-icon-right"\r\n                ng-repeat="tag in options.tag_list | filter: ui.searchQuery"\r\n                ng-click="setOption(tag)">\r\n                {{tag}}\r\n                <i class="icon select-icon"\r\n                    ng-class="compareValues(tag)? \'ion-ios-checkmark selected\':\'ion-ios-circle-outline\'">\r\n                </i>\r\n            </div>\r\n        </div>\r\n    </ion-content>\r\n    <ion-footer-bar align-title="left" class="bar bar-stable">\r\n        <span class="button button-clear">\r\n        已选：\r\n            <button class="button button-light icon-right ion-ios-close-empty tag"\r\n                ng-repeat="tag in ui.checkedTags"\r\n                ng-click="setOption(tag)">\r\n                {{tag}}\r\n            </button>\r\n        </span>\r\n    </ion-footer-bar>\r\n\r\n</ion-modal-view>\r\n'),t.put("user/followButton.html",'<div class="follow_btn" ng-if="currentUserID != user.id">\r\n    <button class="button button-small button-outline"\r\n        ng-class="user.is_following?\'\' :\'button-energized\'" ng-click="follow()">{{user.is_following? "已关注":"关注"}}</button>\r\n\r\n</div>\r\n')
}]),PhotoService.$inject=["$ionicActionSheet","ENV","$jrCrop","$rootScope","$http","$ionicModal","$cordovaCamera","$cordovaImagePicker","$q"],ionCropDirective.$inject=["$jrCrop","$ionicActionSheet"],PhotoFilterFactory.$inject=["$rootScope","$q","$ionicModal"],vintageDirective.$inject=["Vintage","$timeout"],photoFilterCarouselDirective.$inject=["Vintage","$timeout"],Vintage.$inject=["$q"],angular.module("ion-photo",["ionic","ngCordova","jrCrop"]).factory("PhotoService",PhotoService).directive("ionCrop",ionCropDirective).factory("PhotoFilter",PhotoFilterFactory).directive("vin",vintageDirective).directive("photoFilter",photoFilterDirective).directive("photoTag",photoTag).directive("photoCarousel",photoFilterCarouselDirective).factory("Vintage",Vintage),PhotogramFactory.$inject=["FetchData","ENV","$http","$q","$rootScope","Storage","PhotoService"],photoList.$inject=["Photogram","$q","$timeout","$rootScope","$state","photoShare"],photoShare.$inject=["$rootScope","Photogram","$ionicActionSheet","$cordovaSocialSharing","sheetShare","AuthService","$ionicPopup"];var photogramModule=angular.module("maybi.photogram",[]);photogramModule.factory("Photogram",PhotogramFactory),photogramModule.directive("photoList",photoList),photogramModule.service("photoShare",photoShare),angular.module("ion-geo",[]).service("geoService",["$ionicPlatform","$q","$cordovaGeolocation",function(t,n,e){function r(){return n(function(n,r){var i={timeout:9e3,enableHighAccuracy:!1};t.ready(function(){e.getCurrentPosition(i).then(function(t){n(t)},function(t){t.from="getLocation",r(t)})})})}this.getLocation=r}]).directive("ionGooglePlace",["$ionicModal","$ionicPlatform","$http","$q","$timeout","$rootScope","geoService",function(t,n,e,r,i){return{require:"?ngModel",restrict:"E",template:'<input type="text" readonly="readonly" id="ion-geo" class="ion-google-place" autocomplete="off">',replace:!0,scope:{ngModel:"=?",geocode:"=?",currentLocation:"@"},link:function(o,s,a,c){function l(t){return r(function(n,r){var i=t[1],o=t[0];e.get("https://maps.googleapis.com/maps/api/geocode/json",{params:{latlng:i+","+o,language:"en",key:""}}).success(function(t){var e=t.results;if("OK"==t.status){if(e[1])var i=d(e[1]);else var i=d(e[0]);n(i)}else{var o={status:t.status,from:"reverseGeocoding"};r(o)}}).catch(function(t){r(error)})})}function d(t){var n={},e=null;return angular.forEach(t.address_components,function(t){n[t.types[0]]=t.short_name}),n.locality&&n.administrative_area_level_1&&(e=[n.locality,n.administrative_area_level_1,n.country].join(",")),e}var u;o.locations=[];var p=void 0;o.displayCurrentLocation=!1,o.currentLocation="true"===o.currentLocation?!0:!1,navigator.geolocation&&o.currentLocation&&(o.displayCurrentLocation=!0),t.fromTemplateUrl("photogram/locationModal.html",{scope:o,focusFirstInput:!0,animation:"slide-in-right"}).then(function(t){o.popup=t,o.selectLocation=function(t){c.$setViewValue(t),c.$render(),o.popup.hide(),u&&(u(),u=null),o.$emit("ionGooglePlaceSetLocation",t)},o.setCurrentLocation=function(){var t="正在获取位置...";c.$setViewValue(t),c.$render(),o.popup.hide(),l(o.geocode).then(function(t){c.$setViewValue(t),s.attr("value",t),c.$render()}).catch(function(t){var n="获取当前位置失败";c.$setViewValue(n),c.$render(),o.popup.hide(),i(function(){c.$setViewValue(null),c.$render(),o.popup.hide()},2e3)})},o.search=function(t){p&&i.cancel(p),p=i(function(){t&&e.get("https://maps.googleapis.com/maps/api/geocode/json",{params:{address:t,language:"en",key:"AIzaSyC57Wo22mMcQufa-9I0LHQl9XXr0Nu0IiU"}}).success(function(t){var n=[];angular.forEach(t.results,function(t){var e=d(t);e&&n.push(e)}),o.locations=n}).catch(function(t){})},350)},o.closeModal=function(){};var r=function(t){t.preventDefault(),t.stopPropagation(),u=n.registerBackButtonAction(closeOnBackButton,250),o.popup.show()};o.closeModal=function(){o.searchQuery="",o.popup.hide(),u&&(u(),u=null)},closeOnBackButton=function(t){t.preventDefault(),o.popup.hide(),u&&(u(),u=null)},s.bind("click",r),s.bind("touchend",r)}),a.placeholder&&s.attr("placeholder",a.placeholder),c.$formatters.unshift(function(t){return t?t:""}),c.$parsers.unshift(function(t){return t}),c.$render=function(){s.val(c.$viewValue?c.$viewValue||"":"")},o.$on("$destroy",function(){u&&(u(),u=null)})}}}]),function(){angular.module("tag-select",[]).directive("tagSelect",["$ionicModal","$timeout","$filter","$cordovaToast","FetchData",function(t,n,e,r,i){return{restrict:"A",require:"ngModel",scope:{ngModel:"=?",tagType:"@"},link:function(n,e,o,s){n.ui={checkedTags:n.ngModel,value:null,searchQuery:""},n.confirmTags=function(){s.$setViewValue(n.ui.checkedTags),s.$render(),n.modal.hide().then(function(){n.ui.searchQuery=""})},n.setOption=function(t){a(t)?c(t):n.ui.checkedTags.length<3?n.ui.checkedTags.push(t):r.show("最多只能添加3个标签哦","short","center")},n.compareValues=function(t){return a(t)};var a=function(t){var e=null;return angular.forEach(n.ui.checkedTags,function(n){n===t&&(e=t)}),e},c=function(t){angular.forEach(n.ui.checkedTags,function(e,r){e==t&&n.ui.checkedTags.splice(r,1)})};n.clearSearch=function(){n.ui.searchQuery=""},n.closeModal=function(){n.modal.hide()},n.addNewTag=function(){var t=n.ui.searchQuery;n.setOption(t),n.clearSearch()},t.fromTemplateUrl("photogram/tagsModal.html",{scope:n,animation:"slide-in-right"}).then(function(t){n.modal=t}),n.$on("$destroy",function(){n.modal.remove()}),e.on("click",function(){n.modal.show(),i.get("/api/post/tags/"+n.tagType).then(function(t){n.options=t.tags_group})}),s.$render()}}}])}();